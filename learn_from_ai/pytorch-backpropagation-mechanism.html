<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width, initial-scale=1" data-next-head=""/><meta property="og:image" content="https://ryojerryyu.github.io/blog-next/img/home-bg-kasumi-hanabi.jpg" data-next-head=""/><meta name="twitter:image" content="https://ryojerryyu.github.io/blog-next/img/home-bg-kasumi-hanabi.jpg" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:url" content="https://blog.ryo-okami.xyz/learn_from_ai/pytorch-backpropagation-mechanism" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@ryo_okami" data-next-head=""/><meta name="twitter:creator" content="@ryo_okami" data-next-head=""/><link rel="icon" href="/blog-next/favicon.ico" data-next-head=""/><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" data-next-head=""/><title data-next-head="">PyTorch 自动微分与反向传播机制原理解析 | Ryo&#x27;s Blog</title><meta property="og:title" content="PyTorch 自动微分与反向传播机制原理解析" data-next-head=""/><meta property="og:site_name" content="Ryo&#x27;s Blog" data-next-head=""/><meta name="twitter:title" content="PyTorch 自动微分与反向传播机制原理解析 | Ryo&#x27;s Blog" data-next-head=""/><meta name="description" content="&gt; 本文为用户与 DeepSeek 的问答。主题为 PyTorch 的反向传播机制。本文从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。
&gt; query
&gt;" data-next-head=""/><meta property="og:description" content="&gt; 本文为用户与 DeepSeek 的问答。主题为 PyTorch 的反向传播机制。本文从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。
&gt; query
&gt;" data-next-head=""/><meta name="twitter:description" content="&gt; 本文为用户与 DeepSeek 的问答。主题为 PyTorch 的反向传播机制。本文从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。
&gt; query
&gt;" data-next-head=""/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png"/><link rel="manifest" href="/site.webmanifest"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/blog-next/_next/static/css/b1388611d1c9dd22.css" as="style"/><link rel="preload" href="/blog-next/_next/static/css/759e44c2e4b78c36.css" as="style"/><link rel="stylesheet" href="/blog-next/_next/static/css/b1388611d1c9dd22.css" data-n-g=""/><link rel="stylesheet" href="/blog-next/_next/static/css/759e44c2e4b78c36.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/blog-next/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/blog-next/_next/static/chunks/webpack-f725e2093a3ba537.js" defer=""></script><script src="/blog-next/_next/static/chunks/framework-e4769b99948425c9.js" defer=""></script><script src="/blog-next/_next/static/chunks/main-3f6d275ccf3fd94b.js" defer=""></script><script src="/blog-next/_next/static/chunks/pages/_app-c1cbb9ed553afcf3.js" defer=""></script><script src="/blog-next/_next/static/chunks/6d2b60a9-6f6825b9950df41b.js" defer=""></script><script src="/blog-next/_next/static/chunks/9124-f0550589fa87ac60.js" defer=""></script><script src="/blog-next/_next/static/chunks/4587-1e9962caacaaa9eb.js" defer=""></script><script src="/blog-next/_next/static/chunks/6893-676807c0ea960618.js" defer=""></script><script src="/blog-next/_next/static/chunks/4364-109daee7d7546c8b.js" defer=""></script><script src="/blog-next/_next/static/chunks/pages/learn_from_ai/%5Bslug%5D-a1b0a6d423c0ce7f.js" defer=""></script><script src="/blog-next/_next/static/P1XPmppfnPIPoLUZ4zipP/_buildManifest.js" defer=""></script><script src="/blog-next/_next/static/P1XPmppfnPIPoLUZ4zipP/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="DefaultLayout_header__aepTD"><div class="DefaultLayout_icon__11sTk"><div class="DefaultLayout_textbox__H9FZG"><a class="DefaultLayout_textlink__EVwys" href="/blog-next">Ryo&#x27;s Blog</a></div></div><div class="DefaultLayout_navBar__gY4ra"><div class="DefaultLayout_navBarItem__nhL6L"><a class="DefaultLayout_textlink__EVwys" href="/blog-next/articles">Articles</a></div><div class="DefaultLayout_navBarItem__nhL6L"><a class="DefaultLayout_textlink__EVwys" href="/blog-next/ideas">Ideas</a></div><div class="DefaultLayout_navBarItem__nhL6L"><a class="DefaultLayout_textlink__EVwys" href="/blog-next/learn_from_ai">Learn from AI</a></div><div class="DefaultLayout_navBarItem__nhL6L"><a class="DefaultLayout_textlink__EVwys" href="/blog-next/tags">Tags</a></div><div class="DefaultLayout_navBarItem__nhL6L"><a class="DefaultLayout_textlink__EVwys" href="/blog-next/clips">Clips</a></div></div><div class="DefaultLayout_headerRight__0Kj26"><div class=" flex flex-row gap-8 items-center justify-center"><a title="Twitter" href="https://twitter.com/ryo_okami"><svg class=" h-6 w-6 fill-gray-300 hover:fill-white transition-all ease-in-out" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a title="GitHub" href="https://github.com/RyoJerryYu"><svg class=" h-6 w-6 fill-gray-300 hover:fill-white transition-all ease-in-out" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a title="Pixiv" href="https://www.pixiv.net/users/9159893"><svg class=" h-6 w-6 fill-gray-300 hover:fill-white transition-all ease-in-out" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4.935 0A4.924 4.924 0 0 0 0 4.935v14.13A4.924 4.924 0 0 0 4.935 24h14.13A4.924 4.924 0 0 0 24 19.065V4.935A4.924 4.924 0 0 0 19.065 0zm7.81 4.547c2.181 0 4.058.676 5.399 1.847a6.118 6.118 0 0 1 2.116 4.66c.005 1.854-.88 3.476-2.257 4.563-1.375 1.092-3.225 1.697-5.258 1.697-2.314 0-4.46-.842-4.46-.842v2.718c.397.116 1.048.365.635.779H5.79c-.41-.41.19-.65.644-.779V7.666c-1.053.81-1.593 1.51-1.868 2.031.32 1.02-.284.969-.284.969l-1.09-1.73s3.868-4.39 9.553-4.39zm-.19.971c-1.423-.003-3.184.473-4.27 1.244v8.646c.988.487 2.484.832 4.26.832h.01c1.596 0 2.98-.593 3.93-1.533.952-.948 1.486-2.183 1.492-3.683-.005-1.54-.504-2.864-1.42-3.86-.918-.992-2.274-1.645-4.002-1.646Z"></path></svg></a></div></div></header><div class="DefaultLayout_headerBg__FStmg"></div><div class="max-w-3xl mx-auto p-2"><div class="DefaultLayout_contentHeight__DabjQ"><article class="Post_post__acRqJ"><h1 class="Post_postTitle__N1NIA">PyTorch 自动微分与反向传播机制原理解析</h1><div class="Post_postDate__SQx7A"><time dateTime="2025-03-06T15:50:00.000Z">2025-03-06</time></div><div class="TagsBox_tagsBox__WzhAf mt-2"><a href="/blog-next/tags/pytorch"><div class="TagsBox_tag__Rk32C">PyTorch</div></a><a href="/blog-next/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0"><div class="TagsBox_tag__Rk32C">深度学习</div></a><a href="/blog-next/tags/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD"><div class="TagsBox_tag__Rk32C">反向传播</div></a><a href="/blog-next/tags/%E8%87%AA%E5%8A%A8%E5%BE%AE%E5%88%86"><div class="TagsBox_tag__Rk32C">自动微分</div></a><a href="/blog-next/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><div class="TagsBox_tag__Rk32C">学习笔记</div></a></div><div class="post-body Post_postContent__mJ_Ju"><blockquote>
<p>本文为用户与 DeepSeek 的问答。主题为 PyTorch 的反向传播机制。本文从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。</p>
</blockquote>
<h2 id="q-深入解析-pytorch-中的反向传播机制"><a href="#q-深入解析-pytorch-中的反向传播机制">Q; 深入解析 PyTorch 中的反向传播机制</a></h2>
<blockquote>
<p>query</p>
<p>深入解释 torch 中反向传播机制的数学原理与为何需要反向传播机制。提示：你可以使用公式、Mermaid 图表、表格等方式使内容更容易理解。</p>
</blockquote>
<blockquote>
<p>think</p>
<p>嗯，用户让我深入解释PyTorch中的反向传播机制的数学原理以及为什么需要它。好的，我得先回忆一下反向传播的基础知识，然后结合PyTorch的具体实现来展开。</p>
<p>首先，反向传播是神经网络训练的核心，用于计算梯度。用户可能已经了解梯度下降，但需要更底层的数学解释。我应该从计算图开始，因为PyTorch使用动态图机制。每个张量的运算都会记录在计算图中，这样在反向传播时可以自动计算梯度。</p>
<p>数学原理方面，得先讲链式法则。比如，假设有一个简单的函数，y = w*x + b，然后损失函数是L = (y - t)^2。那么求L对w的梯度就需要链式法则：dL/dw = dL/dy * dy/dw。反向传播的过程就是从输出层开始，逐层应用链式法则，将梯度传播回各层的参数。</p>
<p>然后需要解释为什么需要反向传播。手动计算梯度在复杂网络中不现实，反向传播自动高效地计算所有参数的梯度，节省了时间和减少错误。可能还需要比较前向传播和反向传播的计算量，比如反向传播如何复用前向的中间结果，提高效率。</p>
<p>PyTorch中的autograd机制是关键。每个Tensor的.grad_fn属性记录了创建它的操作，这样在调用.backward()时，会沿着这些函数形成的计算图反向遍历，应用链式法则。需要举例说明，比如构建一个简单的计算图，然后展示梯度计算的过程。</p>
<p>可能用户对计算图的具体实现细节感兴趣，比如PyTorch的动态图特性，每次前向传播都会构建新的图，这样更灵活。但数学原理还是链式法则，不管图的结构如何变化，梯度计算的方法是一致的。</p>
<p>另外，可能需要提到为什么不能只用数值方法来近似梯度，比如计算资源的问题，尤其是高维参数时，数值梯度计算量太大。而反向传播通过解析法高效计算，适合深度学习的大规模参数。</p>
<p>还要注意解释叶子节点和中间节点的梯度存储情况，PyTorch默认只保留叶子节点的梯度，中间节点的梯度会被释放以节省内存。这可能在训练大模型时很重要，用户可能需要了解如何控制梯度的保留。</p>
<p>或许用户对反向传播的数学推导有更深的需求，比如如何扩展到多层网络，或者如何处理复杂的层结构如卷积层、循环层。但根据问题，可能只需要基础数学，比如链式法则的多次应用，以及如何累积各层的梯度。</p>
<p>最后，总结反向传播的必要性：自动化、高效、准确计算梯度，使得训练深层网络可行。而PyTorch的自动微分机制让用户无需手动实现这些复杂的计算，只需关注模型结构。</p>
<p>可能需要用公式来展示链式法则的应用，比如多层的梯度相乘。例如，一个三层的网络，每一层的权重梯度如何计算。同时，用Mermaid图展示计算图的结构，说明前向和反向的路径。</p>
<p>还有可能要考虑激活函数的导数，比如ReLU在反向传播中的处理，这样在计算图中如何处理不可导点，但PyTorch的autograd会自动处理这些。</p>
<p>总之，我需要从数学原理（链式法则）、计算图的概念、PyTorch的实现机制（动态图、autograd）、以及反向传播的必要性（高效、自动）这几个方面来组织内容，并用公式和图表辅助说明。</p>
<p>最后，我需要用一个具体的例子，比如一个简单的神经网络，来展示反向传播的整个过程，包括前向传播、反向传播、梯度计算和参数更新。这样用户可以直观地理解反向传播的每个步骤。</p>
<p>如果用户对PyTorch的代码实现感兴趣，我也可以提供一些关键代码段的解析，比如如何定义计算图、如何跟踪梯度、如何执行反向传播等。</p>
<p>总之，我需要确保解释清晰，结合数学原理和代码示例，帮助用户理解PyTorch中的反向传播机制。</p>
</blockquote>
<h3 id="深入解析-pytorch-中的反向传播机制"><a href="#深入解析-pytorch-中的反向传播机制">深入解析 PyTorch 中的反向传播机制</a></h3>
<p>反向传播（Backpropagation）是神经网络训练的核心算法。本文将从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。</p>
<hr/>
<h4 id="一反向传播的数学原理"><a href="#一反向传播的数学原理">一、反向传播的数学原理</a></h4>
<h5 id="1-链式法则chain-rule"><a href="#1-链式法则chain-rule">1. 链式法则（Chain Rule）</a></h5>
<p>反向传播本质上是链式法则的高效实现。假设神经网络的计算流程为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L = f(g(h(x)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)))</span></span></span></span></span>
<p>其中：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>W</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h(x) = W_1x + b_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>ReLU</mtext><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(z) = \text{ReLU}(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f(y) = \frac{1}{2}(y - t)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> （均方误差损失）</li>
</ul>
<p>则梯度计算为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>g</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>g</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mn>1</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial W_1} = \frac{\partial L}{\partial f} \cdot \frac{\partial f}{\partial g} \cdot \frac{\partial g}{\partial h} \cdot \frac{\partial h}{\partial W_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2074em;vertical-align:-0.836em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.2074em;vertical-align:-0.836em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<h5 id="2-梯度累积公式"><a href="#2-梯度累积公式">2. 梯度累积公式</a></h5>
<p>对于任意参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span>，梯度计算可表示为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mrow><mtext>path </mtext><mi>θ</mi><mo>→</mo><mi mathvariant="script">L</mi></mrow></munder><mrow><mo fence="true">(</mo><munder><mo>∏</mo><mi>i</mi></munder><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mtext>op</mtext><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mtext>input</mtext><mi>i</mi></msub></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial \mathcal{L}}{\partial \theta} = \sum_{\text{path } \theta \to \mathcal{L}} \left( \prod_{i} \frac{\partial \text{op}_i}{\partial \text{input}_i} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathcal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3.1882em;vertical-align:-1.4382em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8479em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">path </span></span><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span><span class="mrel mtight">→</span><span class="mord mathcal mtight">L</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord text"><span class="mord">input</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2175em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord text"><span class="mord">op</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2175em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9301em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size4">)</span></span></span></span></span></span></span>
<hr/>
<h4 id="二pytorch-的实现机制"><a href="#二pytorch-的实现机制">二、PyTorch 的实现机制</a></h4>
<h5 id="1-动态计算图dynamic-computation-graph"><a href="#1-动态计算图dynamic-computation-graph">1. 动态计算图（Dynamic Computation Graph）</a></h5>
<p>PyTorch 在前向传播时自动构建计算图，节点为张量，边为运算操作：</p>
<div class="relative h-[600px] py-4"><div class="absolute inset-0 flex items-center justify-center">Loading...</div></div>
<h5 id="2-autograd-核心组件"><a href="#2-autograd-核心组件">2. Autograd 核心组件</a></h5>
<table><thead><tr><th>组件</th><th>作用</th></tr></thead><tbody><tr><td><code>Tensor.requires_grad</code></td><td>标记需要跟踪梯度的张量</td></tr><tr><td><code>Tensor.grad_fn</code></td><td>记录创建该张量的操作（如 <code>MulBackward</code>）</td></tr><tr><td><code>Tensor.grad</code></td><td>存储计算得到的梯度</td></tr></tbody></table>
<h5 id="3-反向传播过程"><a href="#3-反向传播过程">3. 反向传播过程</a></h5>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#3E8FB0">import</span><span style="color:#E0DEF4"> torch</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#E0DEF4">x </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#EA9A97">2.0</span><span style="color:#908CAA">],</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">W </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#EA9A97">3.0</span><span style="color:#908CAA">],</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">y </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> W </span><span style="color:#3E8FB0">*</span><span style="color:#E0DEF4"> x</span></span>
<span data-line=""><span style="color:#E0DEF4">y</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">W</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 输出: tensor([2.])</span></span>
<span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">x</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 输出: tensor([3.])</span></span></code></pre></figure>
<hr/>
<h4 id="三为何需要反向传播"><a href="#三为何需要反向传播">三、为何需要反向传播？</a></h4>
<h5 id="1-手动计算不可行性"><a href="#1-手动计算不可行性">1. 手动计算不可行性</a></h5>
<p>对于包含百万参数的现代神经网络，手动计算梯度的时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，而反向传播只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 。</p>
<h5 id="2-计算效率对比"><a href="#2-计算效率对比">2. 计算效率对比</a></h5>
<table><thead><tr><th>方法</th><th>时间复杂度</th><th>空间复杂度</th><th>数值稳定性</th></tr></thead><tbody><tr><td>数值微分</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td>差</td></tr><tr><td>符号微分</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td>好</td></tr><tr><td>自动微分（反向传播）</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td>优秀</td></tr></tbody></table>
<h5 id="3-内存优化策略"><a href="#3-内存优化策略">3. 内存优化策略</a></h5>
<p>PyTorch 采用以下技术降低内存占用：</p>
<ul>
<li><strong>梯度检查点</strong>：只保留关键节点的中间结果</li>
<li><strong>即时释放中间梯度</strong>：默认只保留叶子节点的梯度</li>
</ul>
<hr/>
<h4 id="四反向传播的数学扩展"><a href="#四反向传播的数学扩展">四、反向传播的数学扩展</a></h4>
<h5 id="1-矩阵求导示例"><a href="#1-矩阵求导示例">1. 矩阵求导示例</a></h5>
<p>对于全连接层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Y = XW + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span> ，梯度计算为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial \mathcal{L}}{\partial W} = X^T \cdot \frac{\partial \mathcal{L}}{\partial Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.13889em">W</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathcal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8913em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathcal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<h5 id="2-复杂运算处理"><a href="#2-复杂运算处理">2. 复杂运算处理</a></h5>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> PyTorch 自动处理不可导点</span></span>
<span data-line=""><span style="color:#E0DEF4">x </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#3E8FB0">-</span><span style="color:#EA9A97">1.0</span><span style="color:#908CAA">,</span><span style="color:#EA9A97"> 0.0</span><span style="color:#908CAA">,</span><span style="color:#EA9A97"> 2.0</span><span style="color:#908CAA">],</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">y </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">relu</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">x</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">y</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#EA9A97">1.0</span><span style="color:#908CAA">,</span><span style="color:#EA9A97"> 1.0</span><span style="color:#908CAA">,</span><span style="color:#EA9A97"> 1.0</span><span style="color:#908CAA">]))</span></span>
<span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">x</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 输出: tensor([0., 0., 1.])</span></span></code></pre></figure>
<hr/>
<h4 id="五总结"><a href="#五总结">五、总结</a></h4>
<p><strong>反向传播的必要性</strong>：</p>
<ol>
<li><strong>自动微分</strong>：避免手工推导复杂导数</li>
<li><strong>计算高效</strong>：利用链式法则的分解特性</li>
<li><strong>内存优化</strong>：动态图的即时构建与销毁</li>
<li><strong>框架支撑</strong>：支持任意复杂网络结构</li>
</ol>
<p>PyTorch 通过动态计算图和 Autograd 系统，将反向传播的数学原理高效实现，使得深度学习模型的训练变得可行且高效。理解这一机制对于调试模型、优化内存使用和实现自定义算子至关重要。</p>
<h2 id="q-参数的梯度累加计算公式"><a href="#q-参数的梯度累加计算公式">Q: 参数的梯度累加计算公式</a></h2>
<blockquote>
<p>query</p>
<p>你提到对于任意参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span>，梯度计算可表示为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mrow><mtext>path </mtext><mi>θ</mi><mo>→</mo><mi mathvariant="script">L</mi></mrow></munder><mrow><mo fence="true">(</mo><munder><mo>∏</mo><mi>i</mi></munder><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mtext>op</mtext><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mtext>input</mtext><mi>i</mi></msub></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial \mathcal{L}}{\partial \theta} = \sum_{\text{path } \theta \to \mathcal{L}} \left( \prod_{i} \frac{\partial \text{op}_i}{\partial \text{input}_i} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathcal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3.1882em;vertical-align:-1.4382em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8479em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">path </span></span><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span><span class="mrel mtight">→</span><span class="mord mathcal mtight">L</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord text"><span class="mord">input</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2175em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord text"><span class="mord">op</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2175em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9301em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size4">)</span></span></span></span></span></span></span>
<p>这个公式我没懂，再深入解释一下。我只有本科程度的高等数学知识与线性代数知识，建议一步一步解释推理过程。</p>
</blockquote>
<blockquote>
<p>think</p>
<p>嗯，用户问的是关于反向传播中梯度计算的公式，那个公式看起来有点复杂，对吧？让我先仔细看看用户的问题。他提到，对于任意参数θ，梯度计算是路径θ到L的和，每个路径中的各个操作的导数相乘。用户本科数学和线性代数基础，可能需要更基础的解释。</p>
<p>首先，我需要确认用户对这个公式的理解程度。公式里的求和符号和路径可能让他困惑。可能用户对链式法则有一定的了解，但路径的概念不太清楚。比如，在计算图中，参数θ到损失L可能有多个不同的路径，每个路径对应一个梯度贡献，所以梯度是这些路径贡献的总和。</p>
<p>接下来，我需要用更简单的方式来解释这个公式。或许用一个具体的例子来说明会更好。比如，假设有一个简单的计算图，其中θ分两个路径影响L，每个路径都需要计算导数的乘积，然后将它们相加。</p>
<p>然后，我应该分步骤解释链式法则，以及为什么需要将不同路径的梯度相加。可能需要用图示来辅助，比如画一个简单的计算图，展示多个分支的情况，每个分支对应一个乘积项，最后相加得到总的梯度。</p>
<p>另外，用户可能对“路径”这个词不太理解，需要明确在计算图中的路径指的是什么。例如，一个参数可能在多个层中使用，每次使用都会创建一个不同的路径到损失函数，因此每个路径的梯度都需要被计算并累加。</p>
<p>还要注意，用户可能对乘积的部分有疑问，为什么是各个操作的导数相乘。这时候需要回顾链式法则的基本原理，即复合函数求导时，外层函数的导数和内层函数的导数相乘，而如果有多个中间步骤，就需要连乘这些导数。</p>
<p>可能还需要解释为什么会有多个路径，例如在神经网络中，一个参数可能在多个神经元中被使用，或者在不同的时间步（如RNN中），导致梯度需要从各个路径反向传播回来，然后累加起来。</p>
<p>最后，通过一个具体的数学例子，逐步计算每个步骤的导数，并将它们相乘，最后相加，来验证这个公式的正确性。这样用户可以通过实际的计算过程理解抽象的公式。</p>
<p>总结一下，我需要用具体的例子、图示，分步骤解释链式法则在计算图中的多个路径中的应用，以及梯度累加的原因，帮助用户理解这个公式的含义和推导过程。</p>
</blockquote>
<p>好的！我将用最直观的方式，通过一个具体例子逐步解释这个公式的数学原理。我们结合图示和分步推导来理解链式法则在反向传播中的应用。</p>
<hr/>
<h3 id="一问题场景设定"><a href="#一问题场景设定"><strong>一、问题场景设定</strong></a></h3>
<p>假设我们有一个简单的计算图，其中参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span> 通过两条路径影响最终损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span></span></span></span> ：</p>
<div class="relative h-[600px] py-4"><div class="absolute inset-0 flex items-center justify-center">Loading...</div></div>
<ul>
<li><strong>路径1</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext>Op1</mtext></mpadded></mover><mi>A</mi><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext>Op3</mtext></mpadded></mover><mi>L</mi></mrow><annotation encoding="application/x-tex">\theta \xrightarrow{\text{Op1}} A \xrightarrow{\text{Op3}} L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1113em;vertical-align:-0.011em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em"><span style="top:-3.322em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Op1</span></span></span></span></span><span class="svg-align" style="top:-2.689em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1113em;vertical-align:-0.011em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em"><span style="top:-3.322em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Op3</span></span></span></span></span><span class="svg-align" style="top:-2.689em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span></span></span></span></li>
<li><strong>路径2</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext>Op2</mtext></mpadded></mover><mi>B</mi><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext>Op3</mtext></mpadded></mover><mi>L</mi></mrow><annotation encoding="application/x-tex">\theta \xrightarrow{\text{Op2}} B \xrightarrow{\text{Op3}} L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1113em;vertical-align:-0.011em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em"><span style="top:-3.322em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Op2</span></span></span></span></span><span class="svg-align" style="top:-2.689em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1113em;vertical-align:-0.011em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em"><span style="top:-3.322em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Op3</span></span></span></span></span><span class="svg-align" style="top:-2.689em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span></span></span></span></li>
</ul>
<p>目标是计算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。</p>
<hr/>
<h3 id="二分步推导"><a href="#二分步推导"><strong>二、分步推导</strong></a></h3>
<h4 id="步骤1前向传播表达式"><a href="#步骤1前向传播表达式"><strong>步骤1：前向传播表达式</strong></a></h4>
<p>假设具体操作为：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msup><mi>θ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">A = \theta^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> （Op1：平方操作）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mn>2</mn><mi>θ</mi></mrow><annotation encoding="application/x-tex">B = 2\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span> （Op2：线性操作）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">L = A + B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span> （Op3：加法操作）</li>
</ul>
<p>则最终损失为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><msup><mi>θ</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi>θ</mi></mrow><annotation encoding="application/x-tex">L = \theta^2 + 2\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span>
<h4 id="步骤2直接求导对比验证"><a href="#步骤2直接求导对比验证"><strong>步骤2：直接求导（对比验证）</strong></a></h4>
<p>直接对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span></span></span></span> 求导：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>2</mn><mi>θ</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \theta} = 2\theta + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span></span>
<hr/>
<h4 id="步骤3反向传播视角"><a href="#步骤3反向传播视角"><strong>步骤3：反向传播视角</strong></a></h4>
<p>根据计算图，梯度需要沿着两条路径反向传播：</p>
<h5 id="路径1的梯度计算θ--a--l"><a href="#路径1的梯度计算θ--a--l"><strong>路径1的梯度计算（θ → A → L）</strong></a></h5>
<ol>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msup><mi>θ</mi><mn>2</mn></msup><mspace width="1em"></mspace><mo>⇒</mo><mspace width="1em"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>2</mn><mi>θ</mi></mrow><annotation encoding="application/x-tex">A = \theta^2 \quad \Rightarrow \quad \frac{\partial A}{\partial \theta} = 2\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi><mspace width="1em"></mspace><mo>⇒</mo><mspace width="1em"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L = A + B \quad \Rightarrow \quad \frac{\partial L}{\partial A} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight">A</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></li>
<li>路径1的梯度贡献：</li>
</ol>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">∣</mo><mtext>路径1</mtext></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>A</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>⋅</mo><mn>2</mn><mi>θ</mi><mo>=</mo><mn>2</mn><mi>θ</mi></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \theta} \bigg|_{\text{路径1}} = \frac{\partial L}{\partial A} \cdot \frac{\partial A}{\partial \theta} = 1 \cdot 2\theta = 2\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4497em;vertical-align:-0.9997em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.45em"><span class="pstrut" style="height:4.4em"></span><span style="width:0.333em;height:2.400em"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="2.400em" viewBox="0 0 333 2400"><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em"><span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.5214em"><span style="top:-1.7003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">路径</span><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">A</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span>
<h5 id="路径2的梯度计算θ--b--l"><a href="#路径2的梯度计算θ--b--l"><strong>路径2的梯度计算（θ → B → L）</strong></a></h5>
<ol>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mn>2</mn><mi>θ</mi><mspace width="1em"></mspace><mo>⇒</mo><mspace width="1em"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>B</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">B = 2\theta \quad \Rightarrow \quad \frac{\partial B}{\partial \theta} = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi><mspace width="1em"></mspace><mo>⇒</mo><mspace width="1em"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>B</mi></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L = A + B \quad \Rightarrow \quad \frac{\partial L}{\partial B} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></li>
<li>路径2的梯度贡献：</li>
</ol>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">∣</mo><mtext>路径2</mtext></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>B</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>B</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>⋅</mo><mn>2</mn><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \theta} \bigg|_{\text{路径2}} = \frac{\partial L}{\partial B} \cdot \frac{\partial B}{\partial \theta} = 1 \cdot 2 = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4497em;vertical-align:-0.9997em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.45em"><span class="pstrut" style="height:4.4em"></span><span style="width:0.333em;height:2.400em"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="2.400em" viewBox="0 0 333 2400"><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em"><span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.5214em"><span style="top:-1.7003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">路径</span><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span></span>
<h5 id="总梯度--路径1--路径2"><a href="#总梯度--路径1--路径2"><strong>总梯度 = 路径1 + 路径2</strong></a></h5>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>2</mn><mi>θ</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \theta} = 2\theta + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span></span>
<hr/>
<h3 id="三通用公式解析"><a href="#三通用公式解析"><strong>三、通用公式解析</strong></a></h3>
<p>原公式：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mrow><mtext>path </mtext><mi>θ</mi><mo>→</mo><mi mathvariant="script">L</mi></mrow></munder><mrow><mo fence="true">(</mo><munder><mo>∏</mo><mi>i</mi></munder><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mtext>op</mtext><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mtext>input</mtext><mi>i</mi></msub></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial \mathcal{L}}{\partial \theta} = \sum_{\text{path } \theta \to \mathcal{L}} \left( \prod_{i} \frac{\partial \text{op}_i}{\partial \text{input}_i} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathcal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3.1882em;vertical-align:-1.4382em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8479em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">path </span></span><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span><span class="mrel mtight">→</span><span class="mord mathcal mtight">L</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord text"><span class="mord">input</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2175em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord text"><span class="mord">op</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2175em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9301em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size4">)</span></span></span></span></span></span></span>
<h4 id="1-符号解释"><a href="#1-符号解释"><strong>1. 符号解释</strong></a></h4>
<ul>
<li><strong>路径（Path）</strong>：参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span> 到损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal">L</span></span></span></span> 的所有可能数据流动路径。</li>
<li><strong>乘积项 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∏</mo></mrow><annotation encoding="application/x-tex">\prod</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∏</span></span></span></span></strong>：沿某条路径的所有操作（op）的导数连乘（链式法则）。</li>
<li><strong>求和项 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo></mrow><annotation encoding="application/x-tex">\sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span></span></span></span></strong>：将所有路径的梯度贡献相加（多路径时梯度累加）。</li>
</ul>
<h4 id="2-关键性质"><a href="#2-关键性质"><strong>2. 关键性质</strong></a></h4>
<ul>
<li><strong>链式法则</strong>：复合函数的导数 = 外层导数 × 内层导数。</li>
<li><strong>多路径叠加</strong>：如果参数影响输出的多个分支，梯度是各分支贡献的总和。</li>
</ul>
<hr/>
<h3 id="四复杂案例验证"><a href="#四复杂案例验证"><strong>四、复杂案例验证</strong></a></h3>
<p>考虑一个更复杂的计算图：</p>
<div class="relative h-[600px] py-4"><div class="absolute inset-0 flex items-center justify-center">Loading...</div></div>
<h4 id="前向传播表达式"><a href="#前向传播表达式"><strong>前向传播表达式</strong></a></h4>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>θ</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">C = \theta^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span>（Op1）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D = \sin(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span>（Op2）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mi>C</mi><mo>⋅</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">E = C \cdot D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span></span></span></span>（Op3）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L = \ln(E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mclose">)</span></span></span></span>（Op4）</li>
</ul>
<h4 id="反向传播计算"><a href="#反向传播计算"><strong>反向传播计算</strong></a></h4>
<h5 id="路径1θ--c--e--l"><a href="#路径1θ--c--e--l"><strong>路径1：θ → C → E → L</strong></a></h5>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">∣</mo><mtext>路径1</mtext></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>E</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>E</mi></mfrac><mo>⋅</mo><mi>D</mi><mo>⋅</mo><mn>3</mn><msup><mi>θ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \theta} \bigg|_{\text{路径1}} = \frac{\partial L}{\partial E} \cdot \frac{\partial E}{\partial C} \cdot \frac{\partial C}{\partial \theta} = \frac{1}{E} \cdot D \cdot 3\theta^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4497em;vertical-align:-0.9997em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.45em"><span class="pstrut" style="height:4.4em"></span><span style="width:0.333em;height:2.400em"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="2.400em" viewBox="0 0 333 2400"><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em"><span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.5214em"><span style="top:-1.7003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">路径</span><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8641em"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>
<h5 id="路径2θ--d--e--l"><a href="#路径2θ--d--e--l"><strong>路径2：θ → D → E → L</strong></a></h5>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">∣</mo><mtext>路径2</mtext></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>E</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>D</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>D</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>E</mi></mfrac><mo>⋅</mo><mi>C</mi><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \theta} \bigg|_{\text{路径2}} = \frac{\partial L}{\partial E} \cdot \frac{\partial E}{\partial D} \cdot \frac{\partial D}{\partial \theta} = \frac{1}{E} \cdot C \cdot \cos(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4497em;vertical-align:-0.9997em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.45em"><span class="pstrut" style="height:4.4em"></span><span style="width:0.333em;height:2.400em"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="2.400em" viewBox="0 0 333 2400"><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em"><span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.5214em"><span style="top:-1.7003em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">路径</span><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span></span>
<h5 id="总梯度"><a href="#总梯度"><strong>总梯度</strong></a></h5>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mo>⋅</mo><mn>3</mn><msup><mi>θ</mi><mn>2</mn></msup><mo>+</mo><mi>C</mi><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mi>E</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \theta} = \frac{D \cdot 3\theta^2 + C \cdot \cos(\theta)}{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.1771em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<hr/>
<h3 id="五反向传播的本质"><a href="#五反向传播的本质"><strong>五、反向传播的本质</strong></a></h3>
<ol>
<li><strong>自动化的链式法则</strong>：框架通过计算图自动追踪操作路径。</li>
<li><strong>梯度累加规则</strong>：当一个参数影响多个分支时，梯度是所有路径贡献的总和。</li>
<li><strong>计算效率</strong>：避免重复计算，时间复杂度与网络深度成线性关系（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>）。</li>
</ol>
<hr/>
<h3 id="六总结"><a href="#六总结"><strong>六、总结</strong></a></h3>
<ul>
<li><strong>为什么需要求和（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo></mrow><annotation encoding="application/x-tex">\sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span></span></span></span>）</strong>：因为参数可能通过多个路径影响损失，每个路径贡献一部分梯度。</li>
<li><strong>为什么需要连乘（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∏</mo></mrow><annotation encoding="application/x-tex">\prod</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop op-symbol small-op" style="position:relative;top:0em">∏</span></span></span></span>）</strong>：链式法则要求将路径上的所有局部导数相乘。</li>
<li><strong>反向传播的优势</strong>：将复杂的全局求导分解为局部导数的连乘与路径求和，大幅降低计算复杂度。</li>
</ul>
<p>通过这种分路径计算再累加的方式，反向传播巧妙地利用计算图的结构信息，实现了高效的梯度计算。</p>
<h2 id="q-从-pytorch-代码层面深入解释一下-pytorch-的反向传播如何实现"><a href="#q-从-pytorch-代码层面深入解释一下-pytorch-的反向传播如何实现">Q: 从 PyTorch 代码层面深入解释一下 PyTorch 的反向传播如何实现</a></h2>
<blockquote>
<p>query</p>
<p>从 PyTorch 代码层面深入解释一下 PyTorch 的反向传播如何实现</p>
</blockquote>
<blockquote>
<p>think</p>
<p>嗯，用户之前已经了解了反向传播的数学原理和为什么需要它，现在他们想从PyTorch代码层面深入理解反向传播的实现。用户可能有一定的编程基础，但可能对PyTorch的内部机制不太熟悉。我需要确保解释清晰，结合代码示例，同时避免过于复杂的术语。</p>
<p>首先，用户提到了之前的公式，关于梯度的路径求和，现在需要将这一数学概念与PyTorch的具体实现联系起来。他们可能想知道PyTorch是如何动态构建计算图的，如何跟踪梯度，以及backward()方法具体做了什么。</p>
<p>接下来，我应该分步骤解释PyTorch的关键组件，比如Tensor的requires_grad属性、grad_fn、grad属性，以及动态计算图的构建过程。需要举例说明，比如一个简单的计算图，并展示梯度是如何累积的。同时，用户可能对梯度累积和内存管理感兴趣，比如PyTorch如何释放中间变量，如何通过retain_grad()来保留梯度。</p>
<p>另外，用户可能对多路径梯度累加的情况有疑问，比如当多个操作影响同一个参数时，梯度是如何相加的。这时候需要举例说明，比如一个参数通过两条路径影响损失函数，PyTorch如何处理这种情况。</p>
<p>还需要提到Autograd引擎的工作原理，比如如何遍历计算图，执行反向传播，以及如何优化计算效率。可能还需要讨论一些高级话题，比如detach()的作用，或者如何自定义反向传播函数，但根据用户的知识水平，可能需要保持基础。</p>
<p>用户可能存在的误区是认为PyTorch会保存所有中间变量的梯度，但实际上默认只保留叶子节点的梯度。这需要特别说明，并解释如何通过retain_grad()来查看中间节点的梯度。</p>
<p>最后，应该总结PyTorch反向传播的关键点，强调其动态计算图的优势，以及如何高效管理内存和计算资源。确保用户理解为什么PyTorch适合动态图模型，以及在实际调试中如何利用这些机制。</p>
</blockquote>
<p>以下是关于 PyTorch 反向传播实现机制的代码级深入解析，结合关键代码段和底层原理说明：</p>
<hr/>
<h3 id="一pytorch-反向传播的三大核心组件"><a href="#一pytorch-反向传播的三大核心组件"><strong>一、PyTorch 反向传播的三大核心组件</strong></a></h3>
<h4 id="1-tensor-的梯度追踪机制"><a href="#1-tensor-的梯度追踪机制"><strong>1. Tensor 的梯度追踪机制</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#3E8FB0">import</span><span style="color:#E0DEF4"> torch</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 创建需要梯度追踪的张量</span></span>
<span data-line=""><span style="color:#E0DEF4">x </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#EA9A97">2.0</span><span style="color:#908CAA">],</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 叶子节点</span></span>
<span data-line=""><span style="color:#E0DEF4">W </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#EA9A97">3.0</span><span style="color:#908CAA">],</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 叶子节点</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 执行计算（自动记录操作）</span></span>
<span data-line=""><span style="color:#E0DEF4">y </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> W </span><span style="color:#3E8FB0">*</span><span style="color:#E0DEF4"> x           </span><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> grad_fn=&lt;MulBackward0&gt;</span></span>
<span data-line=""><span style="color:#E0DEF4">z </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> y </span><span style="color:#3E8FB0">+</span><span style="color:#EA9A97"> 1</span><span style="color:#908CAA;font-style:italic">           #</span><span style="color:#6E6A86;font-style:italic"> grad_fn=&lt;AddBackward0&gt;</span></span>
<span data-line=""><span style="color:#E0DEF4">loss </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> z</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">mean</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">      #</span><span style="color:#6E6A86;font-style:italic"> grad_fn=&lt;MeanBackward0&gt;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">loss</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad_fn</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 输出: &lt;MeanBackward0 object&gt;</span></span></code></pre></figure>
<ul>
<li><strong><code>requires_grad=True</code></strong>：标记需要追踪梯度的张量（叶子节点）</li>
<li><strong><code>grad_fn</code></strong>：记录创建该张量的操作（反向传播时知道如何计算梯度）</li>
</ul>
<h4 id="2-计算图的动态构建"><a href="#2-计算图的动态构建"><strong>2. 计算图的动态构建</strong></a></h4>
<p>PyTorch 的计算图是<strong>动态构建的</strong>，每次前向传播都会新建一个图：</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 示例：动态图特性</span></span>
<span data-line=""><span style="color:#3E8FB0">def</span><span style="color:#EA9A97"> forward</span><span style="color:#908CAA">(</span><span style="color:#C4A7E7;font-style:italic">x</span><span style="color:#908CAA">):</span></span>
<span data-line=""><span style="color:#3E8FB0">    if</span><span style="color:#E0DEF4"> x</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">sum</span><span style="color:#908CAA">()</span><span style="color:#3E8FB0"> &gt;</span><span style="color:#EA9A97"> 0</span><span style="color:#908CAA">:</span></span>
<span data-line=""><span style="color:#3E8FB0">        return</span><span style="color:#E0DEF4"> x </span><span style="color:#3E8FB0">*</span><span style="color:#EA9A97"> 2</span></span>
<span data-line=""><span style="color:#3E8FB0">    else</span><span style="color:#908CAA">:</span></span>
<span data-line=""><span style="color:#3E8FB0">        return</span><span style="color:#E0DEF4"> x </span><span style="color:#3E8FB0">*</span><span style="color:#908CAA"> (</span><span style="color:#3E8FB0">-</span><span style="color:#EA9A97">1</span><span style="color:#908CAA">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#E0DEF4">x </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#EA9A97">3.0</span><span style="color:#908CAA">],</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">out </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> forward</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">x</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 根据输入值动态创建不同的计算图</span></span>
<span data-line=""><span style="color:#E0DEF4">out</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">    #</span><span style="color:#6E6A86;font-style:italic"> 自动适应不同的分支路径</span></span></code></pre></figure>
<h4 id="3-反向传播引擎autograd-engine"><a href="#3-反向传播引擎autograd-engine"><strong>3. 反向传播引擎（Autograd Engine）</strong></a></h4>
<p>当调用 <code>.backward()</code> 时，PyTorch 会执行以下操作：</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">loss</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 触发反向传播</span></span></code></pre></figure>
<ul>
<li><strong>反向遍历计算图</strong>：从 <code>loss</code> 的 <code>grad_fn</code> 开始，沿着 <code>next_functions</code> 递归</li>
<li><strong>计算局部梯度</strong>：在每个操作节点调用已注册的 <code>backward()</code> 方法</li>
<li><strong>梯度累加</strong>：将计算结果累积到对应张量的 <code>.grad</code> 属性中</li>
</ul>
<hr/>
<h3 id="二代码级反向传播流程分解"><a href="#二代码级反向传播流程分解"><strong>二、代码级反向传播流程分解</strong></a></h3>
<h4 id="步骤1前向传播构建计算图"><a href="#步骤1前向传播构建计算图"><strong>步骤1：前向传播构建计算图</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">a </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">(</span><span style="color:#EA9A97">2.0</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">b </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">(</span><span style="color:#EA9A97">3.0</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">c </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> a </span><span style="color:#3E8FB0">*</span><span style="color:#E0DEF4"> b      </span><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> grad_fn=&lt;MulBackward0&gt;</span></span>
<span data-line=""><span style="color:#E0DEF4">d </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> c </span><span style="color:#3E8FB0">+</span><span style="color:#EA9A97"> 1</span><span style="color:#908CAA;font-style:italic">      #</span><span style="color:#6E6A86;font-style:italic"> grad_fn=&lt;AddBackward0&gt;</span></span>
<span data-line=""><span style="color:#E0DEF4">loss </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> d</span><span style="color:#3E8FB0">**</span><span style="color:#EA9A97">2</span><span style="color:#908CAA;font-style:italic">    #</span><span style="color:#6E6A86;font-style:italic"> grad_fn=&lt;PowBackward0&gt;</span></span></code></pre></figure>
<p>此时的计算图结构：</p>
<div class="relative h-[600px] py-4"><div class="absolute inset-0 flex items-center justify-center">Loading...</div></div>
<h4 id="步骤2执行反向传播"><a href="#步骤2执行反向传播"><strong>步骤2：执行反向传播</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">loss</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 触发反向传播</span></span></code></pre></figure>
<h5 id="底层操作分解"><a href="#底层操作分解"><strong>底层操作分解</strong>：</a></h5>
<ol>
<li><strong>初始化梯度</strong>：设置 <code>loss.grad = 1.0</code>（标量损失的默认梯度）</li>
<li><strong>反向传播到 d</strong>：<!-- -->
<ul>
<li>调用 <code>PowBackward0</code> 的 <code>backward()</code> 方法：<!-- -->
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">d_grad </span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97"> 2</span><span style="color:#3E8FB0"> *</span><span style="color:#E0DEF4"> d  </span><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 导数公式：d(loss)/d(d) = 2d</span></span></code></pre></figure>
</li>
</ul>
</li>
<li><strong>反向传播到 c</strong>：<!-- -->
<ul>
<li>调用 <code>AddBackward0</code> 的 <code>backward()</code> 方法：<!-- -->
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">c_grad </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> d_grad </span><span style="color:#3E8FB0">*</span><span style="color:#EA9A97"> 1</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 加法操作的导数为1</span></span></code></pre></figure>
</li>
</ul>
</li>
<li><strong>反向传播到 a 和 b</strong>：<!-- -->
<ul>
<li>调用 <code>MulBackward0</code> 的 <code>backward()</code> 方法：<!-- -->
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">a_grad </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> c_grad </span><span style="color:#3E8FB0">*</span><span style="color:#E0DEF4"> b  </span><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 导数公式：d(c)/d(a) = b</span></span>
<span data-line=""><span style="color:#E0DEF4">b_grad </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> c_grad </span><span style="color:#3E8FB0">*</span><span style="color:#E0DEF4"> a  </span><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 导数公式：d(c)/d(b) = a</span></span></code></pre></figure>
</li>
</ul>
</li>
<li><strong>梯度累加</strong>：<!-- -->
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">a</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad </span><span style="color:#3E8FB0">+=</span><span style="color:#E0DEF4"> a_grad  </span><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 实际为 in-place 操作</span></span>
<span data-line=""><span style="color:#E0DEF4">b</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad </span><span style="color:#3E8FB0">+=</span><span style="color:#E0DEF4"> b_grad</span></span></code></pre></figure>
</li>
</ol>
<h4 id="步骤3查看结果"><a href="#步骤3查看结果"><strong>步骤3：查看结果</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">a</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 输出: 2*d* b = 2*(2*3+1)*3 = 42</span></span>
<span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">b</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 输出: 2*d* a = 2*(2*3+1)*2 = 28</span></span></code></pre></figure>
<hr/>
<h3 id="三pytorch-反向传播的关键实现细节"><a href="#三pytorch-反向传播的关键实现细节"><strong>三、PyTorch 反向传播的关键实现细节</strong></a></h3>
<h4 id="1-梯度计算规则注册"><a href="#1-梯度计算规则注册"><strong>1. 梯度计算规则注册</strong></a></h4>
<p>每个 <code>torch</code> 操作都有预定义的梯度计算规则：</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 示例：自定义操作的梯度规则</span></span>
<span data-line=""><span style="color:#3E8FB0">class</span><span style="color:#9CCFD8"> MyAdd</span><span style="color:#908CAA">(</span><span style="color:#C4A7E7;font-style:italic">torch</span><span style="color:#908CAA">.</span><span style="color:#C4A7E7;font-style:italic">autograd</span><span style="color:#908CAA">.</span><span style="color:#C4A7E7;font-style:italic">Function</span><span style="color:#908CAA">):</span></span>
<span data-line=""><span style="color:#908CAA">    @</span><span style="color:#9CCFD8">staticmethod</span></span>
<span data-line=""><span style="color:#3E8FB0">    def</span><span style="color:#EA9A97"> forward</span><span style="color:#908CAA">(</span><span style="color:#C4A7E7;font-style:italic">ctx</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> x</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> y</span><span style="color:#908CAA">):</span></span>
<span data-line=""><span style="color:#E0DEF4">        ctx</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">save_for_backward</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">x</span><span style="color:#908CAA">,</span><span style="color:#E0DEF4"> y</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 保存前向传播的输入</span></span>
<span data-line=""><span style="color:#3E8FB0">        return</span><span style="color:#E0DEF4"> x </span><span style="color:#3E8FB0">+</span><span style="color:#E0DEF4"> y</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#908CAA">    @</span><span style="color:#9CCFD8">staticmethod</span></span>
<span data-line=""><span style="color:#3E8FB0">    def</span><span style="color:#EA9A97"> backward</span><span style="color:#908CAA">(</span><span style="color:#C4A7E7;font-style:italic">ctx</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> grad_output</span><span style="color:#908CAA">):</span></span>
<span data-line=""><span style="color:#E0DEF4">        x</span><span style="color:#908CAA">,</span><span style="color:#E0DEF4"> y </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> ctx</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">saved_tensors</span></span>
<span data-line=""><span style="color:#3E8FB0">        return</span><span style="color:#E0DEF4"> grad_output </span><span style="color:#3E8FB0">*</span><span style="color:#EA9A97"> 1</span><span style="color:#908CAA">,</span><span style="color:#E0DEF4"> grad_output </span><span style="color:#3E8FB0">*</span><span style="color:#EA9A97"> 1</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 加法操作的导数</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 使用自定义操作</span></span>
<span data-line=""><span style="color:#E0DEF4">a </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">(</span><span style="color:#EA9A97">2.0</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">b </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">(</span><span style="color:#EA9A97">3.0</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">c </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> MyAdd</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">apply</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">a</span><span style="color:#908CAA">,</span><span style="color:#E0DEF4"> b</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">c</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span></span></code></pre></figure>
<h4 id="2-梯度累加机制"><a href="#2-梯度累加机制"><strong>2. 梯度累加机制</strong></a></h4>
<p>PyTorch 默认会<strong>累加梯度</strong>，因此每次反向传播前需要手动清零：</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">optimizer</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">zero_grad</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 标准训练循环中的必要操作</span></span>
<span data-line=""><span style="color:#E0DEF4">loss</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">        #</span><span style="color:#6E6A86;font-style:italic"> 梯度会累加到 .grad 属性中</span></span>
<span data-line=""><span style="color:#E0DEF4">optimizer</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">step</span><span style="color:#908CAA">()</span></span></code></pre></figure>
<h4 id="3-非标量张量的反向传播"><a href="#3-非标量张量的反向传播"><strong>3. 非标量张量的反向传播</strong></a></h4>
<p>当输出为非标量时，需要提供 <code>gradient</code> 参数：</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">x </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#EA9A97">1.0</span><span style="color:#908CAA">,</span><span style="color:#EA9A97"> 2.0</span><span style="color:#908CAA">],</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">y </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> x </span><span style="color:#3E8FB0">*</span><span style="color:#EA9A97"> 2</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 假设 y 是向量，需要提供梯度初始值</span></span>
<span data-line=""><span style="color:#E0DEF4">y</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">(</span><span style="color:#C4A7E7;font-style:italic">gradient</span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4">torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">([</span><span style="color:#EA9A97">0.1</span><span style="color:#908CAA">,</span><span style="color:#EA9A97"> 0.2</span><span style="color:#908CAA">]))</span><span style="color:#E0DEF4">  </span></span>
<span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">x</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 输出: tensor([0.2, 0.4])</span></span></code></pre></figure>
<h4 id="4-内存优化策略"><a href="#4-内存优化策略"><strong>4. 内存优化策略</strong></a></h4>
<ul>
<li><strong>中间变量释放</strong>：默认只保留叶子节点的梯度</li>
<li><strong>梯度检查点</strong>：通过 <code>torch.utils.checkpoint</code> 减少内存占用</li>
<li><strong>禁用梯度计算</strong>：使用 <code>with torch.no_grad():</code> 或 <code>@torch.inference_mode()</code></li>
</ul>
<hr/>
<h3 id="四可视化反向传播过程"><a href="#四可视化反向传播过程"><strong>四、可视化反向传播过程</strong></a></h3>
<h4 id="示例代码"><a href="#示例代码"><strong>示例代码</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#3E8FB0">import</span><span style="color:#E0DEF4"> torchviz</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#E0DEF4">a </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">(</span><span style="color:#EA9A97">3.0</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">b </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">tensor</span><span style="color:#908CAA">(</span><span style="color:#EA9A97">4.0</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> requires_grad</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">True</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">c </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> a </span><span style="color:#3E8FB0">*</span><span style="color:#E0DEF4"> b</span></span>
<span data-line=""><span style="color:#E0DEF4">d </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> c</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">sin</span><span style="color:#908CAA">()</span></span>
<span data-line=""><span style="color:#E0DEF4">d</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 生成计算图可视化</span></span>
<span data-line=""><span style="color:#E0DEF4">torchviz</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">make_dot</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">d</span><span style="color:#908CAA">,</span><span style="color:#C4A7E7;font-style:italic"> params</span><span style="color:#3E8FB0">=</span><span style="color:#908CAA">{</span><span style="color:#F6C177">&#x27;a&#x27;</span><span style="color:#908CAA">:</span><span style="color:#E0DEF4">a</span><span style="color:#908CAA">,</span><span style="color:#F6C177"> &#x27;b&#x27;</span><span style="color:#908CAA">:</span><span style="color:#E0DEF4">b</span><span style="color:#908CAA">}).</span><span style="color:#E0DEF4">render</span><span style="color:#908CAA">(</span><span style="color:#F6C177">&quot;graph&quot;</span><span style="color:#908CAA">)</span></span></code></pre></figure>
<h4 id="生成的计算图结构"><a href="#生成的计算图结构"><strong>生成的计算图结构</strong></a></h4>
<div class="relative h-[600px] py-4"><div class="absolute inset-0 flex items-center justify-center">Loading...</div></div>
<hr/>
<h3 id="五pytorch-反向传播的性能优化"><a href="#五pytorch-反向传播的性能优化"><strong>五、PyTorch 反向传播的性能优化</strong></a></h3>
<h4 id="1-异步执行"><a href="#1-异步执行"><strong>1. 异步执行</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#908CAA;font-style:italic">#</span><span style="color:#6E6A86;font-style:italic"> 使用 CUDA 流实现异步计算</span></span>
<span data-line=""><span style="color:#3E8FB0">with</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">cuda</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">stream</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">cuda</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">Stream</span><span style="color:#908CAA">()):</span></span>
<span data-line=""><span style="color:#E0DEF4">    loss</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 在非默认流中执行反向传播</span></span></code></pre></figure>
<h4 id="2-混合精度训练"><a href="#2-混合精度训练"><strong>2. 混合精度训练</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">scaler </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">cuda</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">amp</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">GradScaler</span><span style="color:#908CAA">()</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#3E8FB0">with</span><span style="color:#E0DEF4"> torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">cuda</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">amp</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">autocast</span><span style="color:#908CAA">():</span></span>
<span data-line=""><span style="color:#E0DEF4">    output </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> model</span><span style="color:#908CAA">(</span><span style="color:#EB6F92;font-style:italic">input</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">    loss </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> loss_fn</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">output</span><span style="color:#908CAA">,</span><span style="color:#E0DEF4"> target</span><span style="color:#908CAA">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#E0DEF4">scaler</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">scale</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">loss</span><span style="color:#908CAA">).</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 自动缩放梯度</span></span>
<span data-line=""><span style="color:#E0DEF4">scaler</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">step</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">optimizer</span><span style="color:#908CAA">)</span></span>
<span data-line=""><span style="color:#E0DEF4">scaler</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">update</span><span style="color:#908CAA">()</span></span></code></pre></figure>
<h4 id="3-梯度裁剪"><a href="#3-梯度裁剪"><strong>3. 梯度裁剪</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">torch</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">nn</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">utils</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">clip_grad_norm_</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">model</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">parameters</span><span style="color:#908CAA">(),</span><span style="color:#C4A7E7;font-style:italic"> max_norm</span><span style="color:#3E8FB0">=</span><span style="color:#EA9A97">1.0</span><span style="color:#908CAA">)</span></span></code></pre></figure>
<hr/>
<h3 id="六调试技巧"><a href="#六调试技巧"><strong>六、调试技巧</strong></a></h3>
<h4 id="1-检查梯度是否存在"><a href="#1-检查梯度是否存在"><strong>1. 检查梯度是否存在</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">([</span><span style="color:#E0DEF4">p</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">requires_grad </span><span style="color:#3E8FB0">for</span><span style="color:#E0DEF4"> p </span><span style="color:#3E8FB0">in</span><span style="color:#E0DEF4"> model</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">parameters</span><span style="color:#908CAA">()])</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 检查参数是否启用梯度</span></span></code></pre></figure>
<h4 id="2-梯度数值检查"><a href="#2-梯度数值检查"><strong>2. 梯度数值检查</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#3E8FB0">for</span><span style="color:#E0DEF4"> name</span><span style="color:#908CAA">,</span><span style="color:#E0DEF4"> param </span><span style="color:#3E8FB0">in</span><span style="color:#E0DEF4"> model</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">named_parameters</span><span style="color:#908CAA">():</span></span>
<span data-line=""><span style="color:#3E8FB0">    if</span><span style="color:#E0DEF4"> param</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad </span><span style="color:#3E8FB0">is</span><span style="color:#3E8FB0"> not</span><span style="color:#EA9A97"> None</span><span style="color:#908CAA">:</span></span>
<span data-line=""><span style="color:#EB6F92;font-style:italic">        print</span><span style="color:#908CAA">(</span><span style="color:#3E8FB0">f</span><span style="color:#F6C177">&quot;</span><span style="color:#3E8FB0">{</span><span style="color:#E0DEF4">name</span><span style="color:#3E8FB0">}</span><span style="color:#F6C177"> 梯度均值: </span><span style="color:#3E8FB0">{</span><span style="color:#E0DEF4">param</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">mean</span><span style="color:#908CAA">().</span><span style="color:#E0DEF4">item</span><span style="color:#908CAA">()</span><span style="color:#3E8FB0">}</span><span style="color:#F6C177">&quot;</span><span style="color:#908CAA">)</span></span></code></pre></figure>
<h4 id="3-保留中间梯度"><a href="#3-保留中间梯度"><strong>3. 保留中间梯度</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="python" data-theme="rose-pine-moon"><code data-language="python" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#E0DEF4">y </span><span style="color:#3E8FB0">=</span><span style="color:#E0DEF4"> x </span><span style="color:#3E8FB0">*</span><span style="color:#EA9A97"> 2</span></span>
<span data-line=""><span style="color:#E0DEF4">y</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">retain_grad</span><span style="color:#908CAA">()</span><span style="color:#908CAA;font-style:italic">  #</span><span style="color:#6E6A86;font-style:italic"> 强制保留中间变量的梯度</span></span>
<span data-line=""><span style="color:#E0DEF4">y</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">backward</span><span style="color:#908CAA">()</span></span>
<span data-line=""><span style="color:#EB6F92;font-style:italic">print</span><span style="color:#908CAA">(</span><span style="color:#E0DEF4">y</span><span style="color:#908CAA">.</span><span style="color:#E0DEF4">grad</span><span style="color:#908CAA">)</span><span style="color:#908CAA;font-style:italic">    #</span><span style="color:#6E6A86;font-style:italic"> 可以查看中间梯度</span></span></code></pre></figure>
<hr/>
<h3 id="七底层实现原理"><a href="#七底层实现原理"><strong>七、底层实现原理</strong></a></h3>
<h4 id="1-c-核心引擎"><a href="#1-c-核心引擎"><strong>1. C++ 核心引擎</strong></a></h4>
<p>PyTorch 的反向传播引擎主要由以下 C++ 组件构成：</p>
<ul>
<li><strong><code>torch::autograd::Engine</code></strong>：管理反向传播任务的执行</li>
<li><strong><code>torch::autograd::Node</code></strong>：表示计算图中的操作节点</li>
<li><strong><code>torch::autograd::Edge</code></strong>：表示节点之间的连接关系</li>
</ul>
<h4 id="2-反向传播任务调度"><a href="#2-反向传播任务调度"><strong>2. 反向传播任务调度</strong></a></h4>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#232136;color:#e0def4" tabindex="0" data-language="cpp" data-theme="rose-pine-moon"><code data-language="cpp" data-theme="rose-pine-moon" style="display:grid"><span data-line=""><span style="color:#908CAA;font-style:italic">//</span><span style="color:#6E6A86;font-style:italic"> 伪代码：引擎执行流程</span></span>
<span data-line=""><span style="color:#3E8FB0">void</span><span style="color:#EA9A97"> Engine</span><span style="color:#908CAA">::</span><span style="color:#EA9A97">execute</span><span style="color:#908CAA">(</span><span style="color:#3E8FB0">const</span><span style="color:#9CCFD8"> EdgeList</span><span style="color:#3E8FB0">&amp;</span><span style="color:#C4A7E7;font-style:italic"> roots</span><span style="color:#908CAA">)</span><span style="color:#908CAA"> {</span></span>
<span data-line=""><span style="color:#908CAA;font-style:italic">    //</span><span style="color:#6E6A86;font-style:italic"> 1. 构建任务队列</span></span>
<span data-line=""><span style="color:#908CAA;font-style:italic">    //</span><span style="color:#6E6A86;font-style:italic"> 2. 使用线程池并行执行反向任务</span></span>
<span data-line=""><span style="color:#908CAA;font-style:italic">    //</span><span style="color:#6E6A86;font-style:italic"> 3. 处理依赖关系（拓扑排序）</span></span>
<span data-line=""><span style="color:#908CAA;font-style:italic">    //</span><span style="color:#6E6A86;font-style:italic"> 4. 调用每个 Node 的 apply() 方法</span></span>
<span data-line=""><span style="color:#908CAA">}</span></span></code></pre></figure>
<hr/>
<h3 id="八总结pytorch-反向传播的设计哲学"><a href="#八总结pytorch-反向传播的设计哲学"><strong>八、总结：PyTorch 反向传播的设计哲学</strong></a></h3>
<ol>
<li><strong>动态计算图</strong>：即时构建、即时销毁，灵活适应可变网络结构</li>
<li><strong>延迟计算</strong>：只在需要时执行梯度计算，优化内存使用</li>
<li><strong>分离式设计</strong>：前向传播记录操作，反向传播时执行实际计算</li>
<li><strong>可扩展性</strong>：通过注册自定义 Function 支持任意复杂操作</li>
</ol>
<p>理解这些底层机制，可以帮助开发者：</p>
<ul>
<li>更高效地调试梯度相关问题</li>
<li>合理控制内存使用（如使用 <code>detach()</code> 截断计算图）</li>
<li>实现自定义神经网络层和损失函数</li>
<li>优化训练过程的性能</li>
</ul></div><div class="w-96 text-gray-700 leading-none"><span class="!text-sm"><a class="!inline-block !p-0 !m-0 align-text-bottom" rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" loading="lazy" width="88" height="31" decoding="async" data-nimg="1" class="!m-0 h-4 w-auto pr-1" style="color:transparent;border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png"/></a>This work is licensed under a<!-- --> <a class="underline" rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.</span></div><div class="TagsBox_tagsBox__WzhAf mt-4"><a href="/blog-next/tags/pytorch"><div class="TagsBox_tag__Rk32C">PyTorch</div></a><a href="/blog-next/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0"><div class="TagsBox_tag__Rk32C">深度学习</div></a><a href="/blog-next/tags/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD"><div class="TagsBox_tag__Rk32C">反向传播</div></a><a href="/blog-next/tags/%E8%87%AA%E5%8A%A8%E5%BE%AE%E5%88%86"><div class="TagsBox_tag__Rk32C">自动微分</div></a><a href="/blog-next/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><div class="TagsBox_tag__Rk32C">学习笔记</div></a></div><div class="mt-4 mb-4 flex justify-center"><div class="mr-0 ml-auto"><a href="/blog-next/learn_from_ai/lora-matrix-initialization-strategy">LoRA微调中的矩阵初始化策略：A随机与B零初始化 -&gt;</a></div></div><hr class="mt-4"/></article></div></div><footer class="DefaultLayout_footer__n5339"><div class="max-w-3xl mx-auto p-2 w-full"><div class="flex flex-row justify-center items-center"><div class="DefaultLayout_footerLeft__j0yvY">© 2023 Ryo Jerry Yu. All rights reserved.</div><div class="DefaultLayout_footerRight___Dn67"><div class=" flex flex-row gap-8 items-center justify-center"><a title="Twitter" href="https://twitter.com/ryo_okami"><svg class="DefaultLayout_footerIcon__sgrmB h-8 w-8" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a title="GitHub" href="https://github.com/RyoJerryYu"><svg class="DefaultLayout_footerIcon__sgrmB h-8 w-8" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a title="Pixiv" href="https://www.pixiv.net/users/9159893"><svg class="DefaultLayout_footerIcon__sgrmB h-8 w-8" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4.935 0A4.924 4.924 0 0 0 0 4.935v14.13A4.924 4.924 0 0 0 4.935 24h14.13A4.924 4.924 0 0 0 24 19.065V4.935A4.924 4.924 0 0 0 19.065 0zm7.81 4.547c2.181 0 4.058.676 5.399 1.847a6.118 6.118 0 0 1 2.116 4.66c.005 1.854-.88 3.476-2.257 4.563-1.375 1.092-3.225 1.697-5.258 1.697-2.314 0-4.46-.842-4.46-.842v2.718c.397.116 1.048.365.635.779H5.79c-.41-.41.19-.65.644-.779V7.666c-1.053.81-1.593 1.51-1.868 2.031.32 1.02-.284.969-.284.969l-1.09-1.73s3.868-4.39 9.553-4.39zm-.19.971c-1.423-.003-3.184.473-4.27 1.244v8.646c.988.487 2.484.832 4.26.832h.01c1.596 0 2.98-.593 3.93-1.533.952-.948 1.486-2.183 1.492-3.683-.005-1.54-.504-2.864-1.42-3.86-.918-.992-2.274-1.645-4.002-1.646Z"></path></svg></a></div></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"pytorch-backpropagation-mechanism","tags":[{"tag":"PyTorch","slug":"pytorch","path":"/tags/pytorch","postSlugs":[{"postType":"learn_from_ai","postSlug":"deep-learning-model-formats","postPagePath":"/learn_from_ai/deep-learning-model-formats"},{"postType":"learn_from_ai","postSlug":"pytorch-backpropagation-mechanism","postPagePath":"/learn_from_ai/pytorch-backpropagation-mechanism"}]},{"tag":"深度学习","slug":"深度学习","path":"/tags/深度学习","postSlugs":[{"postType":"learn_from_ai","postSlug":"deep-learning-model-formats","postPagePath":"/learn_from_ai/deep-learning-model-formats"},{"postType":"learn_from_ai","postSlug":"lora-matrix-initialization-strategy","postPagePath":"/learn_from_ai/lora-matrix-initialization-strategy"},{"postType":"learn_from_ai","postSlug":"pytorch-backpropagation-mechanism","postPagePath":"/learn_from_ai/pytorch-backpropagation-mechanism"}]},{"tag":"反向传播","slug":"反向传播","path":"/tags/反向传播","postSlugs":[{"postType":"learn_from_ai","postSlug":"pytorch-backpropagation-mechanism","postPagePath":"/learn_from_ai/pytorch-backpropagation-mechanism"}]},{"tag":"自动微分","slug":"自动微分","path":"/tags/自动微分","postSlugs":[{"postType":"learn_from_ai","postSlug":"pytorch-backpropagation-mechanism","postPagePath":"/learn_from_ai/pytorch-backpropagation-mechanism"}]},{"tag":"学习笔记","slug":"学习笔记","path":"/tags/学习笔记","postSlugs":[{"postType":"learn_from_ai","postSlug":"deep-learning-model-formats","postPagePath":"/learn_from_ai/deep-learning-model-formats"},{"postType":"learn_from_ai","postSlug":"opencv-coordinate-system-conventions","postPagePath":"/learn_from_ai/opencv-coordinate-system-conventions"},{"postType":"learn_from_ai","postSlug":"executable-file-formats","postPagePath":"/learn_from_ai/executable-file-formats"},{"postType":"learn_from_ai","postSlug":"lora-matrix-initialization-strategy","postPagePath":"/learn_from_ai/lora-matrix-initialization-strategy"},{"postType":"learn_from_ai","postSlug":"pytorch-backpropagation-mechanism","postPagePath":"/learn_from_ai/pytorch-backpropagation-mechanism"}]}],"source":{"compiledSource":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    annotation: \"annotation\",\n    blockquote: \"blockquote\",\n    code: \"code\",\n    figure: \"figure\",\n    h2: \"h2\",\n    h3: \"h3\",\n    h4: \"h4\",\n    h5: \"h5\",\n    hr: \"hr\",\n    li: \"li\",\n    math: \"math\",\n    mfrac: \"mfrac\",\n    mi: \"mi\",\n    mn: \"mn\",\n    mo: \"mo\",\n    mover: \"mover\",\n    mpadded: \"mpadded\",\n    mrow: \"mrow\",\n    mspace: \"mspace\",\n    msub: \"msub\",\n    msup: \"msup\",\n    mtext: \"mtext\",\n    munder: \"munder\",\n    ol: \"ol\",\n    p: \"p\",\n    path: \"path\",\n    pre: \"pre\",\n    semantics: \"semantics\",\n    span: \"span\",\n    strong: \"strong\",\n    svg: \"svg\",\n    table: \"table\",\n    tbody: \"tbody\",\n    td: \"td\",\n    th: \"th\",\n    thead: \"thead\",\n    tr: \"tr\",\n    ul: \"ul\",\n    ..._provideComponents(),\n    ...props.components\n  }, {CodeBlockMermaid} = _components;\n  if (!CodeBlockMermaid) _missingMdxReference(\"CodeBlockMermaid\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"本文为用户与 DeepSeek 的问答。主题为 PyTorch 的反向传播机制。本文从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"q-深入解析-pytorch-中的反向传播机制\",\n      children: _jsx(_components.a, {\n        href: \"#q-深入解析-pytorch-中的反向传播机制\",\n        children: \"Q; 深入解析 PyTorch 中的反向传播机制\"\n      })\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"query\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"深入解释 torch 中反向传播机制的数学原理与为何需要反向传播机制。提示：你可以使用公式、Mermaid 图表、表格等方式使内容更容易理解。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"think\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"嗯，用户让我深入解释PyTorch中的反向传播机制的数学原理以及为什么需要它。好的，我得先回忆一下反向传播的基础知识，然后结合PyTorch的具体实现来展开。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"首先，反向传播是神经网络训练的核心，用于计算梯度。用户可能已经了解梯度下降，但需要更底层的数学解释。我应该从计算图开始，因为PyTorch使用动态图机制。每个张量的运算都会记录在计算图中，这样在反向传播时可以自动计算梯度。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"数学原理方面，得先讲链式法则。比如，假设有一个简单的函数，y = w*x + b，然后损失函数是L = (y - t)^2。那么求L对w的梯度就需要链式法则：dL/dw = dL/dy * dy/dw。反向传播的过程就是从输出层开始，逐层应用链式法则，将梯度传播回各层的参数。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"然后需要解释为什么需要反向传播。手动计算梯度在复杂网络中不现实，反向传播自动高效地计算所有参数的梯度，节省了时间和减少错误。可能还需要比较前向传播和反向传播的计算量，比如反向传播如何复用前向的中间结果，提高效率。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"PyTorch中的autograd机制是关键。每个Tensor的.grad_fn属性记录了创建它的操作，这样在调用.backward()时，会沿着这些函数形成的计算图反向遍历，应用链式法则。需要举例说明，比如构建一个简单的计算图，然后展示梯度计算的过程。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"可能用户对计算图的具体实现细节感兴趣，比如PyTorch的动态图特性，每次前向传播都会构建新的图，这样更灵活。但数学原理还是链式法则，不管图的结构如何变化，梯度计算的方法是一致的。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"另外，可能需要提到为什么不能只用数值方法来近似梯度，比如计算资源的问题，尤其是高维参数时，数值梯度计算量太大。而反向传播通过解析法高效计算，适合深度学习的大规模参数。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"还要注意解释叶子节点和中间节点的梯度存储情况，PyTorch默认只保留叶子节点的梯度，中间节点的梯度会被释放以节省内存。这可能在训练大模型时很重要，用户可能需要了解如何控制梯度的保留。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"或许用户对反向传播的数学推导有更深的需求，比如如何扩展到多层网络，或者如何处理复杂的层结构如卷积层、循环层。但根据问题，可能只需要基础数学，比如链式法则的多次应用，以及如何累积各层的梯度。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"最后，总结反向传播的必要性：自动化、高效、准确计算梯度，使得训练深层网络可行。而PyTorch的自动微分机制让用户无需手动实现这些复杂的计算，只需关注模型结构。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"可能需要用公式来展示链式法则的应用，比如多层的梯度相乘。例如，一个三层的网络，每一层的权重梯度如何计算。同时，用Mermaid图展示计算图的结构，说明前向和反向的路径。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"还有可能要考虑激活函数的导数，比如ReLU在反向传播中的处理，这样在计算图中如何处理不可导点，但PyTorch的autograd会自动处理这些。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"总之，我需要从数学原理（链式法则）、计算图的概念、PyTorch的实现机制（动态图、autograd）、以及反向传播的必要性（高效、自动）这几个方面来组织内容，并用公式和图表辅助说明。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"最后，我需要用一个具体的例子，比如一个简单的神经网络，来展示反向传播的整个过程，包括前向传播、反向传播、梯度计算和参数更新。这样用户可以直观地理解反向传播的每个步骤。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"如果用户对PyTorch的代码实现感兴趣，我也可以提供一些关键代码段的解析，比如如何定义计算图、如何跟踪梯度、如何执行反向传播等。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"总之，我需要确保解释清晰，结合数学原理和代码示例，帮助用户理解PyTorch中的反向传播机制。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"深入解析-pytorch-中的反向传播机制\",\n      children: _jsx(_components.a, {\n        href: \"#深入解析-pytorch-中的反向传播机制\",\n        children: \"深入解析 PyTorch 中的反向传播机制\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"反向传播（Backpropagation）是神经网络训练的核心算法。本文将从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h4, {\n      id: \"一反向传播的数学原理\",\n      children: _jsx(_components.a, {\n        href: \"#一反向传播的数学原理\",\n        children: \"一、反向传播的数学原理\"\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"1-链式法则chain-rule\",\n      children: _jsx(_components.a, {\n        href: \"#1-链式法则chain-rule\",\n        children: \"1. 链式法则（Chain Rule）\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"反向传播本质上是链式法则的高效实现。假设神经网络的计算流程为：\"\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsx(_components.mi, {\n                  children: \"L\"\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mi, {\n                  children: \"f\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \"(\"\n                }), _jsx(_components.mi, {\n                  children: \"g\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \"(\"\n                }), _jsx(_components.mi, {\n                  children: \"h\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \"(\"\n                }), _jsx(_components.mi, {\n                  children: \"x\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \")\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \")\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \")\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"L = f(g(h(x)))\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"L\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"1em\",\n                verticalAlign: \"-0.25em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.10764em\"\n              },\n              children: \"f\"\n            }), _jsx(_components.span, {\n              className: \"mopen\",\n              children: \"(\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.03588em\"\n              },\n              children: \"g\"\n            }), _jsx(_components.span, {\n              className: \"mopen\",\n              children: \"(\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"h\"\n            }), _jsx(_components.span, {\n              className: \"mopen\",\n              children: \"(\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"x\"\n            }), _jsx(_components.span, {\n              className: \"mclose\",\n              children: \")))\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"其中：\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"h\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"W\"\n                    }), _jsx(_components.mn, {\n                      children: \"1\"\n                    })]\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"b\"\n                    }), _jsx(_components.mn, {\n                      children: \"1\"\n                    })]\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"h(x) = W_1x + b_1\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"h\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8333em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.13889em\"\n                  },\n                  children: \"W\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.1389em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"1\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8444em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"b\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"1\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })]\n          })]\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"g\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"z\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mtext, {\n                    children: \"ReLU\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"z\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"g(z) = \\\\text{ReLU}(z)\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"g\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.04398em\"\n                },\n                children: \"z\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"ReLU\"\n                })\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.04398em\"\n                },\n                children: \"z\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })]\n          })]\n        })\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"f\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"y\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsx(_components.mn, {\n                      children: \"1\"\n                    }), _jsx(_components.mn, {\n                      children: \"2\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"y\"\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsx(_components.mi, {\n                    children: \"t\"\n                  }), _jsxs(_components.msup, {\n                    children: [_jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mn, {\n                      children: \"2\"\n                    })]\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"f(y) = \\\\frac{1}{2}(y - t)^2\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.10764em\"\n                },\n                children: \"f\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"y\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.1901em\",\n                  verticalAlign: \"-0.345em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8451em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.655em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"2\"\n                              })\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.394em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"1\"\n                              })\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.345em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"y\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.0641em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"t\"\n              }), _jsxs(_components.span, {\n                className: \"mclose\",\n                children: [_jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8141em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.063em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"2\"\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              })]\n            })]\n          })]\n        }), \" （均方误差损失）\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"则梯度计算为：\"\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"W\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      })]\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"g\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"g\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"h\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"h\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"W\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      })]\n                    })]\n                  })]\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial W_1} = \\\\frac{\\\\partial L}{\\\\partial f} \\\\cdot \\\\frac{\\\\partial f}{\\\\partial g} \\\\cdot \\\\frac{\\\\partial g}{\\\\partial h} \\\\cdot \\\\frac{\\\\partial h}{\\\\partial W_1}\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.2074em\",\n                verticalAlign: \"-0.836em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord mathnormal\",\n                              style: {\n                                marginRight: \"0.13889em\"\n                              },\n                              children: \"W\"\n                            }), _jsx(_components.span, {\n                              className: \"msupsub\",\n                              children: _jsxs(_components.span, {\n                                className: \"vlist-t vlist-t2\",\n                                children: [_jsxs(_components.span, {\n                                  className: \"vlist-r\",\n                                  children: [_jsx(_components.span, {\n                                    className: \"vlist\",\n                                    style: {\n                                      height: \"0.3011em\"\n                                    },\n                                    children: _jsxs(_components.span, {\n                                      style: {\n                                        top: \"-2.55em\",\n                                        marginLeft: \"-0.1389em\",\n                                        marginRight: \"0.05em\"\n                                      },\n                                      children: [_jsx(_components.span, {\n                                        className: \"pstrut\",\n                                        style: {\n                                          height: \"2.7em\"\n                                        }\n                                      }), _jsx(_components.span, {\n                                        className: \"sizing reset-size6 size3 mtight\",\n                                        children: _jsx(_components.span, {\n                                          className: \"mord mtight\",\n                                          children: \"1\"\n                                        })\n                                      })]\n                                    })\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-s\",\n                                    children: \"​\"\n                                  })]\n                                }), _jsx(_components.span, {\n                                  className: \"vlist-r\",\n                                  children: _jsx(_components.span, {\n                                    className: \"vlist\",\n                                    style: {\n                                      height: \"0.15em\"\n                                    },\n                                    children: _jsx(_components.span, {})\n                                  })\n                                })]\n                              })\n                            })]\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.836em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.2519em\",\n                verticalAlign: \"-0.8804em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.10764em\"\n                            },\n                            children: \"f\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.8804em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.2519em\",\n                verticalAlign: \"-0.8804em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.03588em\"\n                            },\n                            children: \"g\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.10764em\"\n                            },\n                            children: \"f\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.8804em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"h\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.03588em\"\n                            },\n                            children: \"g\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.2074em\",\n                verticalAlign: \"-0.836em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord mathnormal\",\n                              style: {\n                                marginRight: \"0.13889em\"\n                              },\n                              children: \"W\"\n                            }), _jsx(_components.span, {\n                              className: \"msupsub\",\n                              children: _jsxs(_components.span, {\n                                className: \"vlist-t vlist-t2\",\n                                children: [_jsxs(_components.span, {\n                                  className: \"vlist-r\",\n                                  children: [_jsx(_components.span, {\n                                    className: \"vlist\",\n                                    style: {\n                                      height: \"0.3011em\"\n                                    },\n                                    children: _jsxs(_components.span, {\n                                      style: {\n                                        top: \"-2.55em\",\n                                        marginLeft: \"-0.1389em\",\n                                        marginRight: \"0.05em\"\n                                      },\n                                      children: [_jsx(_components.span, {\n                                        className: \"pstrut\",\n                                        style: {\n                                          height: \"2.7em\"\n                                        }\n                                      }), _jsx(_components.span, {\n                                        className: \"sizing reset-size6 size3 mtight\",\n                                        children: _jsx(_components.span, {\n                                          className: \"mord mtight\",\n                                          children: \"1\"\n                                        })\n                                      })]\n                                    })\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-s\",\n                                    children: \"​\"\n                                  })]\n                                }), _jsx(_components.span, {\n                                  className: \"vlist-r\",\n                                  children: _jsx(_components.span, {\n                                    className: \"vlist\",\n                                    style: {\n                                      height: \"0.15em\"\n                                    },\n                                    children: _jsx(_components.span, {})\n                                  })\n                                })]\n                              })\n                            })]\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"h\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.836em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"2-梯度累积公式\",\n      children: _jsx(_components.a, {\n        href: \"#2-梯度累积公式\",\n        children: \"2. 梯度累积公式\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"对于任意参数 \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"θ\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\theta\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"θ\"\n            })]\n          })\n        })]\n      }), \"，梯度计算可表示为：\"]\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"script\",\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.munder, {\n                  children: [_jsx(_components.mo, {\n                    children: \"∑\"\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mtext, {\n                      children: \"path \"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mo, {\n                      children: \"→\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"script\",\n                      children: \"L\"\n                    })]\n                  })]\n                }), _jsxs(_components.mrow, {\n                  children: [_jsx(_components.mo, {\n                    fence: \"true\",\n                    children: \"(\"\n                  }), _jsxs(_components.munder, {\n                    children: [_jsx(_components.mo, {\n                      children: \"∏\"\n                    }), _jsx(_components.mi, {\n                      children: \"i\"\n                    })]\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mtext, {\n                          children: \"op\"\n                        }), _jsx(_components.mi, {\n                          children: \"i\"\n                        })]\n                      })]\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mtext, {\n                          children: \"input\"\n                        }), _jsx(_components.mi, {\n                          children: \"i\"\n                        })]\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    fence: \"true\",\n                    children: \")\"\n                  })]\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial \\\\mathcal{L}}{\\\\partial \\\\theta} = \\\\sum_{\\\\text{path } \\\\theta \\\\to \\\\mathcal{L}} \\\\left( \\\\prod_{i} \\\\frac{\\\\partial \\\\text{op}_i}{\\\\partial \\\\text{input}_i} \\\\right)\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathcal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"3.1882em\",\n                verticalAlign: \"-1.4382em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mop op-limits\",\n              children: _jsxs(_components.span, {\n                className: \"vlist-t vlist-t2\",\n                children: [_jsxs(_components.span, {\n                  className: \"vlist-r\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist\",\n                    style: {\n                      height: \"1.05em\"\n                    },\n                    children: [_jsxs(_components.span, {\n                      style: {\n                        top: \"-1.8479em\",\n                        marginLeft: \"0em\"\n                      },\n                      children: [_jsx(_components.span, {\n                        className: \"pstrut\",\n                        style: {\n                          height: \"3.05em\"\n                        }\n                      }), _jsx(_components.span, {\n                        className: \"sizing reset-size6 size3 mtight\",\n                        children: _jsxs(_components.span, {\n                          className: \"mord mtight\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord text mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"path \"\n                            })\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal mtight\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          }), _jsx(_components.span, {\n                            className: \"mrel mtight\",\n                            children: \"→\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathcal mtight\",\n                            children: \"L\"\n                          })]\n                        })\n                      })]\n                    }), _jsxs(_components.span, {\n                      style: {\n                        top: \"-3.05em\"\n                      },\n                      children: [_jsx(_components.span, {\n                        className: \"pstrut\",\n                        style: {\n                          height: \"3.05em\"\n                        }\n                      }), _jsx(_components.span, {\n                        children: _jsx(_components.span, {\n                          className: \"mop op-symbol large-op\",\n                          children: \"∑\"\n                        })\n                      })]\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-s\",\n                    children: \"​\"\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"vlist-r\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist\",\n                    style: {\n                      height: \"1.4382em\"\n                    },\n                    children: _jsx(_components.span, {})\n                  })\n                })]\n              })\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.1667em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"minner\",\n              children: [_jsx(_components.span, {\n                className: \"mopen delimcenter\",\n                style: {\n                  top: \"0em\"\n                },\n                children: _jsx(_components.span, {\n                  className: \"delimsizing size4\",\n                  children: \"(\"\n                })\n              }), _jsx(_components.span, {\n                className: \"mop op-limits\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.05em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-1.8723em\",\n                          marginLeft: \"0em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3.05em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              children: \"i\"\n                            })\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3.05em\"\n                          }\n                        }), _jsx(_components.span, {\n                          children: _jsx(_components.span, {\n                            className: \"mop op-symbol large-op\",\n                            children: \"∏\"\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.2777em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.3714em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.314em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              style: {\n                                marginRight: \"0.05556em\"\n                              },\n                              children: \"∂\"\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord text\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord\",\n                                  children: \"input\"\n                                })\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsxs(_components.span, {\n                                  className: \"vlist-t vlist-t2\",\n                                  children: [_jsxs(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: [_jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.2175em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.4559em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsx(_components.span, {\n                                            className: \"mord mathnormal mtight\",\n                                            children: \"i\"\n                                          })\n                                        })]\n                                      })\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-s\",\n                                      children: \"​\"\n                                    })]\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.2441em\"\n                                      },\n                                      children: _jsx(_components.span, {})\n                                    })\n                                  })]\n                                })\n                              })]\n                            })]\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.677em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              style: {\n                                marginRight: \"0.05556em\"\n                              },\n                              children: \"∂\"\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord text\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord\",\n                                  children: \"op\"\n                                })\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsxs(_components.span, {\n                                  className: \"vlist-t vlist-t2\",\n                                  children: [_jsxs(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: [_jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.2175em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.4559em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsx(_components.span, {\n                                            className: \"mord mathnormal mtight\",\n                                            children: \"i\"\n                                          })\n                                        })]\n                                      })\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-s\",\n                                      children: \"​\"\n                                    })]\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.2441em\"\n                                      },\n                                      children: _jsx(_components.span, {})\n                                    })\n                                  })]\n                                })\n                              })]\n                            })]\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.9301em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mclose delimcenter\",\n                style: {\n                  top: \"0em\"\n                },\n                children: _jsx(_components.span, {\n                  className: \"delimsizing size4\",\n                  children: \")\"\n                })\n              })]\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h4, {\n      id: \"二pytorch-的实现机制\",\n      children: _jsx(_components.a, {\n        href: \"#二pytorch-的实现机制\",\n        children: \"二、PyTorch 的实现机制\"\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"1-动态计算图dynamic-computation-graph\",\n      children: _jsx(_components.a, {\n        href: \"#1-动态计算图dynamic-computation-graph\",\n        children: \"1. 动态计算图（Dynamic Computation Graph）\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PyTorch 在前向传播时自动构建计算图，节点为张量，边为运算操作：\"\n    }), \"\\n\", _jsx(CodeBlockMermaid, {\n      lang: \"mermaid\",\n      value: \"graph LR\\n  x((x)) --\u003e MatMul --\u003e h((h))\\n  W1((W1)) --\u003e MatMul\\n  b1((b1)) --\u003e Add --\u003e z((z))\\n  h --\u003e Add\\n  z --\u003e ReLU --\u003e y((y))\\n  y --\u003e MSE --\u003e Loss((Loss))\"\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"2-autograd-核心组件\",\n      children: _jsx(_components.a, {\n        href: \"#2-autograd-核心组件\",\n        children: \"2. Autograd 核心组件\"\n      })\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"组件\"\n          }), _jsx(_components.th, {\n            children: \"作用\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"Tensor.requires_grad\"\n            })\n          }), _jsx(_components.td, {\n            children: \"标记需要跟踪梯度的张量\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"Tensor.grad_fn\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"记录创建该张量的操作（如 \", _jsx(_components.code, {\n              children: \"MulBackward\"\n            }), \"）\"]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"Tensor.grad\"\n            })\n          }), _jsx(_components.td, {\n            children: \"存储计算得到的梯度\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"3-反向传播过程\",\n      children: _jsx(_components.a, {\n        href: \"#3-反向传播过程\",\n        children: \"3. 反向传播过程\"\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"import\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"2.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"],\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"W \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"3.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"],\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" W \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" x\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"W\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 输出: tensor([2.])\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 输出: tensor([3.])\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h4, {\n      id: \"三为何需要反向传播\",\n      children: _jsx(_components.a, {\n        href: \"#三为何需要反向传播\",\n        children: \"三、为何需要反向传播？\"\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"1-手动计算不可行性\",\n      children: _jsx(_components.a, {\n        href: \"#1-手动计算不可行性\",\n        children: \"1. 手动计算不可行性\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"对于包含百万参数的现代神经网络，手动计算梯度的时间复杂度为 \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsx(_components.mi, {\n                  children: \"O\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \"(\"\n                }), _jsxs(_components.msup, {\n                  children: [_jsx(_components.mi, {\n                    children: \"n\"\n                  }), _jsx(_components.mn, {\n                    children: \"2\"\n                  })]\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \")\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"O(n^2)\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"1.0641em\",\n                verticalAlign: \"-0.25em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"O\"\n            }), _jsx(_components.span, {\n              className: \"mopen\",\n              children: \"(\"\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"n\"\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsx(_components.span, {\n                  className: \"vlist-t\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.8141em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.063em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: \"2\"\n                          })\n                        })]\n                      })\n                    })\n                  })\n                })\n              })]\n            }), _jsx(_components.span, {\n              className: \"mclose\",\n              children: \")\"\n            })]\n          })\n        })]\n      }), \" ，而反向传播只需 \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsx(_components.mi, {\n                  children: \"O\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \"(\"\n                }), _jsx(_components.mi, {\n                  children: \"n\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \")\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"O(n)\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"1em\",\n                verticalAlign: \"-0.25em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"O\"\n            }), _jsx(_components.span, {\n              className: \"mopen\",\n              children: \"(\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"n\"\n            }), _jsx(_components.span, {\n              className: \"mclose\",\n              children: \")\"\n            })]\n          })\n        })]\n      }), \" 。\"]\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"2-计算效率对比\",\n      children: _jsx(_components.a, {\n        href: \"#2-计算效率对比\",\n        children: \"2. 计算效率对比\"\n      })\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"方法\"\n          }), _jsx(_components.th, {\n            children: \"时间复杂度\"\n          }), _jsx(_components.th, {\n            children: \"空间复杂度\"\n          }), _jsx(_components.th, {\n            children: \"数值稳定性\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"数值微分\"\n          }), _jsx(_components.td, {\n            children: _jsxs(_components.span, {\n              className: \"katex\",\n              children: [_jsx(_components.span, {\n                className: \"katex-mathml\",\n                children: _jsx(_components.math, {\n                  xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                  children: _jsxs(_components.semantics, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"O\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \"(\"\n                      }), _jsxs(_components.msup, {\n                        children: [_jsx(_components.mi, {\n                          children: \"n\"\n                        }), _jsx(_components.mn, {\n                          children: \"2\"\n                        })]\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \")\"\n                      })]\n                    }), _jsx(_components.annotation, {\n                      encoding: \"application/x-tex\",\n                      children: \"O(n^2)\"\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"katex-html\",\n                \"aria-hidden\": \"true\",\n                children: _jsxs(_components.span, {\n                  className: \"base\",\n                  children: [_jsx(_components.span, {\n                    className: \"strut\",\n                    style: {\n                      height: \"1.0641em\",\n                      verticalAlign: \"-0.25em\"\n                    }\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.02778em\"\n                    },\n                    children: \"O\"\n                  }), _jsx(_components.span, {\n                    className: \"mopen\",\n                    children: \"(\"\n                  }), _jsxs(_components.span, {\n                    className: \"mord\",\n                    children: [_jsx(_components.span, {\n                      className: \"mord mathnormal\",\n                      children: \"n\"\n                    }), _jsx(_components.span, {\n                      className: \"msupsub\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-t\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist-r\",\n                          children: _jsx(_components.span, {\n                            className: \"vlist\",\n                            style: {\n                              height: \"0.8141em\"\n                            },\n                            children: _jsxs(_components.span, {\n                              style: {\n                                top: \"-3.063em\",\n                                marginRight: \"0.05em\"\n                              },\n                              children: [_jsx(_components.span, {\n                                className: \"pstrut\",\n                                style: {\n                                  height: \"2.7em\"\n                                }\n                              }), _jsx(_components.span, {\n                                className: \"sizing reset-size6 size3 mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: \"2\"\n                                })\n                              })]\n                            })\n                          })\n                        })\n                      })\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"mclose\",\n                    children: \")\"\n                  })]\n                })\n              })]\n            })\n          }), _jsx(_components.td, {\n            children: _jsxs(_components.span, {\n              className: \"katex\",\n              children: [_jsx(_components.span, {\n                className: \"katex-mathml\",\n                children: _jsx(_components.math, {\n                  xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                  children: _jsxs(_components.semantics, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"O\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \"(\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \")\"\n                      })]\n                    }), _jsx(_components.annotation, {\n                      encoding: \"application/x-tex\",\n                      children: \"O(1)\"\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"katex-html\",\n                \"aria-hidden\": \"true\",\n                children: _jsxs(_components.span, {\n                  className: \"base\",\n                  children: [_jsx(_components.span, {\n                    className: \"strut\",\n                    style: {\n                      height: \"1em\",\n                      verticalAlign: \"-0.25em\"\n                    }\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.02778em\"\n                    },\n                    children: \"O\"\n                  }), _jsx(_components.span, {\n                    className: \"mopen\",\n                    children: \"(\"\n                  }), _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"1\"\n                  }), _jsx(_components.span, {\n                    className: \"mclose\",\n                    children: \")\"\n                  })]\n                })\n              })]\n            })\n          }), _jsx(_components.td, {\n            children: \"差\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"符号微分\"\n          }), _jsx(_components.td, {\n            children: _jsxs(_components.span, {\n              className: \"katex\",\n              children: [_jsx(_components.span, {\n                className: \"katex-mathml\",\n                children: _jsx(_components.math, {\n                  xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                  children: _jsxs(_components.semantics, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"O\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \"(\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \")\"\n                      })]\n                    }), _jsx(_components.annotation, {\n                      encoding: \"application/x-tex\",\n                      children: \"O(1)\"\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"katex-html\",\n                \"aria-hidden\": \"true\",\n                children: _jsxs(_components.span, {\n                  className: \"base\",\n                  children: [_jsx(_components.span, {\n                    className: \"strut\",\n                    style: {\n                      height: \"1em\",\n                      verticalAlign: \"-0.25em\"\n                    }\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.02778em\"\n                    },\n                    children: \"O\"\n                  }), _jsx(_components.span, {\n                    className: \"mopen\",\n                    children: \"(\"\n                  }), _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"1\"\n                  }), _jsx(_components.span, {\n                    className: \"mclose\",\n                    children: \")\"\n                  })]\n                })\n              })]\n            })\n          }), _jsx(_components.td, {\n            children: _jsxs(_components.span, {\n              className: \"katex\",\n              children: [_jsx(_components.span, {\n                className: \"katex-mathml\",\n                children: _jsx(_components.math, {\n                  xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                  children: _jsxs(_components.semantics, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"O\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \"(\"\n                      }), _jsx(_components.mi, {\n                        children: \"n\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \")\"\n                      })]\n                    }), _jsx(_components.annotation, {\n                      encoding: \"application/x-tex\",\n                      children: \"O(n)\"\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"katex-html\",\n                \"aria-hidden\": \"true\",\n                children: _jsxs(_components.span, {\n                  className: \"base\",\n                  children: [_jsx(_components.span, {\n                    className: \"strut\",\n                    style: {\n                      height: \"1em\",\n                      verticalAlign: \"-0.25em\"\n                    }\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.02778em\"\n                    },\n                    children: \"O\"\n                  }), _jsx(_components.span, {\n                    className: \"mopen\",\n                    children: \"(\"\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"n\"\n                  }), _jsx(_components.span, {\n                    className: \"mclose\",\n                    children: \")\"\n                  })]\n                })\n              })]\n            })\n          }), _jsx(_components.td, {\n            children: \"好\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"自动微分（反向传播）\"\n          }), _jsx(_components.td, {\n            children: _jsxs(_components.span, {\n              className: \"katex\",\n              children: [_jsx(_components.span, {\n                className: \"katex-mathml\",\n                children: _jsx(_components.math, {\n                  xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                  children: _jsxs(_components.semantics, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"O\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \"(\"\n                      }), _jsx(_components.mi, {\n                        children: \"n\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \")\"\n                      })]\n                    }), _jsx(_components.annotation, {\n                      encoding: \"application/x-tex\",\n                      children: \"O(n)\"\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"katex-html\",\n                \"aria-hidden\": \"true\",\n                children: _jsxs(_components.span, {\n                  className: \"base\",\n                  children: [_jsx(_components.span, {\n                    className: \"strut\",\n                    style: {\n                      height: \"1em\",\n                      verticalAlign: \"-0.25em\"\n                    }\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.02778em\"\n                    },\n                    children: \"O\"\n                  }), _jsx(_components.span, {\n                    className: \"mopen\",\n                    children: \"(\"\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"n\"\n                  }), _jsx(_components.span, {\n                    className: \"mclose\",\n                    children: \")\"\n                  })]\n                })\n              })]\n            })\n          }), _jsx(_components.td, {\n            children: _jsxs(_components.span, {\n              className: \"katex\",\n              children: [_jsx(_components.span, {\n                className: \"katex-mathml\",\n                children: _jsx(_components.math, {\n                  xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                  children: _jsxs(_components.semantics, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"O\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \"(\"\n                      }), _jsx(_components.mi, {\n                        children: \"n\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \")\"\n                      })]\n                    }), _jsx(_components.annotation, {\n                      encoding: \"application/x-tex\",\n                      children: \"O(n)\"\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"katex-html\",\n                \"aria-hidden\": \"true\",\n                children: _jsxs(_components.span, {\n                  className: \"base\",\n                  children: [_jsx(_components.span, {\n                    className: \"strut\",\n                    style: {\n                      height: \"1em\",\n                      verticalAlign: \"-0.25em\"\n                    }\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.02778em\"\n                    },\n                    children: \"O\"\n                  }), _jsx(_components.span, {\n                    className: \"mopen\",\n                    children: \"(\"\n                  }), _jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"n\"\n                  }), _jsx(_components.span, {\n                    className: \"mclose\",\n                    children: \")\"\n                  })]\n                })\n              })]\n            })\n          }), _jsx(_components.td, {\n            children: \"优秀\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"3-内存优化策略\",\n      children: _jsx(_components.a, {\n        href: \"#3-内存优化策略\",\n        children: \"3. 内存优化策略\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PyTorch 采用以下技术降低内存占用：\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"梯度检查点\"\n        }), \"：只保留关键节点的中间结果\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"即时释放中间梯度\"\n        }), \"：默认只保留叶子节点的梯度\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h4, {\n      id: \"四反向传播的数学扩展\",\n      children: _jsx(_components.a, {\n        href: \"#四反向传播的数学扩展\",\n        children: \"四、反向传播的数学扩展\"\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"1-矩阵求导示例\",\n      children: _jsx(_components.a, {\n        href: \"#1-矩阵求导示例\",\n        children: \"1. 矩阵求导示例\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"对于全连接层 \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsx(_components.mi, {\n                  children: \"Y\"\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mi, {\n                  children: \"X\"\n                }), _jsx(_components.mi, {\n                  children: \"W\"\n                }), _jsx(_components.mo, {\n                  children: \"+\"\n                }), _jsx(_components.mi, {\n                  children: \"b\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"Y = XW + b\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.22222em\"\n              },\n              children: \"Y\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.7667em\",\n                verticalAlign: \"-0.0833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.07847em\"\n              },\n              children: \"X\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.13889em\"\n              },\n              children: \"W\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"+\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"b\"\n            })]\n          })]\n        })]\n      }), \" ，梯度计算为：\"]\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"script\",\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"W\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.msup, {\n                  children: [_jsx(_components.mi, {\n                    children: \"X\"\n                  }), _jsx(_components.mi, {\n                    children: \"T\"\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"script\",\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"Y\"\n                    })]\n                  })]\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial \\\\mathcal{L}}{\\\\partial W} = X^T \\\\cdot \\\\frac{\\\\partial \\\\mathcal{L}}{\\\\partial Y}\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.13889em\"\n                            },\n                            children: \"W\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathcal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.8913em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.07847em\"\n                },\n                children: \"X\"\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsx(_components.span, {\n                  className: \"vlist-t\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.8913em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.113em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mathnormal mtight\",\n                            style: {\n                              marginRight: \"0.13889em\"\n                            },\n                            children: \"T\"\n                          })\n                        })]\n                      })\n                    })\n                  })\n                })\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.22222em\"\n                            },\n                            children: \"Y\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathcal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"2-复杂运算处理\",\n      children: _jsx(_components.a, {\n        href: \"#2-复杂运算处理\",\n        children: \"2. 复杂运算处理\"\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" PyTorch 自动处理不可导点\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"-\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"1.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 0.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 2.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"],\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"relu\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"1.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 1.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 1.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"]))\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 输出: tensor([0., 0., 1.])\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h4, {\n      id: \"五总结\",\n      children: _jsx(_components.a, {\n        href: \"#五总结\",\n        children: \"五、总结\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"反向传播的必要性\"\n      }), \"：\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"自动微分\"\n        }), \"：避免手工推导复杂导数\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"计算高效\"\n        }), \"：利用链式法则的分解特性\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"内存优化\"\n        }), \"：动态图的即时构建与销毁\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"框架支撑\"\n        }), \"：支持任意复杂网络结构\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PyTorch 通过动态计算图和 Autograd 系统，将反向传播的数学原理高效实现，使得深度学习模型的训练变得可行且高效。理解这一机制对于调试模型、优化内存使用和实现自定义算子至关重要。\"\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"q-参数的梯度累加计算公式\",\n      children: _jsx(_components.a, {\n        href: \"#q-参数的梯度累加计算公式\",\n        children: \"Q: 参数的梯度累加计算公式\"\n      })\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"query\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"你提到对于任意参数 \", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        }), \"，梯度计算可表示为：\"]\n      }), \"\\n\", _jsx(_components.span, {\n        className: \"katex-display\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              display: \"block\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        mathvariant: \"script\",\n                        children: \"L\"\n                      })]\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"θ\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.munder, {\n                    children: [_jsx(_components.mo, {\n                      children: \"∑\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mtext, {\n                        children: \"path \"\n                      }), _jsx(_components.mi, {\n                        children: \"θ\"\n                      }), _jsx(_components.mo, {\n                        children: \"→\"\n                      }), _jsx(_components.mi, {\n                        mathvariant: \"script\",\n                        children: \"L\"\n                      })]\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mo, {\n                      fence: \"true\",\n                      children: \"(\"\n                    }), _jsxs(_components.munder, {\n                      children: [_jsx(_components.mo, {\n                        children: \"∏\"\n                      }), _jsx(_components.mi, {\n                        children: \"i\"\n                      })]\n                    }), _jsxs(_components.mfrac, {\n                      children: [_jsxs(_components.mrow, {\n                        children: [_jsx(_components.mi, {\n                          mathvariant: \"normal\",\n                          children: \"∂\"\n                        }), _jsxs(_components.msub, {\n                          children: [_jsx(_components.mtext, {\n                            children: \"op\"\n                          }), _jsx(_components.mi, {\n                            children: \"i\"\n                          })]\n                        })]\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mi, {\n                          mathvariant: \"normal\",\n                          children: \"∂\"\n                        }), _jsxs(_components.msub, {\n                          children: [_jsx(_components.mtext, {\n                            children: \"input\"\n                          }), _jsx(_components.mi, {\n                            children: \"i\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      fence: \"true\",\n                      children: \")\"\n                    })]\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\frac{\\\\partial \\\\mathcal{L}}{\\\\partial \\\\theta} = \\\\sum_{\\\\text{path } \\\\theta \\\\to \\\\mathcal{L}} \\\\left( \\\\prod_{i} \\\\frac{\\\\partial \\\\text{op}_i}{\\\\partial \\\\text{input}_i} \\\\right)\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"2.0574em\",\n                  verticalAlign: \"-0.686em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.3714em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.314em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              style: {\n                                marginRight: \"0.05556em\"\n                              },\n                              children: \"∂\"\n                            }), _jsx(_components.span, {\n                              className: \"mord mathnormal\",\n                              style: {\n                                marginRight: \"0.02778em\"\n                              },\n                              children: \"θ\"\n                            })]\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.677em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              style: {\n                                marginRight: \"0.05556em\"\n                              },\n                              children: \"∂\"\n                            }), _jsx(_components.span, {\n                              className: \"mord mathcal\",\n                              children: \"L\"\n                            })]\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.686em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"3.1882em\",\n                  verticalAlign: \"-1.4382em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mop op-limits\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.05em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-1.8479em\",\n                          marginLeft: \"0em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3.05em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsxs(_components.span, {\n                            className: \"mord mtight\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord text mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"path \"\n                              })\n                            }), _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              style: {\n                                marginRight: \"0.02778em\"\n                              },\n                              children: \"θ\"\n                            }), _jsx(_components.span, {\n                              className: \"mrel mtight\",\n                              children: \"→\"\n                            }), _jsx(_components.span, {\n                              className: \"mord mathcal mtight\",\n                              children: \"L\"\n                            })]\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3.05em\"\n                          }\n                        }), _jsx(_components.span, {\n                          children: _jsx(_components.span, {\n                            className: \"mop op-symbol large-op\",\n                            children: \"∑\"\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.4382em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"minner\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen delimcenter\",\n                  style: {\n                    top: \"0em\"\n                  },\n                  children: _jsx(_components.span, {\n                    className: \"delimsizing size4\",\n                    children: \"(\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mop op-limits\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.05em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-1.8723em\",\n                            marginLeft: \"0em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3.05em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"i\"\n                              })\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3.05em\"\n                            }\n                          }), _jsx(_components.span, {\n                            children: _jsx(_components.span, {\n                              className: \"mop op-symbol large-op\",\n                              children: \"∏\"\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.2777em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mopen nulldelimiter\"\n                  }), _jsx(_components.span, {\n                    className: \"mfrac\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsxs(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"1.3714em\"\n                          },\n                          children: [_jsxs(_components.span, {\n                            style: {\n                              top: \"-2.314em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"3em\"\n                              }\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsxs(_components.span, {\n                                className: \"mord\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord text\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord\",\n                                    children: \"input\"\n                                  })\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.2175em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.4559em\",\n                                            marginRight: \"0.05em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.7em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size6 size3 mtight\",\n                                            children: _jsx(_components.span, {\n                                              className: \"mord mathnormal mtight\",\n                                              children: \"i\"\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.2441em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              })]\n                            })]\n                          }), _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.23em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"3em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"frac-line\",\n                              style: {\n                                borderBottomWidth: \"0.04em\"\n                              }\n                            })]\n                          }), _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.677em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"3em\"\n                              }\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsxs(_components.span, {\n                                className: \"mord\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord text\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord\",\n                                    children: \"op\"\n                                  })\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.2175em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.4559em\",\n                                            marginRight: \"0.05em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.7em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size6 size3 mtight\",\n                                            children: _jsx(_components.span, {\n                                              className: \"mord mathnormal mtight\",\n                                              children: \"i\"\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.2441em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              })]\n                            })]\n                          })]\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.9301em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  }), _jsx(_components.span, {\n                    className: \"mclose nulldelimiter\"\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose delimcenter\",\n                  style: {\n                    top: \"0em\"\n                  },\n                  children: _jsx(_components.span, {\n                    className: \"delimsizing size4\",\n                    children: \")\"\n                  })\n                })]\n              })]\n            })]\n          })]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"这个公式我没懂，再深入解释一下。我只有本科程度的高等数学知识与线性代数知识，建议一步一步解释推理过程。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"think\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"嗯，用户问的是关于反向传播中梯度计算的公式，那个公式看起来有点复杂，对吧？让我先仔细看看用户的问题。他提到，对于任意参数θ，梯度计算是路径θ到L的和，每个路径中的各个操作的导数相乘。用户本科数学和线性代数基础，可能需要更基础的解释。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"首先，我需要确认用户对这个公式的理解程度。公式里的求和符号和路径可能让他困惑。可能用户对链式法则有一定的了解，但路径的概念不太清楚。比如，在计算图中，参数θ到损失L可能有多个不同的路径，每个路径对应一个梯度贡献，所以梯度是这些路径贡献的总和。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"接下来，我需要用更简单的方式来解释这个公式。或许用一个具体的例子来说明会更好。比如，假设有一个简单的计算图，其中θ分两个路径影响L，每个路径都需要计算导数的乘积，然后将它们相加。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"然后，我应该分步骤解释链式法则，以及为什么需要将不同路径的梯度相加。可能需要用图示来辅助，比如画一个简单的计算图，展示多个分支的情况，每个分支对应一个乘积项，最后相加得到总的梯度。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"另外，用户可能对“路径”这个词不太理解，需要明确在计算图中的路径指的是什么。例如，一个参数可能在多个层中使用，每次使用都会创建一个不同的路径到损失函数，因此每个路径的梯度都需要被计算并累加。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"还要注意，用户可能对乘积的部分有疑问，为什么是各个操作的导数相乘。这时候需要回顾链式法则的基本原理，即复合函数求导时，外层函数的导数和内层函数的导数相乘，而如果有多个中间步骤，就需要连乘这些导数。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"可能还需要解释为什么会有多个路径，例如在神经网络中，一个参数可能在多个神经元中被使用，或者在不同的时间步（如RNN中），导致梯度需要从各个路径反向传播回来，然后累加起来。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"最后，通过一个具体的数学例子，逐步计算每个步骤的导数，并将它们相乘，最后相加，来验证这个公式的正确性。这样用户可以通过实际的计算过程理解抽象的公式。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"总结一下，我需要用具体的例子、图示，分步骤解释链式法则在计算图中的多个路径中的应用，以及梯度累加的原因，帮助用户理解这个公式的含义和推导过程。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"好的！我将用最直观的方式，通过一个具体例子逐步解释这个公式的数学原理。我们结合图示和分步推导来理解链式法则在反向传播中的应用。\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"一问题场景设定\",\n      children: _jsx(_components.a, {\n        href: \"#一问题场景设定\",\n        children: _jsx(_components.strong, {\n          children: \"一、问题场景设定\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"假设我们有一个简单的计算图，其中参数 \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"θ\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\theta\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"θ\"\n            })]\n          })\n        })]\n      }), \" 通过两条路径影响最终损失 \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"L\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"L\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"L\"\n            })]\n          })\n        })]\n      }), \" ：\"]\n    }), \"\\n\", _jsx(CodeBlockMermaid, {\n      lang: \"mermaid\",\n      value: \"graph LR\\n    θ((θ)) --\u003e Op1 --\u003e A\\n    θ --\u003e Op2 --\u003e B\\n    A --\u003e Op3 --\u003e L\\n    B --\u003e Op3 --\u003e L\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"路径1\"\n        }), \"：\", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsxs(_components.mover, {\n                    children: [_jsx(_components.mo, {\n                      stretchy: \"true\",\n                      minsize: \"3.0em\",\n                      children: \"→\"\n                    }), _jsx(_components.mpadded, {\n                      width: \"+0.6em\",\n                      lspace: \"0.3em\",\n                      children: _jsx(_components.mtext, {\n                        children: \"Op1\"\n                      })\n                    })]\n                  }), _jsx(_components.mi, {\n                    children: \"A\"\n                  }), _jsxs(_components.mover, {\n                    children: [_jsx(_components.mo, {\n                      stretchy: \"true\",\n                      minsize: \"3.0em\",\n                      children: \"→\"\n                    }), _jsx(_components.mpadded, {\n                      width: \"+0.6em\",\n                      lspace: \"0.3em\",\n                      children: _jsx(_components.mtext, {\n                        children: \"Op3\"\n                      })\n                    })]\n                  }), _jsx(_components.mi, {\n                    children: \"L\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta \\\\xrightarrow{\\\\text{Op1}} A \\\\xrightarrow{\\\\text{Op3}} L\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.1113em\",\n                  verticalAlign: \"-0.011em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel x-arrow\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.1003em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-3.322em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight x-arrow-pad\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord text mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"Op1\"\n                              })\n                            })\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        className: \"svg-align\",\n                        style: {\n                          top: \"-2.689em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"hide-tail\",\n                          style: {\n                            height: \"0.522em\",\n                            minWidth: \"1.469em\"\n                          },\n                          children: _jsx(_components.svg, {\n                            xmlns: \"http://www.w3.org/2000/svg\",\n                            width: \"400em\",\n                            height: \"0.522em\",\n                            viewBox: \"0 0 400000 522\",\n                            preserveAspectRatio: \"xMaxYMin slice\",\n                            children: _jsx(_components.path, {\n                              d: \"M0 241v40h399891c-47.3 35.3-84 78-110 128\\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n 151.7 139 205zm0 0v40h399900v-40z\"\n                            })\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.011em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.1113em\",\n                  verticalAlign: \"-0.011em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"A\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel x-arrow\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.1003em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-3.322em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight x-arrow-pad\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord text mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"Op3\"\n                              })\n                            })\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        className: \"svg-align\",\n                        style: {\n                          top: \"-2.689em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"hide-tail\",\n                          style: {\n                            height: \"0.522em\",\n                            minWidth: \"1.469em\"\n                          },\n                          children: _jsx(_components.svg, {\n                            xmlns: \"http://www.w3.org/2000/svg\",\n                            width: \"400em\",\n                            height: \"0.522em\",\n                            viewBox: \"0 0 400000 522\",\n                            preserveAspectRatio: \"xMaxYMin slice\",\n                            children: _jsx(_components.path, {\n                              d: \"M0 241v40h399891c-47.3 35.3-84 78-110 128\\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n 151.7 139 205zm0 0v40h399900v-40z\"\n                            })\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.011em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"L\"\n              })]\n            })]\n          })]\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"路径2\"\n        }), \"：\", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsxs(_components.mover, {\n                    children: [_jsx(_components.mo, {\n                      stretchy: \"true\",\n                      minsize: \"3.0em\",\n                      children: \"→\"\n                    }), _jsx(_components.mpadded, {\n                      width: \"+0.6em\",\n                      lspace: \"0.3em\",\n                      children: _jsx(_components.mtext, {\n                        children: \"Op2\"\n                      })\n                    })]\n                  }), _jsx(_components.mi, {\n                    children: \"B\"\n                  }), _jsxs(_components.mover, {\n                    children: [_jsx(_components.mo, {\n                      stretchy: \"true\",\n                      minsize: \"3.0em\",\n                      children: \"→\"\n                    }), _jsx(_components.mpadded, {\n                      width: \"+0.6em\",\n                      lspace: \"0.3em\",\n                      children: _jsx(_components.mtext, {\n                        children: \"Op3\"\n                      })\n                    })]\n                  }), _jsx(_components.mi, {\n                    children: \"L\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta \\\\xrightarrow{\\\\text{Op2}} B \\\\xrightarrow{\\\\text{Op3}} L\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.1113em\",\n                  verticalAlign: \"-0.011em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel x-arrow\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.1003em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-3.322em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight x-arrow-pad\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord text mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"Op2\"\n                              })\n                            })\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        className: \"svg-align\",\n                        style: {\n                          top: \"-2.689em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"hide-tail\",\n                          style: {\n                            height: \"0.522em\",\n                            minWidth: \"1.469em\"\n                          },\n                          children: _jsx(_components.svg, {\n                            xmlns: \"http://www.w3.org/2000/svg\",\n                            width: \"400em\",\n                            height: \"0.522em\",\n                            viewBox: \"0 0 400000 522\",\n                            preserveAspectRatio: \"xMaxYMin slice\",\n                            children: _jsx(_components.path, {\n                              d: \"M0 241v40h399891c-47.3 35.3-84 78-110 128\\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n 151.7 139 205zm0 0v40h399900v-40z\"\n                            })\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.011em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.1113em\",\n                  verticalAlign: \"-0.011em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05017em\"\n                },\n                children: \"B\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel x-arrow\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.1003em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-3.322em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight x-arrow-pad\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord text mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"Op3\"\n                              })\n                            })\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        className: \"svg-align\",\n                        style: {\n                          top: \"-2.689em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"hide-tail\",\n                          style: {\n                            height: \"0.522em\",\n                            minWidth: \"1.469em\"\n                          },\n                          children: _jsx(_components.svg, {\n                            xmlns: \"http://www.w3.org/2000/svg\",\n                            width: \"400em\",\n                            height: \"0.522em\",\n                            viewBox: \"0 0 400000 522\",\n                            preserveAspectRatio: \"xMaxYMin slice\",\n                            children: _jsx(_components.path, {\n                              d: \"M0 241v40h399891c-47.3 35.3-84 78-110 128\\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n 151.7 139 205zm0 0v40h399900v-40z\"\n                            })\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.011em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"L\"\n              })]\n            })]\n          })]\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"目标是计算 \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial \\\\theta}\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"1.2251em\",\n                verticalAlign: \"-0.345em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.8801em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.655em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsxs(_components.span, {\n                            className: \"mord mtight\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord mtight\",\n                              style: {\n                                marginRight: \"0.05556em\"\n                              },\n                              children: \"∂\"\n                            }), _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              style: {\n                                marginRight: \"0.02778em\"\n                              },\n                              children: \"θ\"\n                            })]\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.394em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsxs(_components.span, {\n                            className: \"mord mtight\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord mtight\",\n                              style: {\n                                marginRight: \"0.05556em\"\n                              },\n                              children: \"∂\"\n                            }), _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              children: \"L\"\n                            })]\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.345em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            })]\n          })\n        })]\n      }), \"。\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"二分步推导\",\n      children: _jsx(_components.a, {\n        href: \"#二分步推导\",\n        children: _jsx(_components.strong, {\n          children: \"二、分步推导\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"步骤1前向传播表达式\",\n      children: _jsx(_components.a, {\n        href: \"#步骤1前向传播表达式\",\n        children: _jsx(_components.strong, {\n          children: \"步骤1：前向传播表达式\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"假设具体操作为：\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"A\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mn, {\n                      children: \"2\"\n                    })]\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"A = \\\\theta^2\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"A\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8141em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02778em\"\n                  },\n                  children: \"θ\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8141em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.063em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"2\"\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              })]\n            })]\n          })]\n        }), \" （Op1：平方操作）\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"B\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"2\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"B = 2\\\\theta\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05017em\"\n                },\n                children: \"B\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"2\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })]\n          })]\n        }), \" （Op2：线性操作）\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"L\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"A\"\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsx(_components.mi, {\n                    children: \"B\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"L = A + B\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"L\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.7667em\",\n                  verticalAlign: \"-0.0833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"A\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05017em\"\n                },\n                children: \"B\"\n              })]\n            })]\n          })]\n        }), \" （Op3：加法操作）\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"则最终损失为：\"\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsx(_components.mi, {\n                  children: \"L\"\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.msup, {\n                  children: [_jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mn, {\n                    children: \"2\"\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"+\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                }), _jsx(_components.mi, {\n                  children: \"θ\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"L = \\\\theta^2 + 2\\\\theta\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"L\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.9474em\",\n                verticalAlign: \"-0.0833em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsx(_components.span, {\n                  className: \"vlist-t\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.8641em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.113em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: \"2\"\n                          })\n                        })]\n                      })\n                    })\n                  })\n                })\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"+\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"θ\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"步骤2直接求导对比验证\",\n      children: _jsx(_components.a, {\n        href: \"#步骤2直接求导对比验证\",\n        children: _jsx(_components.strong, {\n          children: \"步骤2：直接求导（对比验证）\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"直接对 \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"L\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"L\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"L\"\n            })]\n          })\n        })]\n      }), \" 求导：\"]\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                }), _jsx(_components.mi, {\n                  children: \"θ\"\n                }), _jsx(_components.mo, {\n                  children: \"+\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial \\\\theta} = 2\\\\theta + 2\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.7778em\",\n                verticalAlign: \"-0.0833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"θ\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"+\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h4, {\n      id: \"步骤3反向传播视角\",\n      children: _jsx(_components.a, {\n        href: \"#步骤3反向传播视角\",\n        children: _jsx(_components.strong, {\n          children: \"步骤3：反向传播视角\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"根据计算图，梯度需要沿着两条路径反向传播：\"\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"路径1的梯度计算θ--a--l\",\n      children: _jsx(_components.a, {\n        href: \"#路径1的梯度计算θ--a--l\",\n        children: _jsx(_components.strong, {\n          children: \"路径1的梯度计算（θ → A → L）\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"A\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mn, {\n                      children: \"2\"\n                    })]\n                  }), _jsx(_components.mspace, {\n                    width: \"1em\"\n                  }), _jsx(_components.mo, {\n                    children: \"⇒\"\n                  }), _jsx(_components.mspace, {\n                    width: \"1em\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"A\"\n                      })]\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"θ\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"2\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"A = \\\\theta^2 \\\\quad \\\\Rightarrow \\\\quad \\\\frac{\\\\partial A}{\\\\partial \\\\theta} = 2\\\\theta\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"A\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8141em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02778em\"\n                  },\n                  children: \"θ\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8141em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.063em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"2\"\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"1em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"⇒\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"1em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.2251em\",\n                  verticalAlign: \"-0.345em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8801em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.655em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mtight\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.02778em\"\n                                },\n                                children: \"θ\"\n                              })]\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.394em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mtight\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"A\"\n                              })]\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.345em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"2\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })]\n          })]\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"L\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"A\"\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsx(_components.mi, {\n                    children: \"B\"\n                  }), _jsx(_components.mspace, {\n                    width: \"1em\"\n                  }), _jsx(_components.mo, {\n                    children: \"⇒\"\n                  }), _jsx(_components.mspace, {\n                    width: \"1em\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"L\"\n                      })]\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"A\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"L = A + B \\\\quad \\\\Rightarrow \\\\quad \\\\frac{\\\\partial L}{\\\\partial A} = 1\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"L\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.7667em\",\n                  verticalAlign: \"-0.0833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"A\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05017em\"\n                },\n                children: \"B\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"1em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"⇒\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"1em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.2251em\",\n                  verticalAlign: \"-0.345em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8801em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.655em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mtight\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"A\"\n                              })]\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.394em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mtight\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"L\"\n                              })]\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.345em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              })]\n            })]\n          })]\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"路径1的梯度贡献：\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsxs(_components.msub, {\n                  children: [_jsx(_components.mo, {\n                    fence: \"false\",\n                    stretchy: \"true\",\n                    minsize: \"2.4em\",\n                    maxsize: \"2.4em\",\n                    children: \"∣\"\n                  }), _jsx(_components.mtext, {\n                    children: \"路径1\"\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"A\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"A\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mn, {\n                  children: \"1\"\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                }), _jsx(_components.mi, {\n                  children: \"θ\"\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                }), _jsx(_components.mi, {\n                  children: \"θ\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial \\\\theta} \\\\bigg|_{\\\\text{路径1}} = \\\\frac{\\\\partial L}{\\\\partial A} \\\\cdot \\\\frac{\\\\partial A}{\\\\partial \\\\theta} = 1 \\\\cdot 2\\\\theta = 2\\\\theta\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.4497em\",\n                verticalAlign: \"-0.9997em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord\",\n                children: _jsx(_components.span, {\n                  className: \"delimsizing mult\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.45em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.45em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"4.4em\"\n                            }\n                          }), _jsx(_components.span, {\n                            style: {\n                              width: \"0.333em\",\n                              height: \"2.400em\"\n                            },\n                            children: _jsx(_components.svg, {\n                              xmlns: \"http://www.w3.org/2000/svg\",\n                              width: \"0.333em\",\n                              height: \"2.400em\",\n                              viewBox: \"0 0 333 2400\",\n                              children: _jsx(_components.path, {\n                                d: \"M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.95em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"-0.5214em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-1.7003em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord text mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord cjk_fallback mtight\",\n                                children: \"路径\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"1\"\n                              })]\n                            })\n                          })\n                        })]\n                      })\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.9997em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"A\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"A\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"1\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"θ\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"θ\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"路径2的梯度计算θ--b--l\",\n      children: _jsx(_components.a, {\n        href: \"#路径2的梯度计算θ--b--l\",\n        children: _jsx(_components.strong, {\n          children: \"路径2的梯度计算（θ → B → L）\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"B\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"2\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mspace, {\n                    width: \"1em\"\n                  }), _jsx(_components.mo, {\n                    children: \"⇒\"\n                  }), _jsx(_components.mspace, {\n                    width: \"1em\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"B\"\n                      })]\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"θ\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"2\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"B = 2\\\\theta \\\\quad \\\\Rightarrow \\\\quad \\\\frac{\\\\partial B}{\\\\partial \\\\theta} = 2\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05017em\"\n                },\n                children: \"B\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"2\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"1em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"⇒\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"1em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.2251em\",\n                  verticalAlign: \"-0.345em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8801em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.655em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mtight\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.02778em\"\n                                },\n                                children: \"θ\"\n                              })]\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.394em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mtight\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.05017em\"\n                                },\n                                children: \"B\"\n                              })]\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.345em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"2\"\n              })]\n            })]\n          })]\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"L\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"A\"\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsx(_components.mi, {\n                    children: \"B\"\n                  }), _jsx(_components.mspace, {\n                    width: \"1em\"\n                  }), _jsx(_components.mo, {\n                    children: \"⇒\"\n                  }), _jsx(_components.mspace, {\n                    width: \"1em\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"L\"\n                      })]\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsx(_components.mi, {\n                        children: \"B\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"L = A + B \\\\quad \\\\Rightarrow \\\\quad \\\\frac{\\\\partial L}{\\\\partial B} = 1\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"L\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.7667em\",\n                  verticalAlign: \"-0.0833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"A\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05017em\"\n                },\n                children: \"B\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"1em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"⇒\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"1em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.2251em\",\n                  verticalAlign: \"-0.345em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8801em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.655em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mtight\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.05017em\"\n                                },\n                                children: \"B\"\n                              })]\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.394em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mtight\",\n                                style: {\n                                  marginRight: \"0.05556em\"\n                                },\n                                children: \"∂\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"L\"\n                              })]\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.345em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              })]\n            })]\n          })]\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"路径2的梯度贡献：\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsxs(_components.msub, {\n                  children: [_jsx(_components.mo, {\n                    fence: \"false\",\n                    stretchy: \"true\",\n                    minsize: \"2.4em\",\n                    maxsize: \"2.4em\",\n                    children: \"∣\"\n                  }), _jsx(_components.mtext, {\n                    children: \"路径2\"\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"B\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"B\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mn, {\n                  children: \"1\"\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial \\\\theta} \\\\bigg|_{\\\\text{路径2}} = \\\\frac{\\\\partial L}{\\\\partial B} \\\\cdot \\\\frac{\\\\partial B}{\\\\partial \\\\theta} = 1 \\\\cdot 2 = 2\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.4497em\",\n                verticalAlign: \"-0.9997em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord\",\n                children: _jsx(_components.span, {\n                  className: \"delimsizing mult\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.45em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.45em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"4.4em\"\n                            }\n                          }), _jsx(_components.span, {\n                            style: {\n                              width: \"0.333em\",\n                              height: \"2.400em\"\n                            },\n                            children: _jsx(_components.svg, {\n                              xmlns: \"http://www.w3.org/2000/svg\",\n                              width: \"0.333em\",\n                              height: \"2.400em\",\n                              viewBox: \"0 0 333 2400\",\n                              children: _jsx(_components.path, {\n                                d: \"M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.95em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"-0.5214em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-1.7003em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord text mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord cjk_fallback mtight\",\n                                children: \"路径\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"2\"\n                              })]\n                            })\n                          })\n                        })]\n                      })\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.9997em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05017em\"\n                            },\n                            children: \"B\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05017em\"\n                            },\n                            children: \"B\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"1\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"总梯度--路径1--路径2\",\n      children: _jsx(_components.a, {\n        href: \"#总梯度--路径1--路径2\",\n        children: _jsx(_components.strong, {\n          children: \"总梯度 = 路径1 + 路径2\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                }), _jsx(_components.mi, {\n                  children: \"θ\"\n                }), _jsx(_components.mo, {\n                  children: \"+\"\n                }), _jsx(_components.mn, {\n                  children: \"2\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial \\\\theta} = 2\\\\theta + 2\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.7778em\",\n                verticalAlign: \"-0.0833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"θ\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"+\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"2\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"三通用公式解析\",\n      children: _jsx(_components.a, {\n        href: \"#三通用公式解析\",\n        children: _jsx(_components.strong, {\n          children: \"三、通用公式解析\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"原公式：\"\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"script\",\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.munder, {\n                  children: [_jsx(_components.mo, {\n                    children: \"∑\"\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mtext, {\n                      children: \"path \"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mo, {\n                      children: \"→\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"script\",\n                      children: \"L\"\n                    })]\n                  })]\n                }), _jsxs(_components.mrow, {\n                  children: [_jsx(_components.mo, {\n                    fence: \"true\",\n                    children: \"(\"\n                  }), _jsxs(_components.munder, {\n                    children: [_jsx(_components.mo, {\n                      children: \"∏\"\n                    }), _jsx(_components.mi, {\n                      children: \"i\"\n                    })]\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mtext, {\n                          children: \"op\"\n                        }), _jsx(_components.mi, {\n                          children: \"i\"\n                        })]\n                      })]\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∂\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mtext, {\n                          children: \"input\"\n                        }), _jsx(_components.mi, {\n                          children: \"i\"\n                        })]\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    fence: \"true\",\n                    children: \")\"\n                  })]\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial \\\\mathcal{L}}{\\\\partial \\\\theta} = \\\\sum_{\\\\text{path } \\\\theta \\\\to \\\\mathcal{L}} \\\\left( \\\\prod_{i} \\\\frac{\\\\partial \\\\text{op}_i}{\\\\partial \\\\text{input}_i} \\\\right)\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathcal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"3.1882em\",\n                verticalAlign: \"-1.4382em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mop op-limits\",\n              children: _jsxs(_components.span, {\n                className: \"vlist-t vlist-t2\",\n                children: [_jsxs(_components.span, {\n                  className: \"vlist-r\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist\",\n                    style: {\n                      height: \"1.05em\"\n                    },\n                    children: [_jsxs(_components.span, {\n                      style: {\n                        top: \"-1.8479em\",\n                        marginLeft: \"0em\"\n                      },\n                      children: [_jsx(_components.span, {\n                        className: \"pstrut\",\n                        style: {\n                          height: \"3.05em\"\n                        }\n                      }), _jsx(_components.span, {\n                        className: \"sizing reset-size6 size3 mtight\",\n                        children: _jsxs(_components.span, {\n                          className: \"mord mtight\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord text mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"path \"\n                            })\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal mtight\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          }), _jsx(_components.span, {\n                            className: \"mrel mtight\",\n                            children: \"→\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathcal mtight\",\n                            children: \"L\"\n                          })]\n                        })\n                      })]\n                    }), _jsxs(_components.span, {\n                      style: {\n                        top: \"-3.05em\"\n                      },\n                      children: [_jsx(_components.span, {\n                        className: \"pstrut\",\n                        style: {\n                          height: \"3.05em\"\n                        }\n                      }), _jsx(_components.span, {\n                        children: _jsx(_components.span, {\n                          className: \"mop op-symbol large-op\",\n                          children: \"∑\"\n                        })\n                      })]\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-s\",\n                    children: \"​\"\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"vlist-r\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist\",\n                    style: {\n                      height: \"1.4382em\"\n                    },\n                    children: _jsx(_components.span, {})\n                  })\n                })]\n              })\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.1667em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"minner\",\n              children: [_jsx(_components.span, {\n                className: \"mopen delimcenter\",\n                style: {\n                  top: \"0em\"\n                },\n                children: _jsx(_components.span, {\n                  className: \"delimsizing size4\",\n                  children: \"(\"\n                })\n              }), _jsx(_components.span, {\n                className: \"mop op-limits\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.05em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-1.8723em\",\n                          marginLeft: \"0em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3.05em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              children: \"i\"\n                            })\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3.05em\"\n                          }\n                        }), _jsx(_components.span, {\n                          children: _jsx(_components.span, {\n                            className: \"mop op-symbol large-op\",\n                            children: \"∏\"\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.2777em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.3714em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.314em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              style: {\n                                marginRight: \"0.05556em\"\n                              },\n                              children: \"∂\"\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord text\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord\",\n                                  children: \"input\"\n                                })\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsxs(_components.span, {\n                                  className: \"vlist-t vlist-t2\",\n                                  children: [_jsxs(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: [_jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.2175em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.4559em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsx(_components.span, {\n                                            className: \"mord mathnormal mtight\",\n                                            children: \"i\"\n                                          })\n                                        })]\n                                      })\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-s\",\n                                      children: \"​\"\n                                    })]\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.2441em\"\n                                      },\n                                      children: _jsx(_components.span, {})\n                                    })\n                                  })]\n                                })\n                              })]\n                            })]\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.677em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              style: {\n                                marginRight: \"0.05556em\"\n                              },\n                              children: \"∂\"\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord text\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord\",\n                                  children: \"op\"\n                                })\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsxs(_components.span, {\n                                  className: \"vlist-t vlist-t2\",\n                                  children: [_jsxs(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: [_jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.2175em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.4559em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsx(_components.span, {\n                                            className: \"mord mathnormal mtight\",\n                                            children: \"i\"\n                                          })\n                                        })]\n                                      })\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-s\",\n                                      children: \"​\"\n                                    })]\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.2441em\"\n                                      },\n                                      children: _jsx(_components.span, {})\n                                    })\n                                  })]\n                                })\n                              })]\n                            })]\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.9301em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mclose delimcenter\",\n                style: {\n                  top: \"0em\"\n                },\n                children: _jsx(_components.span, {\n                  className: \"delimsizing size4\",\n                  children: \")\"\n                })\n              })]\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"1-符号解释\",\n      children: _jsx(_components.a, {\n        href: \"#1-符号解释\",\n        children: _jsx(_components.strong, {\n          children: \"1. 符号解释\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"路径（Path）\"\n        }), \"：参数 \", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        }), \" 到损失 \", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    mathvariant: \"script\",\n                    children: \"L\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\mathcal{L}\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathcal\",\n                children: \"L\"\n              })]\n            })\n          })]\n        }), \" 的所有可能数据流动路径。\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.strong, {\n          children: [\"乘积项 \", _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mo, {\n                      children: \"∏\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\prod\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mop op-symbol small-op\",\n                  style: {\n                    position: \"relative\",\n                    top: \"0em\"\n                  },\n                  children: \"∏\"\n                })]\n              })\n            })]\n          })]\n        }), \"：沿某条路径的所有操作（op）的导数连乘（链式法则）。\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.strong, {\n          children: [\"求和项 \", _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mo, {\n                      children: \"∑\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\sum\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mop op-symbol small-op\",\n                  style: {\n                    position: \"relative\",\n                    top: \"0em\"\n                  },\n                  children: \"∑\"\n                })]\n              })\n            })]\n          })]\n        }), \"：将所有路径的梯度贡献相加（多路径时梯度累加）。\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"2-关键性质\",\n      children: _jsx(_components.a, {\n        href: \"#2-关键性质\",\n        children: _jsx(_components.strong, {\n          children: \"2. 关键性质\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"链式法则\"\n        }), \"：复合函数的导数 = 外层导数 × 内层导数。\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"多路径叠加\"\n        }), \"：如果参数影响输出的多个分支，梯度是各分支贡献的总和。\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"四复杂案例验证\",\n      children: _jsx(_components.a, {\n        href: \"#四复杂案例验证\",\n        children: _jsx(_components.strong, {\n          children: \"四、复杂案例验证\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"考虑一个更复杂的计算图：\"\n    }), \"\\n\", _jsx(CodeBlockMermaid, {\n      lang: \"mermaid\",\n      value: \"graph LR\\n    θ((θ)) --\u003e Op1 --\u003e C\\n    θ --\u003e Op2 --\u003e D\\n    C --\u003e Op3 --\u003e E\\n    D --\u003e Op4 --\u003e E\\n    E --\u003e Op5 --\u003e L\"\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"前向传播表达式\",\n      children: _jsx(_components.a, {\n        href: \"#前向传播表达式\",\n        children: _jsx(_components.strong, {\n          children: \"前向传播表达式\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"C\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mn, {\n                      children: \"3\"\n                    })]\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"C = \\\\theta^3\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.07153em\"\n                },\n                children: \"C\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8141em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02778em\"\n                  },\n                  children: \"θ\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8141em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.063em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"3\"\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              })]\n            })]\n          })]\n        }), \"（Op1）\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"D\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"sin\"\n                  }), _jsx(_components.mo, {\n                    children: \"⁡\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"D = \\\\sin(\\\\theta)\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"D\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mop\",\n                children: \"sin\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })]\n          })]\n        }), \"（Op2）\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"E\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"C\"\n                  }), _jsx(_components.mo, {\n                    children: \"⋅\"\n                  }), _jsx(_components.mi, {\n                    children: \"D\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"E = C \\\\cdot D\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05764em\"\n                },\n                children: \"E\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.07153em\"\n                },\n                children: \"C\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"⋅\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"D\"\n              })]\n            })]\n          })]\n        }), \"（Op3）\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"L\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"ln\"\n                  }), _jsx(_components.mo, {\n                    children: \"⁡\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"E\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"L = \\\\ln(E)\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"L\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mop\",\n                children: \"ln\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05764em\"\n                },\n                children: \"E\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })]\n          })]\n        }), \"（Op4）\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"反向传播计算\",\n      children: _jsx(_components.a, {\n        href: \"#反向传播计算\",\n        children: _jsx(_components.strong, {\n          children: \"反向传播计算\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"路径1θ--c--e--l\",\n      children: _jsx(_components.a, {\n        href: \"#路径1θ--c--e--l\",\n        children: _jsx(_components.strong, {\n          children: \"路径1：θ → C → E → L\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsxs(_components.msub, {\n                  children: [_jsx(_components.mo, {\n                    fence: \"false\",\n                    stretchy: \"true\",\n                    minsize: \"2.4em\",\n                    maxsize: \"2.4em\",\n                    children: \"∣\"\n                  }), _jsx(_components.mtext, {\n                    children: \"路径1\"\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"E\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"E\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"C\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"C\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsx(_components.mn, {\n                    children: \"1\"\n                  }), _jsx(_components.mi, {\n                    children: \"E\"\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsx(_components.mi, {\n                  children: \"D\"\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsx(_components.mn, {\n                  children: \"3\"\n                }), _jsxs(_components.msup, {\n                  children: [_jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mn, {\n                    children: \"2\"\n                  })]\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial \\\\theta} \\\\bigg|_{\\\\text{路径1}} = \\\\frac{\\\\partial L}{\\\\partial E} \\\\cdot \\\\frac{\\\\partial E}{\\\\partial C} \\\\cdot \\\\frac{\\\\partial C}{\\\\partial \\\\theta} = \\\\frac{1}{E} \\\\cdot D \\\\cdot 3\\\\theta^2\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.4497em\",\n                verticalAlign: \"-0.9997em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord\",\n                children: _jsx(_components.span, {\n                  className: \"delimsizing mult\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.45em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.45em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"4.4em\"\n                            }\n                          }), _jsx(_components.span, {\n                            style: {\n                              width: \"0.333em\",\n                              height: \"2.400em\"\n                            },\n                            children: _jsx(_components.svg, {\n                              xmlns: \"http://www.w3.org/2000/svg\",\n                              width: \"0.333em\",\n                              height: \"2.400em\",\n                              viewBox: \"0 0 333 2400\",\n                              children: _jsx(_components.path, {\n                                d: \"M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.95em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"-0.5214em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-1.7003em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord text mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord cjk_fallback mtight\",\n                                children: \"路径\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"1\"\n                              })]\n                            })\n                          })\n                        })]\n                      })\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.9997em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05764em\"\n                            },\n                            children: \"E\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.07153em\"\n                            },\n                            children: \"C\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05764em\"\n                            },\n                            children: \"E\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.07153em\"\n                            },\n                            children: \"C\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0074em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3214em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"mord\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05764em\"\n                            },\n                            children: \"E\"\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"mord\",\n                          children: _jsx(_components.span, {\n                            className: \"mord\",\n                            children: \"1\"\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"D\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.8641em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"3\"\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsx(_components.span, {\n                  className: \"vlist-t\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.8641em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.113em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: \"2\"\n                          })\n                        })]\n                      })\n                    })\n                  })\n                })\n              })]\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"路径2θ--d--e--l\",\n      children: _jsx(_components.a, {\n        href: \"#路径2θ--d--e--l\",\n        children: _jsx(_components.strong, {\n          children: \"路径2：θ → D → E → L\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsxs(_components.msub, {\n                  children: [_jsx(_components.mo, {\n                    fence: \"false\",\n                    stretchy: \"true\",\n                    minsize: \"2.4em\",\n                    maxsize: \"2.4em\",\n                    children: \"∣\"\n                  }), _jsx(_components.mtext, {\n                    children: \"路径2\"\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"E\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"E\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"D\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"D\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsx(_components.mn, {\n                    children: \"1\"\n                  }), _jsx(_components.mi, {\n                    children: \"E\"\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsx(_components.mi, {\n                  children: \"C\"\n                }), _jsx(_components.mo, {\n                  children: \"⋅\"\n                }), _jsx(_components.mi, {\n                  children: \"cos\"\n                }), _jsx(_components.mo, {\n                  children: \"⁡\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \"(\"\n                }), _jsx(_components.mi, {\n                  children: \"θ\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \")\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial \\\\theta} \\\\bigg|_{\\\\text{路径2}} = \\\\frac{\\\\partial L}{\\\\partial E} \\\\cdot \\\\frac{\\\\partial E}{\\\\partial D} \\\\cdot \\\\frac{\\\\partial D}{\\\\partial \\\\theta} = \\\\frac{1}{E} \\\\cdot C \\\\cdot \\\\cos(\\\\theta)\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.4497em\",\n                verticalAlign: \"-0.9997em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord\",\n                children: _jsx(_components.span, {\n                  className: \"delimsizing mult\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.45em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.45em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"4.4em\"\n                            }\n                          }), _jsx(_components.span, {\n                            style: {\n                              width: \"0.333em\",\n                              height: \"2.400em\"\n                            },\n                            children: _jsx(_components.svg, {\n                              xmlns: \"http://www.w3.org/2000/svg\",\n                              width: \"0.333em\",\n                              height: \"2.400em\",\n                              viewBox: \"0 0 333 2400\",\n                              children: _jsx(_components.path, {\n                                d: \"M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.95em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"-0.5214em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-1.7003em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord text mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord cjk_fallback mtight\",\n                                children: \"路径\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"2\"\n                              })]\n                            })\n                          })\n                        })]\n                      })\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.9997em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05764em\"\n                            },\n                            children: \"E\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"D\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05764em\"\n                            },\n                            children: \"E\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"D\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0074em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3214em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"mord\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05764em\"\n                            },\n                            children: \"E\"\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"mord\",\n                          children: _jsx(_components.span, {\n                            className: \"mord\",\n                            children: \"1\"\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.07153em\"\n              },\n              children: \"C\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"⋅\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"1em\",\n                verticalAlign: \"-0.25em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mop\",\n              children: \"cos\"\n            }), _jsx(_components.span, {\n              className: \"mopen\",\n              children: \"(\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02778em\"\n              },\n              children: \"θ\"\n            }), _jsx(_components.span, {\n              className: \"mclose\",\n              children: \")\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"总梯度\",\n      children: _jsx(_components.a, {\n        href: \"#总梯度\",\n        children: _jsx(_components.strong, {\n          children: \"总梯度\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"L\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"∂\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      children: \"D\"\n                    }), _jsx(_components.mo, {\n                      children: \"⋅\"\n                    }), _jsx(_components.mn, {\n                      children: \"3\"\n                    }), _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"θ\"\n                      }), _jsx(_components.mn, {\n                        children: \"2\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      children: \"+\"\n                    }), _jsx(_components.mi, {\n                      children: \"C\"\n                    }), _jsx(_components.mo, {\n                      children: \"⋅\"\n                    }), _jsx(_components.mi, {\n                      children: \"cos\"\n                    }), _jsx(_components.mo, {\n                      children: \"⁡\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.mi, {\n                    children: \"E\"\n                  })]\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"\\\\frac{\\\\partial L}{\\\\partial \\\\theta} = \\\\frac{D \\\\cdot 3\\\\theta^2 + C \\\\cdot \\\\cos(\\\\theta)}{E}\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.0574em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.05556em\"\n                            },\n                            children: \"∂\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"L\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.1771em\",\n                verticalAlign: \"-0.686em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.4911em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"mord\",\n                          children: _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.05764em\"\n                            },\n                            children: \"E\"\n                          })\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.677em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"D\"\n                          }), _jsx(_components.span, {\n                            className: \"mspace\",\n                            style: {\n                              marginRight: \"0.2222em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mbin\",\n                            children: \"⋅\"\n                          }), _jsx(_components.span, {\n                            className: \"mspace\",\n                            style: {\n                              marginRight: \"0.2222em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            children: \"3\"\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord mathnormal\",\n                              style: {\n                                marginRight: \"0.02778em\"\n                              },\n                              children: \"θ\"\n                            }), _jsx(_components.span, {\n                              className: \"msupsub\",\n                              children: _jsx(_components.span, {\n                                className: \"vlist-t\",\n                                children: _jsx(_components.span, {\n                                  className: \"vlist-r\",\n                                  children: _jsx(_components.span, {\n                                    className: \"vlist\",\n                                    style: {\n                                      height: \"0.8141em\"\n                                    },\n                                    children: _jsxs(_components.span, {\n                                      style: {\n                                        top: \"-3.063em\",\n                                        marginRight: \"0.05em\"\n                                      },\n                                      children: [_jsx(_components.span, {\n                                        className: \"pstrut\",\n                                        style: {\n                                          height: \"2.7em\"\n                                        }\n                                      }), _jsx(_components.span, {\n                                        className: \"sizing reset-size6 size3 mtight\",\n                                        children: _jsx(_components.span, {\n                                          className: \"mord mtight\",\n                                          children: \"2\"\n                                        })\n                                      })]\n                                    })\n                                  })\n                                })\n                              })\n                            })]\n                          }), _jsx(_components.span, {\n                            className: \"mspace\",\n                            style: {\n                              marginRight: \"0.2222em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mbin\",\n                            children: \"+\"\n                          }), _jsx(_components.span, {\n                            className: \"mspace\",\n                            style: {\n                              marginRight: \"0.2222em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.07153em\"\n                            },\n                            children: \"C\"\n                          }), _jsx(_components.span, {\n                            className: \"mspace\",\n                            style: {\n                              marginRight: \"0.2222em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mbin\",\n                            children: \"⋅\"\n                          }), _jsx(_components.span, {\n                            className: \"mspace\",\n                            style: {\n                              marginRight: \"0.2222em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mop\",\n                            children: \"cos\"\n                          }), _jsx(_components.span, {\n                            className: \"mopen\",\n                            children: \"(\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"θ\"\n                          }), _jsx(_components.span, {\n                            className: \"mclose\",\n                            children: \")\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.686em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"五反向传播的本质\",\n      children: _jsx(_components.a, {\n        href: \"#五反向传播的本质\",\n        children: _jsx(_components.strong, {\n          children: \"五、反向传播的本质\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"自动化的链式法则\"\n        }), \"：框架通过计算图自动追踪操作路径。\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"梯度累加规则\"\n        }), \"：当一个参数影响多个分支时，梯度是所有路径贡献的总和。\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"计算效率\"\n        }), \"：避免重复计算，时间复杂度与网络深度成线性关系（\", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"O\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"n\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"O(n)\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"O\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"n\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })\n          })]\n        }), \"）。\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"六总结\",\n      children: _jsx(_components.a, {\n        href: \"#六总结\",\n        children: _jsx(_components.strong, {\n          children: \"六、总结\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.strong, {\n          children: [\"为什么需要求和（\", _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mo, {\n                      children: \"∑\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\sum\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mop op-symbol small-op\",\n                  style: {\n                    position: \"relative\",\n                    top: \"0em\"\n                  },\n                  children: \"∑\"\n                })]\n              })\n            })]\n          }), \"）\"]\n        }), \"：因为参数可能通过多个路径影响损失，每个路径贡献一部分梯度。\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsxs(_components.strong, {\n          children: [\"为什么需要连乘（\", _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mo, {\n                      children: \"∏\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\prod\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mop op-symbol small-op\",\n                  style: {\n                    position: \"relative\",\n                    top: \"0em\"\n                  },\n                  children: \"∏\"\n                })]\n              })\n            })]\n          }), \"）\"]\n        }), \"：链式法则要求将路径上的所有局部导数相乘。\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"反向传播的优势\"\n        }), \"：将复杂的全局求导分解为局部导数的连乘与路径求和，大幅降低计算复杂度。\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"通过这种分路径计算再累加的方式，反向传播巧妙地利用计算图的结构信息，实现了高效的梯度计算。\"\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"q-从-pytorch-代码层面深入解释一下-pytorch-的反向传播如何实现\",\n      children: _jsx(_components.a, {\n        href: \"#q-从-pytorch-代码层面深入解释一下-pytorch-的反向传播如何实现\",\n        children: \"Q: 从 PyTorch 代码层面深入解释一下 PyTorch 的反向传播如何实现\"\n      })\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"query\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"从 PyTorch 代码层面深入解释一下 PyTorch 的反向传播如何实现\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"think\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"嗯，用户之前已经了解了反向传播的数学原理和为什么需要它，现在他们想从PyTorch代码层面深入理解反向传播的实现。用户可能有一定的编程基础，但可能对PyTorch的内部机制不太熟悉。我需要确保解释清晰，结合代码示例，同时避免过于复杂的术语。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"首先，用户提到了之前的公式，关于梯度的路径求和，现在需要将这一数学概念与PyTorch的具体实现联系起来。他们可能想知道PyTorch是如何动态构建计算图的，如何跟踪梯度，以及backward()方法具体做了什么。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"接下来，我应该分步骤解释PyTorch的关键组件，比如Tensor的requires_grad属性、grad_fn、grad属性，以及动态计算图的构建过程。需要举例说明，比如一个简单的计算图，并展示梯度是如何累积的。同时，用户可能对梯度累积和内存管理感兴趣，比如PyTorch如何释放中间变量，如何通过retain_grad()来保留梯度。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"另外，用户可能对多路径梯度累加的情况有疑问，比如当多个操作影响同一个参数时，梯度是如何相加的。这时候需要举例说明，比如一个参数通过两条路径影响损失函数，PyTorch如何处理这种情况。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"还需要提到Autograd引擎的工作原理，比如如何遍历计算图，执行反向传播，以及如何优化计算效率。可能还需要讨论一些高级话题，比如detach()的作用，或者如何自定义反向传播函数，但根据用户的知识水平，可能需要保持基础。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"用户可能存在的误区是认为PyTorch会保存所有中间变量的梯度，但实际上默认只保留叶子节点的梯度。这需要特别说明，并解释如何通过retain_grad()来查看中间节点的梯度。\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"最后，应该总结PyTorch反向传播的关键点，强调其动态计算图的优势，以及如何高效管理内存和计算资源。确保用户理解为什么PyTorch适合动态图模型，以及在实际调试中如何利用这些机制。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"以下是关于 PyTorch 反向传播实现机制的代码级深入解析，结合关键代码段和底层原理说明：\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"一pytorch-反向传播的三大核心组件\",\n      children: _jsx(_components.a, {\n        href: \"#一pytorch-反向传播的三大核心组件\",\n        children: _jsx(_components.strong, {\n          children: \"一、PyTorch 反向传播的三大核心组件\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"1-tensor-的梯度追踪机制\",\n      children: _jsx(_components.a, {\n        href: \"#1-tensor-的梯度追踪机制\",\n        children: _jsx(_components.strong, {\n          children: \"1. Tensor 的梯度追踪机制\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"import\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 创建需要梯度追踪的张量\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"2.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"],\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 叶子节点\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"W \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"3.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"],\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 叶子节点\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 执行计算（自动记录操作）\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" W \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" x           \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" grad_fn=\u003cMulBackward0\u003e\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"z \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" y \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"+\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 1\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"           #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" grad_fn=\u003cAddBackward0\u003e\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"loss \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" z\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"mean\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"      #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" grad_fn=\u003cMeanBackward0\u003e\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"loss\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad_fn\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 输出: \u003cMeanBackward0 object\u003e\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: _jsx(_components.code, {\n            children: \"requires_grad=True\"\n          })\n        }), \"：标记需要追踪梯度的张量（叶子节点）\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: _jsx(_components.code, {\n            children: \"grad_fn\"\n          })\n        }), \"：记录创建该张量的操作（反向传播时知道如何计算梯度）\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"2-计算图的动态构建\",\n      children: _jsx(_components.a, {\n        href: \"#2-计算图的动态构建\",\n        children: _jsx(_components.strong, {\n          children: \"2. 计算图的动态构建\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"PyTorch 的计算图是\", _jsx(_components.strong, {\n        children: \"动态构建的\"\n      }), \"，每次前向传播都会新建一个图：\"]\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 示例：动态图特性\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"def\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" forward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \"x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"):\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"    if\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"sum\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \" \u003e\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \":\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"        return\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 2\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"    else\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \":\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"        return\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \" (\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"-\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"1\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"3.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"],\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"out \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" forward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 根据输入值动态创建不同的计算图\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"out\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"    #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 自动适应不同的分支路径\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"3-反向传播引擎autograd-engine\",\n      children: _jsx(_components.a, {\n        href: \"#3-反向传播引擎autograd-engine\",\n        children: _jsx(_components.strong, {\n          children: \"3. 反向传播引擎（Autograd Engine）\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"当调用 \", _jsx(_components.code, {\n        children: \".backward()\"\n      }), \" 时，PyTorch 会执行以下操作：\"]\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsx(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"loss\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 触发反向传播\"\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"反向遍历计算图\"\n        }), \"：从 \", _jsx(_components.code, {\n          children: \"loss\"\n        }), \" 的 \", _jsx(_components.code, {\n          children: \"grad_fn\"\n        }), \" 开始，沿着 \", _jsx(_components.code, {\n          children: \"next_functions\"\n        }), \" 递归\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"计算局部梯度\"\n        }), \"：在每个操作节点调用已注册的 \", _jsx(_components.code, {\n          children: \"backward()\"\n        }), \" 方法\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"梯度累加\"\n        }), \"：将计算结果累积到对应张量的 \", _jsx(_components.code, {\n          children: \".grad\"\n        }), \" 属性中\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"二代码级反向传播流程分解\",\n      children: _jsx(_components.a, {\n        href: \"#二代码级反向传播流程分解\",\n        children: _jsx(_components.strong, {\n          children: \"二、代码级反向传播流程分解\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"步骤1前向传播构建计算图\",\n      children: _jsx(_components.a, {\n        href: \"#步骤1前向传播构建计算图\",\n        children: _jsx(_components.strong, {\n          children: \"步骤1：前向传播构建计算图\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"a \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"2.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"b \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"3.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"c \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" a \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" b      \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" grad_fn=\u003cMulBackward0\u003e\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"d \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" c \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"+\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 1\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"      #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" grad_fn=\u003cAddBackward0\u003e\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"loss \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" d\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"**\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"2\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"    #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" grad_fn=\u003cPowBackward0\u003e\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"此时的计算图结构：\"\n    }), \"\\n\", _jsx(CodeBlockMermaid, {\n      lang: \"mermaid\",\n      value: \"graph LR\\n  a --\u003e Mul --\u003e c\\n  b --\u003e Mul\\n  c --\u003e Add --\u003e d\\n  d --\u003e Pow --\u003e loss\"\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"步骤2执行反向传播\",\n      children: _jsx(_components.a, {\n        href: \"#步骤2执行反向传播\",\n        children: _jsx(_components.strong, {\n          children: \"步骤2：执行反向传播\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsx(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"loss\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 触发反向传播\"\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.h5, {\n      id: \"底层操作分解\",\n      children: _jsxs(_components.a, {\n        href: \"#底层操作分解\",\n        children: [_jsx(_components.strong, {\n          children: \"底层操作分解\"\n        }), \"：\"]\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"初始化梯度\"\n        }), \"：设置 \", _jsx(_components.code, {\n          children: \"loss.grad = 1.0\"\n        }), \"（标量损失的默认梯度）\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"反向传播到 d\"\n        }), \"：\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsxs(_components.li, {\n            children: [\"调用 \", _jsx(_components.code, {\n              children: \"PowBackward0\"\n            }), \" 的 \", _jsx(_components.code, {\n              children: \"backward()\"\n            }), \" 方法：\", \"\\n\", _jsx(_components.figure, {\n              \"data-rehype-pretty-code-figure\": \"\",\n              children: _jsx(_components.pre, {\n                style: {\n                  backgroundColor: \"#232136\",\n                  color: \"#e0def4\"\n                },\n                tabIndex: \"0\",\n                \"data-language\": \"python\",\n                \"data-theme\": \"rose-pine-moon\",\n                children: _jsx(_components.code, {\n                  \"data-language\": \"python\",\n                  \"data-theme\": \"rose-pine-moon\",\n                  style: {\n                    display: \"grid\"\n                  },\n                  children: _jsxs(_components.span, {\n                    \"data-line\": \"\",\n                    children: [_jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \"d_grad \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#3E8FB0\"\n                      },\n                      children: \"=\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#EA9A97\"\n                      },\n                      children: \" 2\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#3E8FB0\"\n                      },\n                      children: \" *\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \" d  \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#908CAA\",\n                        fontStyle: \"italic\"\n                      },\n                      children: \"#\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#6E6A86\",\n                        fontStyle: \"italic\"\n                      },\n                      children: \" 导数公式：d(loss)/d(d) = 2d\"\n                    })]\n                  })\n                })\n              })\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"反向传播到 c\"\n        }), \"：\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsxs(_components.li, {\n            children: [\"调用 \", _jsx(_components.code, {\n              children: \"AddBackward0\"\n            }), \" 的 \", _jsx(_components.code, {\n              children: \"backward()\"\n            }), \" 方法：\", \"\\n\", _jsx(_components.figure, {\n              \"data-rehype-pretty-code-figure\": \"\",\n              children: _jsx(_components.pre, {\n                style: {\n                  backgroundColor: \"#232136\",\n                  color: \"#e0def4\"\n                },\n                tabIndex: \"0\",\n                \"data-language\": \"python\",\n                \"data-theme\": \"rose-pine-moon\",\n                children: _jsx(_components.code, {\n                  \"data-language\": \"python\",\n                  \"data-theme\": \"rose-pine-moon\",\n                  style: {\n                    display: \"grid\"\n                  },\n                  children: _jsxs(_components.span, {\n                    \"data-line\": \"\",\n                    children: [_jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \"c_grad \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#3E8FB0\"\n                      },\n                      children: \"=\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \" d_grad \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#3E8FB0\"\n                      },\n                      children: \"*\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#EA9A97\"\n                      },\n                      children: \" 1\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#908CAA\",\n                        fontStyle: \"italic\"\n                      },\n                      children: \"  #\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#6E6A86\",\n                        fontStyle: \"italic\"\n                      },\n                      children: \" 加法操作的导数为1\"\n                    })]\n                  })\n                })\n              })\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"反向传播到 a 和 b\"\n        }), \"：\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsxs(_components.li, {\n            children: [\"调用 \", _jsx(_components.code, {\n              children: \"MulBackward0\"\n            }), \" 的 \", _jsx(_components.code, {\n              children: \"backward()\"\n            }), \" 方法：\", \"\\n\", _jsx(_components.figure, {\n              \"data-rehype-pretty-code-figure\": \"\",\n              children: _jsx(_components.pre, {\n                style: {\n                  backgroundColor: \"#232136\",\n                  color: \"#e0def4\"\n                },\n                tabIndex: \"0\",\n                \"data-language\": \"python\",\n                \"data-theme\": \"rose-pine-moon\",\n                children: _jsxs(_components.code, {\n                  \"data-language\": \"python\",\n                  \"data-theme\": \"rose-pine-moon\",\n                  style: {\n                    display: \"grid\"\n                  },\n                  children: [_jsxs(_components.span, {\n                    \"data-line\": \"\",\n                    children: [_jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \"a_grad \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#3E8FB0\"\n                      },\n                      children: \"=\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \" c_grad \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#3E8FB0\"\n                      },\n                      children: \"*\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \" b  \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#908CAA\",\n                        fontStyle: \"italic\"\n                      },\n                      children: \"#\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#6E6A86\",\n                        fontStyle: \"italic\"\n                      },\n                      children: \" 导数公式：d(c)/d(a) = b\"\n                    })]\n                  }), \"\\n\", _jsxs(_components.span, {\n                    \"data-line\": \"\",\n                    children: [_jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \"b_grad \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#3E8FB0\"\n                      },\n                      children: \"=\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \" c_grad \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#3E8FB0\"\n                      },\n                      children: \"*\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#E0DEF4\"\n                      },\n                      children: \" a  \"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#908CAA\",\n                        fontStyle: \"italic\"\n                      },\n                      children: \"#\"\n                    }), _jsx(_components.span, {\n                      style: {\n                        color: \"#6E6A86\",\n                        fontStyle: \"italic\"\n                      },\n                      children: \" 导数公式：d(c)/d(b) = a\"\n                    })]\n                  })]\n                })\n              })\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"梯度累加\"\n        }), \"：\", \"\\n\", _jsx(_components.figure, {\n          \"data-rehype-pretty-code-figure\": \"\",\n          children: _jsx(_components.pre, {\n            style: {\n              backgroundColor: \"#232136\",\n              color: \"#e0def4\"\n            },\n            tabIndex: \"0\",\n            \"data-language\": \"python\",\n            \"data-theme\": \"rose-pine-moon\",\n            children: _jsxs(_components.code, {\n              \"data-language\": \"python\",\n              \"data-theme\": \"rose-pine-moon\",\n              style: {\n                display: \"grid\"\n              },\n              children: [_jsxs(_components.span, {\n                \"data-line\": \"\",\n                children: [_jsx(_components.span, {\n                  style: {\n                    color: \"#E0DEF4\"\n                  },\n                  children: \"a\"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#908CAA\"\n                  },\n                  children: \".\"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#E0DEF4\"\n                  },\n                  children: \"grad \"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#3E8FB0\"\n                  },\n                  children: \"+=\"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#E0DEF4\"\n                  },\n                  children: \" a_grad  \"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#908CAA\",\n                    fontStyle: \"italic\"\n                  },\n                  children: \"#\"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#6E6A86\",\n                    fontStyle: \"italic\"\n                  },\n                  children: \" 实际为 in-place 操作\"\n                })]\n              }), \"\\n\", _jsxs(_components.span, {\n                \"data-line\": \"\",\n                children: [_jsx(_components.span, {\n                  style: {\n                    color: \"#E0DEF4\"\n                  },\n                  children: \"b\"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#908CAA\"\n                  },\n                  children: \".\"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#E0DEF4\"\n                  },\n                  children: \"grad \"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#3E8FB0\"\n                  },\n                  children: \"+=\"\n                }), _jsx(_components.span, {\n                  style: {\n                    color: \"#E0DEF4\"\n                  },\n                  children: \" b_grad\"\n                })]\n              })]\n            })\n          })\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"步骤3查看结果\",\n      children: _jsx(_components.a, {\n        href: \"#步骤3查看结果\",\n        children: _jsx(_components.strong, {\n          children: \"步骤3：查看结果\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"a\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 输出: 2*d* b = 2*(2*3+1)*3 = 42\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"b\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 输出: 2*d* a = 2*(2*3+1)*2 = 28\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"三pytorch-反向传播的关键实现细节\",\n      children: _jsx(_components.a, {\n        href: \"#三pytorch-反向传播的关键实现细节\",\n        children: _jsx(_components.strong, {\n          children: \"三、PyTorch 反向传播的关键实现细节\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"1-梯度计算规则注册\",\n      children: _jsx(_components.a, {\n        href: \"#1-梯度计算规则注册\",\n        children: _jsx(_components.strong, {\n          children: \"1. 梯度计算规则注册\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"每个 \", _jsx(_components.code, {\n        children: \"torch\"\n      }), \" 操作都有预定义的梯度计算规则：\"]\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 示例：自定义操作的梯度规则\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"class\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#9CCFD8\"\n              },\n              children: \" MyAdd\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \"torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \"autograd\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \"Function\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"):\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"    @\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#9CCFD8\"\n              },\n              children: \"staticmethod\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"    def\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" forward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \"ctx\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" y\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"):\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"        ctx\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"save_for_backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" y\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 保存前向传播的输入\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"        return\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"+\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" y\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"    @\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#9CCFD8\"\n              },\n              children: \"staticmethod\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"    def\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \"ctx\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" grad_output\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"):\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"        x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" y \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" ctx\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"saved_tensors\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"        return\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" grad_output \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 1\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" grad_output \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 1\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 加法操作的导数\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 使用自定义操作\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"a \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"2.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"b \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"3.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"c \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" MyAdd\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"apply\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"a\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" b\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"c\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"2-梯度累加机制\",\n      children: _jsx(_components.a, {\n        href: \"#2-梯度累加机制\",\n        children: _jsx(_components.strong, {\n          children: \"2. 梯度累加机制\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"PyTorch 默认会\", _jsx(_components.strong, {\n        children: \"累加梯度\"\n      }), \"，因此每次反向传播前需要手动清零：\"]\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"optimizer\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"zero_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 标准训练循环中的必要操作\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"loss\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"        #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 梯度会累加到 .grad 属性中\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"optimizer\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"step\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"3-非标量张量的反向传播\",\n      children: _jsx(_components.a, {\n        href: \"#3-非标量张量的反向传播\",\n        children: _jsx(_components.strong, {\n          children: \"3. 非标量张量的反向传播\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"当输出为非标量时，需要提供 \", _jsx(_components.code, {\n        children: \"gradient\"\n      }), \" 参数：\"]\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"1.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 2.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"],\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 2\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 假设 y 是向量，需要提供梯度初始值\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \"gradient\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"0.1\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 0.2\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"]))\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"  \"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"x\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 输出: tensor([0.2, 0.4])\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"4-内存优化策略\",\n      children: _jsx(_components.a, {\n        href: \"#4-内存优化策略\",\n        children: _jsx(_components.strong, {\n          children: \"4. 内存优化策略\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"中间变量释放\"\n        }), \"：默认只保留叶子节点的梯度\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"梯度检查点\"\n        }), \"：通过 \", _jsx(_components.code, {\n          children: \"torch.utils.checkpoint\"\n        }), \" 减少内存占用\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"禁用梯度计算\"\n        }), \"：使用 \", _jsx(_components.code, {\n          children: \"with torch.no_grad():\"\n        }), \" 或 \", _jsx(_components.code, {\n          children: \"@torch.inference_mode()\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"四可视化反向传播过程\",\n      children: _jsx(_components.a, {\n        href: \"#四可视化反向传播过程\",\n        children: _jsx(_components.strong, {\n          children: \"四、可视化反向传播过程\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"示例代码\",\n      children: _jsx(_components.a, {\n        href: \"#示例代码\",\n        children: _jsx(_components.strong, {\n          children: \"示例代码\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"import\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torchviz\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"a \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"3.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"b \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"tensor\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"4.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" requires_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"True\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"c \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" a \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" b\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"d \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" c\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"sin\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"d\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 生成计算图可视化\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"torchviz\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"make_dot\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"d\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" params\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"{\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#F6C177\"\n              },\n              children: \"'a'\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \":\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"a\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#F6C177\"\n              },\n              children: \" 'b'\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \":\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"b\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"}).\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"render\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#F6C177\"\n              },\n              children: \"\\\"graph\\\"\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"生成的计算图结构\",\n      children: _jsx(_components.a, {\n        href: \"#生成的计算图结构\",\n        children: _jsx(_components.strong, {\n          children: \"生成的计算图结构\"\n        })\n      })\n    }), \"\\n\", _jsx(CodeBlockMermaid, {\n      lang: \"mermaid\",\n      value: \"graph LR\\n  a((a)) --\u003e Mul --\u003e c\\n  b((b)) --\u003e Mul\\n  c --\u003e Sin --\u003e d((d))\\n  d --\u003e Backward\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"五pytorch-反向传播的性能优化\",\n      children: _jsx(_components.a, {\n        href: \"#五pytorch-反向传播的性能优化\",\n        children: _jsx(_components.strong, {\n          children: \"五、PyTorch 反向传播的性能优化\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"1-异步执行\",\n      children: _jsx(_components.a, {\n        href: \"#1-异步执行\",\n        children: _jsx(_components.strong, {\n          children: \"1. 异步执行\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"#\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 使用 CUDA 流实现异步计算\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"with\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"cuda\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"stream\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"cuda\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"Stream\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()):\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"    loss\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 在非默认流中执行反向传播\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"2-混合精度训练\",\n      children: _jsx(_components.a, {\n        href: \"#2-混合精度训练\",\n        children: _jsx(_components.strong, {\n          children: \"2. 混合精度训练\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"scaler \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"cuda\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"amp\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"GradScaler\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"with\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"cuda\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"amp\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"autocast\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"():\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"    output \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" model\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"input\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"    loss \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" loss_fn\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"output\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" target\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: \" \"\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"scaler\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"scale\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"loss\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \").\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 自动缩放梯度\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"scaler\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"step\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"optimizer\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"scaler\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"update\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"3-梯度裁剪\",\n      children: _jsx(_components.a, {\n        href: \"#3-梯度裁剪\",\n        children: _jsx(_components.strong, {\n          children: \"3. 梯度裁剪\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsx(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"torch\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"nn\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"utils\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"clip_grad_norm_\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"model\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"parameters\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(),\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" max_norm\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"1.0\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"六调试技巧\",\n      children: _jsx(_components.a, {\n        href: \"#六调试技巧\",\n        children: _jsx(_components.strong, {\n          children: \"六、调试技巧\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"1-检查梯度是否存在\",\n      children: _jsx(_components.a, {\n        href: \"#1-检查梯度是否存在\",\n        children: _jsx(_components.strong, {\n          children: \"1. 检查梯度是否存在\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsx(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"([\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"p\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"requires_grad \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"for\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" p \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"in\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" model\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"parameters\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()])\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 检查参数是否启用梯度\"\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"2-梯度数值检查\",\n      children: _jsx(_components.a, {\n        href: \"#2-梯度数值检查\",\n        children: _jsx(_components.strong, {\n          children: \"2. 梯度数值检查\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"for\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" name\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \",\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" param \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"in\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" model\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"named_parameters\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"():\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"    if\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" param\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"is\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \" not\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" None\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \":\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"        print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"f\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#F6C177\"\n              },\n              children: \"\\\"\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"{\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"name\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"}\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#F6C177\"\n              },\n              children: \" 梯度均值: \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"{\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"param\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"mean\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"().\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"item\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"}\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#F6C177\"\n              },\n              children: \"\\\"\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"3-保留中间梯度\",\n      children: _jsx(_components.a, {\n        href: \"#3-保留中间梯度\",\n        children: _jsx(_components.strong, {\n          children: \"3. 保留中间梯度\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"python\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"python\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"=\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \" x \"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"*\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" 2\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"retain_grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"  #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 强制保留中间变量的梯度\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"backward\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"()\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#EB6F92\",\n                fontStyle: \"italic\"\n              },\n              children: \"print\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"y\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \".\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#E0DEF4\"\n              },\n              children: \"grad\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"    #\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 可以查看中间梯度\"\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"七底层实现原理\",\n      children: _jsx(_components.a, {\n        href: \"#七底层实现原理\",\n        children: _jsx(_components.strong, {\n          children: \"七、底层实现原理\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"1-c-核心引擎\",\n      children: _jsx(_components.a, {\n        href: \"#1-c-核心引擎\",\n        children: _jsx(_components.strong, {\n          children: \"1. C++ 核心引擎\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PyTorch 的反向传播引擎主要由以下 C++ 组件构成：\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: _jsx(_components.code, {\n            children: \"torch::autograd::Engine\"\n          })\n        }), \"：管理反向传播任务的执行\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: _jsx(_components.code, {\n            children: \"torch::autograd::Node\"\n          })\n        }), \"：表示计算图中的操作节点\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: _jsx(_components.code, {\n            children: \"torch::autograd::Edge\"\n          })\n        }), \"：表示节点之间的连接关系\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"2-反向传播任务调度\",\n      children: _jsx(_components.a, {\n        href: \"#2-反向传播任务调度\",\n        children: _jsx(_components.strong, {\n          children: \"2. 反向传播任务调度\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.figure, {\n      \"data-rehype-pretty-code-figure\": \"\",\n      children: _jsx(_components.pre, {\n        style: {\n          backgroundColor: \"#232136\",\n          color: \"#e0def4\"\n        },\n        tabIndex: \"0\",\n        \"data-language\": \"cpp\",\n        \"data-theme\": \"rose-pine-moon\",\n        children: _jsxs(_components.code, {\n          \"data-language\": \"cpp\",\n          \"data-theme\": \"rose-pine-moon\",\n          style: {\n            display: \"grid\"\n          },\n          children: [_jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"//\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 伪代码：引擎执行流程\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"void\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \" Engine\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"::\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#EA9A97\"\n              },\n              children: \"execute\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"(\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"const\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#9CCFD8\"\n              },\n              children: \" EdgeList\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#3E8FB0\"\n              },\n              children: \"\u0026\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#C4A7E7\",\n                fontStyle: \"italic\"\n              },\n              children: \" roots\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \")\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \" {\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"    //\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 1. 构建任务队列\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"    //\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 2. 使用线程池并行执行反向任务\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"    //\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 3. 处理依赖关系（拓扑排序）\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            \"data-line\": \"\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#908CAA\",\n                fontStyle: \"italic\"\n              },\n              children: \"    //\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#6E6A86\",\n                fontStyle: \"italic\"\n              },\n              children: \" 4. 调用每个 Node 的 apply() 方法\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            \"data-line\": \"\",\n            children: _jsx(_components.span, {\n              style: {\n                color: \"#908CAA\"\n              },\n              children: \"}\"\n            })\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      id: \"八总结pytorch-反向传播的设计哲学\",\n      children: _jsx(_components.a, {\n        href: \"#八总结pytorch-反向传播的设计哲学\",\n        children: _jsx(_components.strong, {\n          children: \"八、总结：PyTorch 反向传播的设计哲学\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"动态计算图\"\n        }), \"：即时构建、即时销毁，灵活适应可变网络结构\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"延迟计算\"\n        }), \"：只在需要时执行梯度计算，优化内存使用\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"分离式设计\"\n        }), \"：前向传播记录操作，反向传播时执行实际计算\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"可扩展性\"\n        }), \"：通过注册自定义 Function 支持任意复杂操作\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"理解这些底层机制，可以帮助开发者：\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"更高效地调试梯度相关问题\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"合理控制内存使用（如使用 \", _jsx(_components.code, {\n          children: \"detach()\"\n        }), \" 截断计算图）\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"实现自定义神经网络层和损失函数\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"优化训练过程的性能\"\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}},"meta":{"content":"\n\u003e 本文为用户与 DeepSeek 的问答。主题为 PyTorch 的反向传播机制。本文从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。\n\n## Q; 深入解析 PyTorch 中的反向传播机制\n\n\u003e query\n\u003e\n\u003e 深入解释 torch 中反向传播机制的数学原理与为何需要反向传播机制。提示：你可以使用公式、Mermaid 图表、表格等方式使内容更容易理解。\n\n\u003e think\n\u003e\n\u003e 嗯，用户让我深入解释PyTorch中的反向传播机制的数学原理以及为什么需要它。好的，我得先回忆一下反向传播的基础知识，然后结合PyTorch的具体实现来展开。\n\u003e\n\u003e 首先，反向传播是神经网络训练的核心，用于计算梯度。用户可能已经了解梯度下降，但需要更底层的数学解释。我应该从计算图开始，因为PyTorch使用动态图机制。每个张量的运算都会记录在计算图中，这样在反向传播时可以自动计算梯度。\n\u003e\n\u003e 数学原理方面，得先讲链式法则。比如，假设有一个简单的函数，y = w*x + b，然后损失函数是L = (y - t)^2。那么求L对w的梯度就需要链式法则：dL/dw = dL/dy * dy/dw。反向传播的过程就是从输出层开始，逐层应用链式法则，将梯度传播回各层的参数。\n\u003e\n\u003e 然后需要解释为什么需要反向传播。手动计算梯度在复杂网络中不现实，反向传播自动高效地计算所有参数的梯度，节省了时间和减少错误。可能还需要比较前向传播和反向传播的计算量，比如反向传播如何复用前向的中间结果，提高效率。\n\u003e\n\u003e PyTorch中的autograd机制是关键。每个Tensor的.grad_fn属性记录了创建它的操作，这样在调用.backward()时，会沿着这些函数形成的计算图反向遍历，应用链式法则。需要举例说明，比如构建一个简单的计算图，然后展示梯度计算的过程。\n\u003e\n\u003e 可能用户对计算图的具体实现细节感兴趣，比如PyTorch的动态图特性，每次前向传播都会构建新的图，这样更灵活。但数学原理还是链式法则，不管图的结构如何变化，梯度计算的方法是一致的。\n\u003e\n\u003e 另外，可能需要提到为什么不能只用数值方法来近似梯度，比如计算资源的问题，尤其是高维参数时，数值梯度计算量太大。而反向传播通过解析法高效计算，适合深度学习的大规模参数。\n\u003e\n\u003e 还要注意解释叶子节点和中间节点的梯度存储情况，PyTorch默认只保留叶子节点的梯度，中间节点的梯度会被释放以节省内存。这可能在训练大模型时很重要，用户可能需要了解如何控制梯度的保留。\n\u003e\n\u003e 或许用户对反向传播的数学推导有更深的需求，比如如何扩展到多层网络，或者如何处理复杂的层结构如卷积层、循环层。但根据问题，可能只需要基础数学，比如链式法则的多次应用，以及如何累积各层的梯度。\n\u003e\n\u003e 最后，总结反向传播的必要性：自动化、高效、准确计算梯度，使得训练深层网络可行。而PyTorch的自动微分机制让用户无需手动实现这些复杂的计算，只需关注模型结构。\n\u003e\n\u003e 可能需要用公式来展示链式法则的应用，比如多层的梯度相乘。例如，一个三层的网络，每一层的权重梯度如何计算。同时，用Mermaid图展示计算图的结构，说明前向和反向的路径。\n\u003e\n\u003e 还有可能要考虑激活函数的导数，比如ReLU在反向传播中的处理，这样在计算图中如何处理不可导点，但PyTorch的autograd会自动处理这些。\n\u003e\n\u003e 总之，我需要从数学原理（链式法则）、计算图的概念、PyTorch的实现机制（动态图、autograd）、以及反向传播的必要性（高效、自动）这几个方面来组织内容，并用公式和图表辅助说明。\n\u003e\n\u003e 最后，我需要用一个具体的例子，比如一个简单的神经网络，来展示反向传播的整个过程，包括前向传播、反向传播、梯度计算和参数更新。这样用户可以直观地理解反向传播的每个步骤。\n\u003e\n\u003e 如果用户对PyTorch的代码实现感兴趣，我也可以提供一些关键代码段的解析，比如如何定义计算图、如何跟踪梯度、如何执行反向传播等。\n\u003e\n\u003e 总之，我需要确保解释清晰，结合数学原理和代码示例，帮助用户理解PyTorch中的反向传播机制。\n\n### 深入解析 PyTorch 中的反向传播机制\n\n反向传播（Backpropagation）是神经网络训练的核心算法。本文将从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。\n\n---\n\n#### 一、反向传播的数学原理\n\n##### 1. 链式法则（Chain Rule）\n反向传播本质上是链式法则的高效实现。假设神经网络的计算流程为：\n\n$$\nL = f(g(h(x)))\n$$\n\n其中：\n- $$ h(x) = W_1x + b_1 $$\n- $$ g(z) = \\text{ReLU}(z) $$\n- $$ f(y) = \\frac{1}{2}(y - t)^2 $$ （均方误差损失）\n\n则梯度计算为：\n$$\n\\frac{\\partial L}{\\partial W_1} = \\frac{\\partial L}{\\partial f} \\cdot \\frac{\\partial f}{\\partial g} \\cdot \\frac{\\partial g}{\\partial h} \\cdot \\frac{\\partial h}{\\partial W_1}\n$$\n\n##### 2. 梯度累积公式\n对于任意参数 $$ \\theta $$，梯度计算可表示为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta} = \\sum_{\\text{path } \\theta \\to \\mathcal{L}} \\left( \\prod_{i} \\frac{\\partial \\text{op}_i}{\\partial \\text{input}_i} \\right)\n$$\n\n---\n\n#### 二、PyTorch 的实现机制\n\n##### 1. 动态计算图（Dynamic Computation Graph）\nPyTorch 在前向传播时自动构建计算图，节点为张量，边为运算操作：\n\n```mermaid\ngraph LR\n  x((x)) --\u003e MatMul --\u003e h((h))\n  W1((W1)) --\u003e MatMul\n  b1((b1)) --\u003e Add --\u003e z((z))\n  h --\u003e Add\n  z --\u003e ReLU --\u003e y((y))\n  y --\u003e MSE --\u003e Loss((Loss))\n```\n\n##### 2. Autograd 核心组件\n| 组件                   | 作用                                     |\n| ---------------------- | ---------------------------------------- |\n| `Tensor.requires_grad` | 标记需要跟踪梯度的张量                   |\n| `Tensor.grad_fn`       | 记录创建该张量的操作（如 `MulBackward`） |\n| `Tensor.grad`          | 存储计算得到的梯度                       |\n\n##### 3. 反向传播过程\n```python\nimport torch\n\nx = torch.tensor([2.0], requires_grad=True)\nW = torch.tensor([3.0], requires_grad=True)\ny = W * x\ny.backward()\n\nprint(W.grad)  # 输出: tensor([2.])\nprint(x.grad)  # 输出: tensor([3.])\n```\n\n---\n\n#### 三、为何需要反向传播？\n\n##### 1. 手动计算不可行性\n对于包含百万参数的现代神经网络，手动计算梯度的时间复杂度为 $$ O(n^2) $$ ，而反向传播只需 $$ O(n) $$ 。\n\n##### 2. 计算效率对比\n| 方法                 | 时间复杂度   | 空间复杂度 | 数值稳定性 |\n| -------------------- | ------------ | ---------- | ---------- |\n| 数值微分             | $$ O(n^2) $$ | $$ O(1) $$ | 差         |\n| 符号微分             | $$ O(1) $$   | $$ O(n) $$ | 好         |\n| 自动微分（反向传播） | $$ O(n) $$   | $$ O(n) $$ | 优秀       |\n\n##### 3. 内存优化策略\nPyTorch 采用以下技术降低内存占用：\n- **梯度检查点**：只保留关键节点的中间结果\n- **即时释放中间梯度**：默认只保留叶子节点的梯度\n\n---\n\n#### 四、反向传播的数学扩展\n\n##### 1. 矩阵求导示例\n对于全连接层 $$ Y = XW + b $$ ，梯度计算为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial W} = X^T \\cdot \\frac{\\partial \\mathcal{L}}{\\partial Y}\n$$\n\n##### 2. 复杂运算处理\n```python\n# PyTorch 自动处理不可导点\nx = torch.tensor([-1.0, 0.0, 2.0], requires_grad=True)\ny = torch.relu(x)\ny.backward(torch.tensor([1.0, 1.0, 1.0]))\nprint(x.grad)  # 输出: tensor([0., 0., 1.])\n```\n\n---\n\n#### 五、总结\n\n**反向传播的必要性**：\n1. **自动微分**：避免手工推导复杂导数\n2. **计算高效**：利用链式法则的分解特性\n3. **内存优化**：动态图的即时构建与销毁\n4. **框架支撑**：支持任意复杂网络结构\n\nPyTorch 通过动态计算图和 Autograd 系统，将反向传播的数学原理高效实现，使得深度学习模型的训练变得可行且高效。理解这一机制对于调试模型、优化内存使用和实现自定义算子至关重要。\n\n## Q: 参数的梯度累加计算公式\n\n\u003e query\n\u003e\n\u003e 你提到对于任意参数 $$ \\theta $$，梯度计算可表示为：\n\u003e $$\n\u003e \\frac{\\partial \\mathcal{L}}{\\partial \\theta} = \\sum_{\\text{path } \\theta \\to \\mathcal{L}} \\left( \\prod_{i} \\frac{\\partial \\text{op}_i}{\\partial \\text{input}_i} \\right)\n\u003e $$\n\u003e 这个公式我没懂，再深入解释一下。我只有本科程度的高等数学知识与线性代数知识，建议一步一步解释推理过程。\n\n\u003e think\n\u003e\n\u003e 嗯，用户问的是关于反向传播中梯度计算的公式，那个公式看起来有点复杂，对吧？让我先仔细看看用户的问题。他提到，对于任意参数θ，梯度计算是路径θ到L的和，每个路径中的各个操作的导数相乘。用户本科数学和线性代数基础，可能需要更基础的解释。\n\u003e\n\u003e 首先，我需要确认用户对这个公式的理解程度。公式里的求和符号和路径可能让他困惑。可能用户对链式法则有一定的了解，但路径的概念不太清楚。比如，在计算图中，参数θ到损失L可能有多个不同的路径，每个路径对应一个梯度贡献，所以梯度是这些路径贡献的总和。\n\u003e\n\u003e 接下来，我需要用更简单的方式来解释这个公式。或许用一个具体的例子来说明会更好。比如，假设有一个简单的计算图，其中θ分两个路径影响L，每个路径都需要计算导数的乘积，然后将它们相加。\n\u003e\n\u003e 然后，我应该分步骤解释链式法则，以及为什么需要将不同路径的梯度相加。可能需要用图示来辅助，比如画一个简单的计算图，展示多个分支的情况，每个分支对应一个乘积项，最后相加得到总的梯度。\n\u003e\n\u003e 另外，用户可能对“路径”这个词不太理解，需要明确在计算图中的路径指的是什么。例如，一个参数可能在多个层中使用，每次使用都会创建一个不同的路径到损失函数，因此每个路径的梯度都需要被计算并累加。\n\u003e\n\u003e 还要注意，用户可能对乘积的部分有疑问，为什么是各个操作的导数相乘。这时候需要回顾链式法则的基本原理，即复合函数求导时，外层函数的导数和内层函数的导数相乘，而如果有多个中间步骤，就需要连乘这些导数。\n\u003e\n\u003e 可能还需要解释为什么会有多个路径，例如在神经网络中，一个参数可能在多个神经元中被使用，或者在不同的时间步（如RNN中），导致梯度需要从各个路径反向传播回来，然后累加起来。\n\u003e\n\u003e 最后，通过一个具体的数学例子，逐步计算每个步骤的导数，并将它们相乘，最后相加，来验证这个公式的正确性。这样用户可以通过实际的计算过程理解抽象的公式。\n\u003e\n\u003e 总结一下，我需要用具体的例子、图示，分步骤解释链式法则在计算图中的多个路径中的应用，以及梯度累加的原因，帮助用户理解这个公式的含义和推导过程。\n\n好的！我将用最直观的方式，通过一个具体例子逐步解释这个公式的数学原理。我们结合图示和分步推导来理解链式法则在反向传播中的应用。\n\n---\n\n### **一、问题场景设定**\n假设我们有一个简单的计算图，其中参数 $$\\theta$$ 通过两条路径影响最终损失 $$L$$ ：\n```mermaid\ngraph LR\n    θ((θ)) --\u003e Op1 --\u003e A\n    θ --\u003e Op2 --\u003e B\n    A --\u003e Op3 --\u003e L\n    B --\u003e Op3 --\u003e L\n```\n- **路径1**：$$\\theta \\xrightarrow{\\text{Op1}} A \\xrightarrow{\\text{Op3}} L$$\n- **路径2**：$$\\theta \\xrightarrow{\\text{Op2}} B \\xrightarrow{\\text{Op3}} L$$\n\n目标是计算 $$\\frac{\\partial L}{\\partial \\theta}$$。\n\n---\n\n### **二、分步推导**\n\n#### **步骤1：前向传播表达式**\n假设具体操作为：\n- $$A = \\theta^2$$ （Op1：平方操作）\n- $$B = 2\\theta$$ （Op2：线性操作）\n- $$L = A + B$$ （Op3：加法操作）\n\n则最终损失为：\n$$\nL = \\theta^2 + 2\\theta\n$$\n\n#### **步骤2：直接求导（对比验证）**\n直接对 $$L$$ 求导：\n$$\n\\frac{\\partial L}{\\partial \\theta} = 2\\theta + 2\n$$\n\n---\n\n#### **步骤3：反向传播视角**\n根据计算图，梯度需要沿着两条路径反向传播：\n\n##### **路径1的梯度计算（θ → A → L）**\n1. $$A = \\theta^2 \\quad \\Rightarrow \\quad \\frac{\\partial A}{\\partial \\theta} = 2\\theta$$\n2. $$L = A + B \\quad \\Rightarrow \\quad \\frac{\\partial L}{\\partial A} = 1$$\n3. 路径1的梯度贡献：\n$$\n\\frac{\\partial L}{\\partial \\theta} \\bigg|_{\\text{路径1}} = \\frac{\\partial L}{\\partial A} \\cdot \\frac{\\partial A}{\\partial \\theta} = 1 \\cdot 2\\theta = 2\\theta\n$$\n\n##### **路径2的梯度计算（θ → B → L）**\n1. $$B = 2\\theta \\quad \\Rightarrow \\quad \\frac{\\partial B}{\\partial \\theta} = 2$$\n2. $$L = A + B \\quad \\Rightarrow \\quad \\frac{\\partial L}{\\partial B} = 1$$\n3. 路径2的梯度贡献：\n$$\n\\frac{\\partial L}{\\partial \\theta} \\bigg|_{\\text{路径2}} = \\frac{\\partial L}{\\partial B} \\cdot \\frac{\\partial B}{\\partial \\theta} = 1 \\cdot 2 = 2\n$$\n\n##### **总梯度 = 路径1 + 路径2**\n$$\n\\frac{\\partial L}{\\partial \\theta} = 2\\theta + 2\n$$\n\n---\n\n### **三、通用公式解析**\n原公式：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta} = \\sum_{\\text{path } \\theta \\to \\mathcal{L}} \\left( \\prod_{i} \\frac{\\partial \\text{op}_i}{\\partial \\text{input}_i} \\right)\n$$\n\n#### **1. 符号解释**\n- **路径（Path）**：参数 $$\\theta$$ 到损失 $$\\mathcal{L}$$ 的所有可能数据流动路径。\n- **乘积项 $$\\prod$$**：沿某条路径的所有操作（op）的导数连乘（链式法则）。\n- **求和项 $$\\sum$$**：将所有路径的梯度贡献相加（多路径时梯度累加）。\n\n#### **2. 关键性质**\n- **链式法则**：复合函数的导数 = 外层导数 × 内层导数。\n- **多路径叠加**：如果参数影响输出的多个分支，梯度是各分支贡献的总和。\n\n---\n\n### **四、复杂案例验证**\n考虑一个更复杂的计算图：\n```mermaid\ngraph LR\n    θ((θ)) --\u003e Op1 --\u003e C\n    θ --\u003e Op2 --\u003e D\n    C --\u003e Op3 --\u003e E\n    D --\u003e Op4 --\u003e E\n    E --\u003e Op5 --\u003e L\n```\n\n#### **前向传播表达式**\n- $$C = \\theta^3$$（Op1）\n- $$D = \\sin(\\theta)$$（Op2）\n- $$E = C \\cdot D$$（Op3）\n- $$L = \\ln(E)$$（Op4）\n\n#### **反向传播计算**\n##### **路径1：θ → C → E → L**\n$$\n\\frac{\\partial L}{\\partial \\theta} \\bigg|_{\\text{路径1}} = \\frac{\\partial L}{\\partial E} \\cdot \\frac{\\partial E}{\\partial C} \\cdot \\frac{\\partial C}{\\partial \\theta} = \\frac{1}{E} \\cdot D \\cdot 3\\theta^2\n$$\n\n##### **路径2：θ → D → E → L**\n$$\n\\frac{\\partial L}{\\partial \\theta} \\bigg|_{\\text{路径2}} = \\frac{\\partial L}{\\partial E} \\cdot \\frac{\\partial E}{\\partial D} \\cdot \\frac{\\partial D}{\\partial \\theta} = \\frac{1}{E} \\cdot C \\cdot \\cos(\\theta)\n$$\n\n##### **总梯度**\n$$\n\\frac{\\partial L}{\\partial \\theta} = \\frac{D \\cdot 3\\theta^2 + C \\cdot \\cos(\\theta)}{E}\n$$\n\n---\n\n### **五、反向传播的本质**\n1. **自动化的链式法则**：框架通过计算图自动追踪操作路径。\n2. **梯度累加规则**：当一个参数影响多个分支时，梯度是所有路径贡献的总和。\n3. **计算效率**：避免重复计算，时间复杂度与网络深度成线性关系（$$O(n)$$）。\n\n---\n\n### **六、总结**\n- **为什么需要求和（$$\\sum$$）**：因为参数可能通过多个路径影响损失，每个路径贡献一部分梯度。\n- **为什么需要连乘（$$\\prod$$）**：链式法则要求将路径上的所有局部导数相乘。\n- **反向传播的优势**：将复杂的全局求导分解为局部导数的连乘与路径求和，大幅降低计算复杂度。\n\n通过这种分路径计算再累加的方式，反向传播巧妙地利用计算图的结构信息，实现了高效的梯度计算。\n\n## Q: 从 PyTorch 代码层面深入解释一下 PyTorch 的反向传播如何实现\n\n\u003e query\n\u003e\n\u003e 从 PyTorch 代码层面深入解释一下 PyTorch 的反向传播如何实现\n\n\u003e think\n\u003e\n\u003e 嗯，用户之前已经了解了反向传播的数学原理和为什么需要它，现在他们想从PyTorch代码层面深入理解反向传播的实现。用户可能有一定的编程基础，但可能对PyTorch的内部机制不太熟悉。我需要确保解释清晰，结合代码示例，同时避免过于复杂的术语。\n\u003e\n\u003e 首先，用户提到了之前的公式，关于梯度的路径求和，现在需要将这一数学概念与PyTorch的具体实现联系起来。他们可能想知道PyTorch是如何动态构建计算图的，如何跟踪梯度，以及backward()方法具体做了什么。\n\u003e\n\u003e 接下来，我应该分步骤解释PyTorch的关键组件，比如Tensor的requires_grad属性、grad_fn、grad属性，以及动态计算图的构建过程。需要举例说明，比如一个简单的计算图，并展示梯度是如何累积的。同时，用户可能对梯度累积和内存管理感兴趣，比如PyTorch如何释放中间变量，如何通过retain_grad()来保留梯度。\n\u003e\n\u003e 另外，用户可能对多路径梯度累加的情况有疑问，比如当多个操作影响同一个参数时，梯度是如何相加的。这时候需要举例说明，比如一个参数通过两条路径影响损失函数，PyTorch如何处理这种情况。\n\u003e\n\u003e 还需要提到Autograd引擎的工作原理，比如如何遍历计算图，执行反向传播，以及如何优化计算效率。可能还需要讨论一些高级话题，比如detach()的作用，或者如何自定义反向传播函数，但根据用户的知识水平，可能需要保持基础。\n\u003e\n\u003e 用户可能存在的误区是认为PyTorch会保存所有中间变量的梯度，但实际上默认只保留叶子节点的梯度。这需要特别说明，并解释如何通过retain_grad()来查看中间节点的梯度。\n\u003e\n\u003e 最后，应该总结PyTorch反向传播的关键点，强调其动态计算图的优势，以及如何高效管理内存和计算资源。确保用户理解为什么PyTorch适合动态图模型，以及在实际调试中如何利用这些机制。\n\n以下是关于 PyTorch 反向传播实现机制的代码级深入解析，结合关键代码段和底层原理说明：\n\n---\n\n### **一、PyTorch 反向传播的三大核心组件**\n\n#### **1. Tensor 的梯度追踪机制**\n```python\nimport torch\n\n# 创建需要梯度追踪的张量\nx = torch.tensor([2.0], requires_grad=True)  # 叶子节点\nW = torch.tensor([3.0], requires_grad=True)  # 叶子节点\n\n# 执行计算（自动记录操作）\ny = W * x           # grad_fn=\u003cMulBackward0\u003e\nz = y + 1           # grad_fn=\u003cAddBackward0\u003e\nloss = z.mean()      # grad_fn=\u003cMeanBackward0\u003e\n\nprint(loss.grad_fn)  # 输出: \u003cMeanBackward0 object\u003e\n```\n- **`requires_grad=True`**：标记需要追踪梯度的张量（叶子节点）\n- **`grad_fn`**：记录创建该张量的操作（反向传播时知道如何计算梯度）\n\n#### **2. 计算图的动态构建**\nPyTorch 的计算图是**动态构建的**，每次前向传播都会新建一个图：\n```python\n# 示例：动态图特性\ndef forward(x):\n    if x.sum() \u003e 0:\n        return x * 2\n    else:\n        return x * (-1)\n\nx = torch.tensor([3.0], requires_grad=True)\nout = forward(x)  # 根据输入值动态创建不同的计算图\nout.backward()    # 自动适应不同的分支路径\n```\n\n#### **3. 反向传播引擎（Autograd Engine）**\n当调用 `.backward()` 时，PyTorch 会执行以下操作：\n```python\nloss.backward()  # 触发反向传播\n```\n- **反向遍历计算图**：从 `loss` 的 `grad_fn` 开始，沿着 `next_functions` 递归\n- **计算局部梯度**：在每个操作节点调用已注册的 `backward()` 方法\n- **梯度累加**：将计算结果累积到对应张量的 `.grad` 属性中\n\n---\n\n### **二、代码级反向传播流程分解**\n\n#### **步骤1：前向传播构建计算图**\n```python\na = torch.tensor(2.0, requires_grad=True)\nb = torch.tensor(3.0, requires_grad=True)\nc = a * b      # grad_fn=\u003cMulBackward0\u003e\nd = c + 1      # grad_fn=\u003cAddBackward0\u003e\nloss = d**2    # grad_fn=\u003cPowBackward0\u003e\n```\n此时的计算图结构：\n```mermaid\ngraph LR\n  a --\u003e Mul --\u003e c\n  b --\u003e Mul\n  c --\u003e Add --\u003e d\n  d --\u003e Pow --\u003e loss\n```\n\n#### **步骤2：执行反向传播**\n```python\nloss.backward()  # 触发反向传播\n```\n\n##### **底层操作分解**：\n1. **初始化梯度**：设置 `loss.grad = 1.0`（标量损失的默认梯度）\n2. **反向传播到 d**：\n   - 调用 `PowBackward0` 的 `backward()` 方法：\n     ```python\n     d_grad = 2 * d  # 导数公式：d(loss)/d(d) = 2d\n     ```\n3. **反向传播到 c**：\n   - 调用 `AddBackward0` 的 `backward()` 方法：\n     ```python\n     c_grad = d_grad * 1  # 加法操作的导数为1\n     ```\n4. **反向传播到 a 和 b**：\n   - 调用 `MulBackward0` 的 `backward()` 方法：\n     ```python\n     a_grad = c_grad * b  # 导数公式：d(c)/d(a) = b\n     b_grad = c_grad * a  # 导数公式：d(c)/d(b) = a\n     ```\n5. **梯度累加**：\n   ```python\n   a.grad += a_grad  # 实际为 in-place 操作\n   b.grad += b_grad\n   ```\n\n#### **步骤3：查看结果**\n```python\nprint(a.grad)  # 输出: 2*d* b = 2*(2*3+1)*3 = 42\nprint(b.grad)  # 输出: 2*d* a = 2*(2*3+1)*2 = 28\n```\n\n---\n\n### **三、PyTorch 反向传播的关键实现细节**\n\n#### **1. 梯度计算规则注册**\n每个 `torch` 操作都有预定义的梯度计算规则：\n```python\n# 示例：自定义操作的梯度规则\nclass MyAdd(torch.autograd.Function):\n    @staticmethod\n    def forward(ctx, x, y):\n        ctx.save_for_backward(x, y)  # 保存前向传播的输入\n        return x + y\n\n    @staticmethod\n    def backward(ctx, grad_output):\n        x, y = ctx.saved_tensors\n        return grad_output * 1, grad_output * 1  # 加法操作的导数\n\n# 使用自定义操作\na = torch.tensor(2.0, requires_grad=True)\nb = torch.tensor(3.0, requires_grad=True)\nc = MyAdd.apply(a, b)\nc.backward()\n```\n\n#### **2. 梯度累加机制**\nPyTorch 默认会**累加梯度**，因此每次反向传播前需要手动清零：\n```python\noptimizer.zero_grad()  # 标准训练循环中的必要操作\nloss.backward()        # 梯度会累加到 .grad 属性中\noptimizer.step()\n```\n\n#### **3. 非标量张量的反向传播**\n当输出为非标量时，需要提供 `gradient` 参数：\n```python\nx = torch.tensor([1.0, 2.0], requires_grad=True)\ny = x * 2\n\n# 假设 y 是向量，需要提供梯度初始值\ny.backward(gradient=torch.tensor([0.1, 0.2]))  \nprint(x.grad)  # 输出: tensor([0.2, 0.4])\n```\n\n#### **4. 内存优化策略**\n- **中间变量释放**：默认只保留叶子节点的梯度\n- **梯度检查点**：通过 `torch.utils.checkpoint` 减少内存占用\n- **禁用梯度计算**：使用 `with torch.no_grad():` 或 `@torch.inference_mode()`\n\n---\n\n### **四、可视化反向传播过程**\n\n#### **示例代码**\n```python\nimport torchviz\n\na = torch.tensor(3.0, requires_grad=True)\nb = torch.tensor(4.0, requires_grad=True)\nc = a * b\nd = c.sin()\nd.backward()\n\n# 生成计算图可视化\ntorchviz.make_dot(d, params={'a':a, 'b':b}).render(\"graph\")\n```\n\n#### **生成的计算图结构**\n```mermaid\ngraph LR\n  a((a)) --\u003e Mul --\u003e c\n  b((b)) --\u003e Mul\n  c --\u003e Sin --\u003e d((d))\n  d --\u003e Backward\n```\n\n---\n\n### **五、PyTorch 反向传播的性能优化**\n\n#### **1. 异步执行**\n```python\n# 使用 CUDA 流实现异步计算\nwith torch.cuda.stream(torch.cuda.Stream()):\n    loss.backward()  # 在非默认流中执行反向传播\n```\n\n#### **2. 混合精度训练**\n```python\nscaler = torch.cuda.amp.GradScaler()\n\nwith torch.cuda.amp.autocast():\n    output = model(input)\n    loss = loss_fn(output, target)\n\nscaler.scale(loss).backward()  # 自动缩放梯度\nscaler.step(optimizer)\nscaler.update()\n```\n\n#### **3. 梯度裁剪**\n```python\ntorch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=1.0)\n```\n\n---\n\n### **六、调试技巧**\n\n#### **1. 检查梯度是否存在**\n```python\nprint([p.requires_grad for p in model.parameters()])  # 检查参数是否启用梯度\n```\n\n#### **2. 梯度数值检查**\n```python\nfor name, param in model.named_parameters():\n    if param.grad is not None:\n        print(f\"{name} 梯度均值: {param.grad.mean().item()}\")\n```\n\n#### **3. 保留中间梯度**\n```python\ny = x * 2\ny.retain_grad()  # 强制保留中间变量的梯度\ny.backward()\nprint(y.grad)    # 可以查看中间梯度\n```\n\n---\n\n### **七、底层实现原理**\n\n#### **1. C++ 核心引擎**\nPyTorch 的反向传播引擎主要由以下 C++ 组件构成：\n- **`torch::autograd::Engine`**：管理反向传播任务的执行\n- **`torch::autograd::Node`**：表示计算图中的操作节点\n- **`torch::autograd::Edge`**：表示节点之间的连接关系\n\n#### **2. 反向传播任务调度**\n```cpp\n// 伪代码：引擎执行流程\nvoid Engine::execute(const EdgeList\u0026 roots) {\n    // 1. 构建任务队列\n    // 2. 使用线程池并行执行反向任务\n    // 3. 处理依赖关系（拓扑排序）\n    // 4. 调用每个 Node 的 apply() 方法\n}\n```\n\n---\n\n### **八、总结：PyTorch 反向传播的设计哲学**\n\n1. **动态计算图**：即时构建、即时销毁，灵活适应可变网络结构  \n2. **延迟计算**：只在需要时执行梯度计算，优化内存使用  \n3. **分离式设计**：前向传播记录操作，反向传播时执行实际计算  \n4. **可扩展性**：通过注册自定义 Function 支持任意复杂操作  \n\n理解这些底层机制，可以帮助开发者：\n- 更高效地调试梯度相关问题\n- 合理控制内存使用（如使用 `detach()` 截断计算图）\n- 实现自定义神经网络层和损失函数\n- 优化训练过程的性能\n\n\n","title":"PyTorch 自动微分与反向传播机制原理解析","abstract":"\u003e 本文为用户与 DeepSeek 的问答。主题为 PyTorch 的反向传播机制。本文从数学原理、计算图机制和实际需求三个方面深入解释其工作原理，并结合 PyTorch 的自动微分（Autograd）系统进行说明。\n\u003e query\n\u003e","length":618,"created_at":"2025-03-06T15:50:00.000Z","updated_at":"2025-03-06T15:50:00.000Z","tags":["PyTorch","深度学习","反向传播","自动微分","学习笔记"],"license":true},"prevNextInfo":{"prevInfo":null,"nextInfo":{"pathMapping":{"filePath":"public/content/learn_from_ai/2025-03-05-lora-matrix-initialization-strategy.md","pagePath":"/learn_from_ai/lora-matrix-initialization-strategy","slug":"lora-matrix-initialization-strategy"},"meta":{"content":"\n\u003e 本文是与 Deepseek-R1 模型+Search 的对话记录，详细探讨了 LoRA（低秩适应）微调技术中矩阵初始化策略的数学原理。文章分析了为什么在 LoRA 中矩阵 A 采用随机初始化而矩阵 B 采用零初始化的原因，包括保持初始模型稳定性、确保梯度更新有效性、实现逐步学习的低秩更新等方面。同时，文章也解释了为什么反向初始化策略（B随机而A为零）在理论上存在问题，会导致梯度消失和训练效率下降。这些分析有助于理解深度学习中参数高效微调技术的设计原理。\n\n## Q: 初始化 LoRA 时，为什么 A 矩阵是随机初始化而 B 矩阵是 0 初始化？\n\n\u003e 嗯，这个问题是关于LoRA（低秩适应）初始化的。为什么在初始化的时候，矩阵A是随机初始化的，而矩阵B是零初始化的呢？我需要仔细思考一下。\n\u003e\n\u003e 首先，我应该回忆一下LoRA的基本原理。LoRA是一种用于微调大型预训练模型的技术，它通过低秩分解来减少可训练参数的数量。具体来说，对于预训练模型中的某个权重矩阵W，LoRA引入两个较小的矩阵A和B，使得原来的权重更新ΔW可以表示为BA。这样，训练的时候只需要更新A和B，而不是整个W，从而节省了计算资源和内存。\n\u003e\n\u003e 那问题来了，为什么初始化的时候，A是随机的，而B是零呢？可能的解释是，这样初始化后，初始的ΔW（即BA）是零矩阵，这样在训练开始时，模型的行为和原始预训练模型保持一致，不会因为随机初始化带来大的扰动。因为如果B初始化为零，无论A是什么，BA都是零，所以ΔW初始为零，这样模型的初始输出不会改变，保证了训练的稳定性。\n\u003e\n\u003e 不过，这里可能有一个疑问：如果B初始化为零，那么在训练过程中，梯度是如何更新的呢？因为如果B一开始是零，那么在第一次反向传播时，B的梯度可能依赖于A的值。而A是随机初始化的，所以可能梯度会有变化。不过，因为A是随机的，初始的BA是零，这样在第一次前向传播时，ΔW不影响原始权重，因此损失函数和原始模型一样，梯度可能从误差信号开始累积，逐步调整A和B的参数。\n\u003e\n\u003e 另外，可能还有参数更新的考虑。例如，如果A是随机初始化，B初始化为零，那么在训练开始时，参数的变化从零开始逐步增加，这类似于残差连接的思想，即初始时没有改变，然后逐渐学习调整。这有助于训练的稳定性，避免了初始阶段的大幅度波动。\n\u003e\n\u003e 再想一下，如果反过来，把A初始化为零，B随机初始化，那么ΔW一开始就是零，因为A是零，这样可能无法有效训练，因为无论B如何变化，如果A是零的话，ΔW始终是零，除非A被更新。但通常来说，参数需要一定的随机性来打破对称性，使得梯度可以有效地更新不同的参数。所以可能如果A初始化为零，那么后续的更新可能会遇到问题，因为梯度可能需要同时更新A和B才能有效，而初始时A的梯度可能很小，导致训练缓慢。因此，将A随机初始化，B初始化为零，可以确保初始的ΔW为零，同时A的随机性允许梯度在反向传播时有效地更新参数，而不会导致初始阶段的大偏差。\n\u003e\n\u003e 总结一下，可能的原因包括：\n\u003e\n\u003e 1. 保持初始ΔW为零，使得模型开始训练时和原始预训练模型一致，训练稳定性。\n\u003e\n\u003e 2. 随机初始化A可以打破对称性，允许梯度有效更新参数，而B初始化为零则保证初始时没有改变权重，这样训练可以逐步进行。\n\u003e\n\u003e 3. 如果B初始化为非零，可能会导致初始ΔW不为零，从而引入不必要的噪声，影响训练初始阶段的稳定性。\n\u003e\n\u003e 可能还有其他原因，比如优化器的动态特性。比如，如果使用Adam这样的优化器，参数的初始步长可能会根据梯度的历史进行调整。如果B初始化为零，那么在最初的几次迭代中，B的梯度可能会较小，从而调整其学习率，而A的随机初始化可能有助于梯度方向的多样性，促进有效的参数更新。\n\u003e\n\u003e 另外，还需要考虑矩阵乘法的顺序。在LoRA中，ΔW = B*A，假设A的维度是d×r，B的维度是r×d，那么BA的乘积是d×d的矩阵，与原权重矩阵W的大小相同。当B初始化为零时，无论A的值如何，ΔW都是零，这样初始的模型输出不会改变。然后，在训练过程中，通过调整B和A来逐渐学习ΔW。这可能比同时随机初始化两者更稳定，因为如果两者都随机初始化，ΔW可能会有一个较大的初始值，影响模型的初始表现。\n\u003e\n\u003e 例如，假设A和B都是随机高斯初始化，均值为0，标准差为σ。那么BA的元素将是两个独立高斯变量的乘积之和，这可能会有较大的方差，导致ΔW的初始值较大，可能干扰预训练模型的原始权重，导致训练初期的不稳定。而将B初始化为零，则避免了这个问题，因为初始时ΔW为零，之后随着训练逐渐调整，这样更安全。\n\u003e\n\u003e 此外，这种初始化方式可能类似于残差网络中的残差块初始化，将残差路径初始化为零，使得初始阶段网络主要依赖原始路径，然后逐步学习残差调整。类似的思路可能被应用到了LoRA中，即初始时不改变原模型，逐步进行低秩调整。\n\u003e\n\u003e 还有一个角度是参数的梯度计算。当B初始化为零时，第一次前向传播中，BA为零，因此在反向传播时，损失函数对B的梯度将依赖于A的值。由于A是随机初始化的，这样B的梯度会有一定的方向性，从而允许B被有效地更新。相反，如果A初始化为零，那么B的梯度也会是零，导致无法更新参数。因此，必须将A随机初始化，以便在第一次反向传播时，B能够获得有效的梯度。\n\u003e\n\u003e 例如，假设损失函数L对B的梯度是∂L/∂B = (∂L/∂(BA)) * A^T。如果A初始化为零，那么梯度∂L/∂B也为零，导致B无法被更新。而如果A是随机初始化的，则梯度不为零，允许B被更新。同时，B初始化为零，那么在第一次更新时，B的值会根据梯度调整，而A也会根据梯度进行更新。这样，两者可以协同工作，逐渐构建出有效的低秩更新矩阵。\n\u003e\n\u003e 因此，总结可能的原因：\n\u003e\n\u003e - 保持初始ΔW为零，维持预训练模型的初始表现，保证训练稳定性。\n\u003e\n\u003e - 随机初始化A打破对称性，允许梯度有效更新B的参数。\n\u003e\n\u003e - 避免初始ΔW的随机性带来的干扰，只通过训练过程逐步调整。\n\u003e\n\u003e - 如果A初始化为非零而B为零，这样BA为零，同时允许梯度在反向传播时有效传递到B，从而启动训练过程。\n\u003e\n\u003e 可能还有其他因素，比如实现上的简便性，或者实验验证过这种初始化方式的效果更好。但核心的数学和优化原因应该是上述几点。\n\n在初始化LoRA（低秩适应）时，矩阵A采用随机初始化而矩阵B初始化为零，主要原因如下：\n\n1. **保持初始模型稳定性**：  \n   当B初始化为零时，无论A的值如何，低秩更新矩阵ΔW = BA初始值为零。这使得微调开始时，模型的输出与原始预训练模型完全一致，避免了初始阶段因随机扰动导致的性能波动，确保了训练的稳定性。\n\n2. **梯度更新的有效性**：  \n   随机初始化A能够打破对称性，使得反向传播时B的梯度依赖于A的随机初始值（∂L/∂B = (∂L/∂ΔW) · Aᵀ）。若A初始化为零，B的梯度将为零，导致训练无法启动；而随机A为非零，使得B的梯度在第一次更新时即可有效调整。\n\n3. **逐步学习低秩更新**：  \n   通过B初始为零，ΔW从零开始逐步积累更新量，类似于残差学习的思想。这种策略让模型优先依赖预训练权重，再逐渐学习低秩调整，避免了初始较大的随机ΔW对预训练知识的干扰。\n\n4. **优化动态的合理性**：  \n   若A和B均随机初始化，ΔW的初始值可能具有较大的方差，引入不必要的噪声。而B初始为零时，ΔW的初始方差为零，训练过程中通过协同优化A和B逐步引入更新，更符合低秩适应的设计目标。\n\n综上，这种初始化方式在数学上确保了训练的高效启动，同时在工程实践中提升了微调的稳定性和效果。\n\n## Q: B矩阵随机初始化而A矩阵初始化时设为 0 不行吗？\n\n\u003e 好的，用户问如果B矩阵随机初始化而A矩阵初始化为0行不行。我需要仔细分析这个问题。首先，回想一下之前的对话，用户已经了解了LoRA初始化时A随机，B为0的原因。现在他想反过来，可能是在思考是否有其他可能性。\n\u003e\n\u003e 我需要从原理出发，考虑这种初始化方式对训练的影响。如果A初始化为0，那么ΔW = BA就会变成B乘以0矩阵，也就是全0。这样在训练开始时，微调的模块不会对原模型产生影响，和之前的情况类似。但是这里的关键是梯度如何传播。\n\u003e\n\u003e 根据链式法则，梯度会从损失函数传到ΔW，然后分解到B和A。对于A的梯度是B的转置乘以ΔW的梯度，而B的梯度是ΔW的梯度乘以A的转置。如果A初始为0，那么在第一次反向传播时，B的梯度会是ΔW的梯度乘以0矩阵，导致B的梯度为0。这时候B无法被更新，整个训练就卡住了。\n\u003e\n\u003e 另外，A的参数如果初始为0，在第一次前向时，ΔW是0，所以没问题。但是第一次反向传播时，A的梯度是B转置乘以ΔW的梯度。如果B是随机初始化的，这时候A的梯度可能会有值，可以更新A。但问题在于，当A被更新后，下一次前向时ΔW = B*A会有变化。但这里可能有一个顺序问题，比如第一次迭代时A是0，导致ΔW为0，B的梯度无法更新，而A的梯度可能有效，但之后A被更新后，B才会有机会更新。这时候是否会导致训练不稳定？\n\u003e\n\u003e 可能需要更仔细地分析梯度流。假设A初始为0，B随机。第一次前向时，ΔW=0，不影响模型输出。反向传播时，计算梯度，对A的梯度是∂L/∂A = B^T * ∂L/∂ΔW。而B的梯度是∂L/∂B = ∂L/∂ΔW * A^T。因为A初始为0，所以∂L/∂B会是0，导致B在第一次更新时无法被优化。而A的梯度则取决于B的初始值和ΔW的梯度。如果B是随机初始化的，那么A的梯度不为0，可以更新A。这样在第二次前向时，A已经不是0了，ΔW=B*A会有非零值，此时B的梯度也会开始更新。\n\u003e\n\u003e 这样看起来可能可行，但存在什么问题吗？比如训练初期的不稳定，或者需要更多的迭代才能启动。不过原来的方法中，B初始为0，A随机，可以保证ΔW初始为0，同时B的梯度在第一次更新时就可以通过A的随机值得到有效更新。而反过来，A初始为0，B随机，导致ΔW初始为0，但B的梯度在第一次无法更新，而A可以更新。这样在第一次迭代后，A有了更新值，第二次B才能开始更新。这样可能需要多一个步骤才能让两个矩阵都开始学习，可能影响收敛速度。\n\u003e\n\u003e 另外，当A初始为0，B随机时，虽然ΔW初始为0，但此时A的梯度依赖于B的随机值，可能导致A的初始更新方向带有较大的随机性，而B本身没有被调整，这样可能会引入更多的噪声，影响训练的稳定性。相比之下，原来的方法中，A随机，B为0，这样ΔW初始为0，而B的梯度直接由A的随机值和损失梯度决定，可能更有效。\n\u003e\n\u003e 再考虑优化动态，原来的方法中，B初始为0，意味着在初始阶段，只有A的随机性被引入，但通过梯度下降，B可以快速调整。而反过来，A初始为0，B随机，虽然ΔW初始为0，但A的更新可能更快地引入变化，而B的调整滞后，可能导致训练初期的不稳定。\n\u003e\n\u003e 总结来说，虽然理论上可能存在可行的路径，但实际中原来的初始化方式在梯度更新效率和稳定性上更优。因此，将A随机、B初始化为0是更合理的选择，而反过来可能导致训练效率低下或收敛困难。\n\n将矩阵 **B** 随机初始化而矩阵 **A** 初始化为零，在理论上虽然可能，但会导致训练效率显著下降甚至失败。以下是具体分析：\n\n---\n\n### **1. 梯度消失问题：反向传播的数学限制**\n- **前向传播**：若 **A** 初始化为零，则初始的权重更新为：\n  $$\n  \\Delta W = B \\cdot A = B \\cdot 0 = 0\n  $$\n  此时模型的输出与原始预训练模型一致，与标准 LoRA 初始化类似。\n\n- **反向传播**：\n  - **B 的梯度**：  \n    $$\n    \\frac{\\partial L}{\\partial B} = \\frac{\\partial L}{\\partial \\Delta W} \\cdot A^\\top\n    $$\n    由于 **A** 初始化为零，**B** 的梯度在第一次更新时直接为零，导致 **B** 无法被优化（梯度消失）。\n\n  - **A 的梯度**：  \n    $$\n    \\frac{\\partial L}{\\partial A} = B^\\top \\cdot \\frac{\\partial L}{\\partial \\Delta W}\n    $$\n    虽然 **A** 的梯度不为零（取决于随机初始化的 **B**），但 **A** 的更新需要与 **B** 的更新协同才能有效调整权重。由于 **B** 在初始阶段无法更新，**A** 的更新方向会受限于初始随机的 **B**，导致优化过程不稳定。\n\n---\n\n### **2. 训练效率的显著下降**\n- **B 的延迟更新**：  \n  由于 **B** 的梯度在第一次迭代时为零，必须等待 **A** 被更新为非零值后，**B** 的梯度才会开始有效更新。这会引入额外的训练延迟，显著降低收敛速度。\n\n- **参数耦合问题**：  \n  LoRA 的核心设计是 **低秩分解**（$$\\Delta W = BA$$），其有效性依赖于 **A** 和 **B** 的协同优化。若 **A** 初始为零，两者的优化动态被解耦：**A** 的更新依赖于随机初始化的 **B**，而 **B** 的更新又需要等待 **A** 被调整。这种耦合断裂会导致训练过程低效且不稳定。\n\n---\n\n### **3. 与标准 LoRA 初始化的对比**\n- **标准初始化（A随机，B=0）的优势**：  \n  - **B 的梯度有效启动**：  \n    由于 **A** 随机初始化，**B** 的梯度 $$\\frac{\\partial L}{\\partial B} = \\frac{\\partial L}{\\partial \\Delta W} \\cdot A^\\top$$ 在第一次迭代时即可非零，确保 **B** 立即参与优化。\n  - **对称性打破**：  \n    **A** 的随机性天然打破了参数对称性，避免了梯度冲突。\n  - **稳定的残差学习**：  \n    $$\\Delta W$$ 从零开始逐步增长，符合残差学习的特性，保护了预训练知识。\n\n- **反转初始化（A=0，B随机）的劣势**：  \n  - **B 的梯度消失**：初始阶段 **B** 无法更新，导致训练\"冷启动\"。\n  - **参数优化的冲突**：**A** 的更新方向受限于随机初始化的 **B**，可能引入噪声。\n\n---\n\n### **4. 实验角度的验证**\n在实际任务中（如微调 GPT 或 BERT），若将 **A** 初始化为零且 **B** 随机，通常会导致以下现象：\n1. **训练损失震荡**：由于 **A** 和 **B** 的优化动态不匹配，损失函数难以稳定下降。\n2. **收敛速度缓慢**：需要更多迭代次数才能达到与标准初始化相当的性能。\n3. **最终性能下降**：参数耦合问题可能导致模型陷入次优解。\n\n---\n\n### **结论：为什么不能将 A 初始化为零？**\n- **数学层面**：梯度消失问题导致 **B** 无法在初始阶段更新，破坏了低秩分解的优化动态。\n- **工程层面**：训练效率显著下降，且可能引入不稳定性。\n- **设计哲学**：LoRA 的目标是\"以最小的扰动高效调整预训练模型\"。标准初始化（A随机，B=0）通过梯度协同性和残差学习的特性，完美契合这一目标；而反转初始化违背了这一设计原则。\n\n因此，**A 随机初始化 + B 初始化为零**是唯一合理的初始化策略。\n\n","title":"LoRA微调中的矩阵初始化策略：A随机与B零初始化","abstract":"\u003e 本文是与 Deepseek-R1 模型+Search 的对话记录，详细探讨了 LoRA（低秩适应）微调技术中矩阵初始化策略的数学原理。文章分析了为什么在 LoRA 中矩阵 A 采用随机初始化而矩阵 B 采用零初始化的原因，包括保持初始模型稳定性、确保梯度更新有效性、实现逐步学习的低秩更新等方面。同时，文章也解释了为什么反向初始化策略（B随机而A为零）在理论上存在问题，会导致梯度消失和训练效率下降。这些分析有助于理解深度学习中参数高效微调技术的设计原理。\n\u003e 嗯，这个问题是关于LoRA（低秩适应）初始化的。为什么在初始化的时候，矩阵A是随机初始化的，而矩阵B是零初始化的呢？我需要仔细思考一下。\n\u003e","length":151,"created_at":"2025-03-05T02:00:00.000Z","updated_at":"2025-03-05T02:00:00.000Z","tags":["深度学习","LoRA","参数高效微调","模型训练","学习笔记"],"license":true}}}},"__N_SSG":true},"page":"/learn_from_ai/[slug]","query":{"slug":"pytorch-backpropagation-mechanism"},"buildId":"P1XPmppfnPIPoLUZ4zipP","assetPrefix":"/blog-next","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>