(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86462,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.removeMarkdown=void 0,r.removeMarkdown=function(e,t){void 0===t&&(t={listUnicodeChar:""}),(t=t||{}).listUnicodeChar=!!t.hasOwnProperty("listUnicodeChar")&&t.listUnicodeChar,t.stripListLeaders=!t.hasOwnProperty("stripListLeaders")||t.stripListLeaders,t.gfm=!t.hasOwnProperty("gfm")||t.gfm,t.useImgAltText=!t.hasOwnProperty("useImgAltText")||t.useImgAltText,t.preserveLinks=!!t.hasOwnProperty("preserveLinks")&&t.preserveLinks;var r=e||"";r=r.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*$/gm,"");try{t.stripListLeaders&&(r=t.listUnicodeChar?r.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,t.listUnicodeChar+" $1"):r.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,"$1")),t.gfm&&(r=r.replace(/\n={2,}/g,"\n").replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/`{3}.*\n/g,"")),t.preserveLinks&&(r=r.replace(/\[(.*?)\][\[\(](.*?)[\]\)]/g,"$1 ($2)")),r=r.replace(/<[^>]*>/g,"").replace(/^[=\-]{2,}\s*$/g,"").replace(/\[\^.+?\](\: .*?$)?/g,"").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,t.useImgAltText?"$1":"").replace(/\[(.*?)\][\[\(].*?[\]\)]/g,"$1").replace(/^\s{0,3}>\s?/g,"").replace(/(^|\n)\s{0,3}>\s?/g,"\n\n").replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/^(\n)?\s{0,}#{1,6}\s+| {0,}(\n)?\s{0,}#{0,} {0,}(\n)?\s{0,}$/gm,"$1$2$3").replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/\n{2,}/g,"\n\n")}catch(t){return console.error(t),e}return r}},91936,e=>{"use strict";let t={rect:"rectangle",circle:"ellipse"},r={startOnLoad:!1,flowchart:{curve:"linear"},themeVariables:{fontSize:"25px"},maxEdges:500,maxTextSize:5e4};class a{constructor({converter:e}){this.convert=(e,t)=>this.converter(e,{...t,fontSize:t.fontSize||20}),this.converter=e}}(l=i||(i={})).ROUND="round",l.STADIUM="stadium",l.DOUBLECIRCLE="doublecircle",l.CIRCLE="circle",l.DIAMOND="diamond",(o||(o={})).COLOR="color",(s=n||(n={})).FILL="fill",s.STROKE="stroke",s.STROKE_WIDTH="stroke-width",s.STROKE_DASHARRAY="stroke-dasharray";var l,s,i,o,n,d=e.i(86462);let u={arrow_circle:{endArrowhead:"dot"},arrow_cross:{endArrowhead:"bar"},arrow_open:{endArrowhead:null,startArrowhead:null},double_arrow_circle:{endArrowhead:"dot",startArrowhead:"dot"},double_arrow_cross:{endArrowhead:"bar",startArrowhead:"bar"},double_arrow_point:{endArrowhead:"arrow",startArrowhead:"arrow"}},h=e=>{let t=e.text;return"markdown"===e.labelType&&(t=(0,d.removeMarkdown)(e.text)),c(t)},c=e=>e.replace(/\s?(fa|fab):[a-zA-Z0-9-]+/g,""),p=new a({converter:(e,t)=>{let r,a,l=[],s=t.fontSize,{getGroupIds:d,getParentId:c}=(r={},e.subGraphs.map(t=>{t.nodeIds.forEach(a=>{r[t.id]={id:t.id,parent:null,isLeaf:!1},r[a]={id:a,parent:t.id,isLeaf:void 0!==e.vertices[a]}})}),a={},[...Object.keys(e.vertices),...e.subGraphs.map(e=>e.id)].forEach(e=>{if(!r[e])return;let t=r[e],l=[];for(t.isLeaf||l.push(`subgraph_group_${t.id}`);;)if(t.parent)l.push(`subgraph_group_${t.parent}`),t=r[t.parent];else break;a[e]=l}),{getGroupIds:e=>a[e]||[],getParentId:e=>r[e]?r[e].parent:null});return e.subGraphs.reverse().forEach(e=>{let t=d(e.id),r={id:e.id,type:"rectangle",groupIds:t,x:e.x,y:e.y,width:e.width,height:e.height,label:{groupIds:t,text:h(e),fontSize:s,verticalAlign:"top"}};l.push(r)}),Object.values(e.vertices).forEach(e=>{var t,r;let a,u;if(!e)return;let c=d(e.id),p=(t=e.containerStyle,a={},Object.keys(t).forEach(e=>{switch(e){case n.FILL:a.backgroundColor=t[e],a.fillStyle="solid";break;case n.STROKE:a.strokeColor=t[e];break;case n.STROKE_WIDTH:a.strokeWidth=Number(t[e]?.split("px")[0]);break;case n.STROKE_DASHARRAY:a.strokeStyle="dashed"}}),a),g=(r=e.labelStyle,u={},Object.keys(r).forEach(e=>{e===o.COLOR&&(u.strokeColor=r[e])}),u),b={id:e.id,type:"rectangle",groupIds:c,x:e.x,y:e.y,width:e.width,height:e.height,strokeWidth:2,label:{groupIds:c,text:h(e),fontSize:s,...g},link:e.link||null,...p};switch(e.type){case i.STADIUM:case i.ROUND:b={...b,roundness:{type:3}};break;case i.DOUBLECIRCLE:{c.push(`doublecircle_${e.id}}`);let t={type:"ellipse",groupIds:c,x:e.x+5,y:e.y+5,width:e.width-10,height:e.height-10,strokeWidth:2,roundness:{type:3},label:{groupIds:c,text:h(e),fontSize:s}};b={...b,groupIds:c,type:"ellipse"},l.push(t);break}case i.CIRCLE:b.type="ellipse";break;case i.DIAMOND:b.type="diamond"}l.push(b)}),e.edges.forEach(e=>{let t=[],r=c(e.start),a=c(e.end);r&&r===a&&(t=d(r));let{startX:i,startY:o,reflectionPoints:n}=e,p=n.map(e=>[e.x-n[0].x,e.y-n[0].y]),g=u[e.type],b={id:`${e.start}_${e.end}`,type:"arrow",groupIds:t,x:i,y:o,strokeWidth:"thick"===e.stroke?4:2,strokeStyle:"dotted"===e.stroke?"dashed":void 0,points:p,...e.text?{label:{text:h(e),fontSize:s,groupIds:t}}:{},roundness:{type:2},...g},y=l.find(t=>t.id===e.start),f=l.find(t=>t.id===e.end);y&&f&&(b.start={id:y.id||""},b.end={id:f.id||""},l.push(b))}),{elements:l}}}),g=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),""),b=new a({converter:e=>{let t=g(),{width:r,height:a}=e;return{files:{[t]:{id:t,mimeType:e.mimeType,dataURL:e.dataURL}},elements:[{type:"image",x:0,y:0,width:r,height:a,status:"saved",fileId:t}]}}}),y=e=>{let t={type:"line",x:e.startX,y:e.startY,points:[[0,0],[e.endX-e.startX,e.endY-e.startY]],width:e.endX-e.startX,height:e.endY-e.startY,strokeStyle:e.strokeStyle||"solid",strokeColor:e.strokeColor||"#000",strokeWidth:e.strokeWidth||1};return e.groupId&&Object.assign(t,{groupIds:[e.groupId]}),e.id&&Object.assign(t,{id:e.id}),t},f=e=>{let t={type:"text",x:e.x,y:e.y,width:e.width,height:e.height,text:e.text.replace(/\\n/g,"\n")||"",fontSize:e.fontSize,verticalAlign:"middle"};return e.groupId&&Object.assign(t,{groupIds:[e.groupId]}),e.id&&Object.assign(t,{id:e.id}),t},m=e=>{let t={};"rectangle"===e.type&&"activation"===e.subtype&&(t={backgroundColor:"#e9ecef",fillStyle:"solid"});let r={id:e.id,type:e.type,x:e.x,y:e.y,width:e.width,height:e.height,label:{text:(e?.label?.text||"").replace(/\\n/g,"\n"),fontSize:e?.label?.fontSize,verticalAlign:e.label?.verticalAlign||"middle",strokeColor:e.label?.color||"#000",groupIds:e.groupId?[e.groupId]:[]},strokeStyle:e?.strokeStyle,strokeWidth:e?.strokeWidth,strokeColor:e?.strokeColor,backgroundColor:e?.bgColor,fillStyle:"solid",...t};return e.groupId&&Object.assign(r,{groupIds:[e.groupId]}),r},x=e=>{let t={type:"arrow",x:e.startX,y:e.startY,points:e.points||[[0,0],[e.endX-e.startX,e.endY-e.startY]],width:e.endX-e.startX,height:e.endY-e.startY,strokeStyle:e?.strokeStyle||"solid",endArrowhead:e?.endArrowhead||null,startArrowhead:e?.startArrowhead||null,label:{text:(e?.label?.text||"").replace(/\\n/g,"\n"),fontSize:16},roundness:{type:2},start:e.start,end:e.end};return e.groupId&&Object.assign(t,{groupIds:[e.groupId]}),t},w=new a({converter:e=>{let t=[],r=[];if(Object.values(e.nodes).forEach(e=>{e&&e.length&&e.forEach(e=>{let a;switch(e.type){case"line":a=y(e);break;case"rectangle":case"ellipse":a=m(e);break;case"text":a=f(e);break;default:throw`unknown type ${e.type}`}"rectangle"===e.type&&e?.subtype==="activation"?r.push(a):t.push(a)})}),Object.values(e.lines).forEach(e=>{e&&t.push(y(e))}),Object.values(e.arrows).forEach(e=>{e&&(t.push(x(e)),e.sequenceNumber&&t.push(m(e.sequenceNumber)))}),t.push(...r),e.loops){let{lines:r,texts:a,nodes:l}=e.loops;r.forEach(e=>{t.push(y(e))}),a.forEach(e=>{t.push(f(e))}),l.forEach(e=>{t.push(m(e))})}return e.groups&&e.groups.forEach(e=>{let{actorKeys:r,name:a}=e,l=1/0,s=1/0,i=0,o=0;if(!r.length)return;t.filter(e=>{if(e.id){let t=e.id.indexOf("-"),a=e.id.substring(0,t);return r.includes(a)}}).forEach(e=>{if(void 0===e.x||void 0===e.y||void 0===e.width||void 0===e.height)throw Error(`Actor attributes missing ${e}`);l=Math.min(l,e.x),s=Math.min(s,e.y),i=Math.max(i,e.x+e.width),o=Math.max(o,e.y+e.height)});let n=l-10,d=s-10,u=i-l+20,h=o-s+20,c=g(),p=m({type:"rectangle",x:n,y:d,width:u,height:h,bgColor:e.fill,id:c});t.unshift(p);let b=g(),y=[c];t.forEach(e=>{if("frame"!==e.type){if(void 0===e.x||void 0===e.y||void 0===e.width||void 0===e.height)throw Error(`Element attributes missing ${e}`);if(e.x>=l&&e.x+e.width<=i&&e.y>=s&&e.y+e.height<=o){let t=e.id||g();e.id||Object.assign(e,{id:t}),y.push(t)}}}),t.push({type:"frame",id:b,name:a,children:y})}),{elements:t}}}),A=new a({converter:e=>{let t=[];return Object.values(e.nodes).forEach(e=>{e&&e.length&&e.forEach(e=>{let r;switch(e.type){case"line":r=y(e);break;case"rectangle":case"ellipse":r=m(e);break;case"text":r=f(e);break;default:throw`unknown type ${e.type}`}t.push(r)})}),Object.values(e.lines).forEach(e=>{e&&t.push(y(e))}),Object.values(e.arrows).forEach(e=>{if(!e)return;let r=x(e);t.push(r)}),Object.values(e.text).forEach(e=>{let r=f(e);t.push(r)}),Object.values(e.namespaces).forEach(r=>{let a=Object.keys(r.classes),l=[...a],s=[...e.lines,...e.arrows,...e.text];a.forEach(e=>{let t=s.filter(t=>t.metadata&&t.metadata.classId===e).map(e=>e.id);t.length&&l.push(...t)});let i={type:"frame",id:g(),name:r.id,children:l};t.push(i)}),{elements:t}}});var k=e.i(9399),k=k;let E=e=>{let t=(e=v(e)).replace(/#(\d+);/g,"&#$1;").replace(/#([a-z]+);/g,"&$1;"),r=document.createElement("textarea");return r.innerHTML=t,r.value},S=e=>{let t=e.getAttribute("transform"),r=t?.match(/translate\(([ \d.-]+),\s*([\d.-]+)\)/),a=0,l=0;return r&&(a=Number(r[1]),l=Number(r[2])),{transformX:a,transformY:l}},v=function(e){return e.replace(/ﬂ°°/g,"#").replace(/ﬂ°/g,"&").replace(/¶ß/g,";")},O=(e,t={x:0,y:0})=>{if("path"!==e.tagName.toLowerCase())throw Error(`Invalid input: Expected an HTMLElement of tag "path", got ${e.tagName}`);let r=e.getAttribute("d");if(!r)throw Error('Path element does not contain a "d" attribute');let a=r.split(/(?=[LM])/),l=a[0].substring(1).split(",").map(e=>parseFloat(e)),s=a[a.length-1].substring(1).split(",").map(e=>parseFloat(e)),i=a.map(e=>{let t=e.substring(1).split(",").map(e=>parseFloat(e));return{x:t[0],y:t[1]}}).filter((e,t,r)=>{if(0===t||t===r.length-1)return!0;if(e.x===r[t-1].x&&e.y===r[t-1].y)return!1;if(t===r.length-2&&(r[t-1].x===e.x||r[t-1].y===e.y)){let t=r[r.length-1];return Math.hypot(t.x-e.x,t.y-e.y)>20}return e.x!==r[t-1].x||e.y!==r[t-1].y}).map(e=>({x:e.x+t.x,y:e.y+t.y}));return{startX:l[0]+t.x,startY:l[1]+t.y,endX:s[0]+t.x,endY:s[1]+t.y,reflectionPoints:i}},N=(e,t)=>{if(!e)throw Error("Element not found");let r=e.parentElement?.parentElement,a=e.childNodes[0],l={x:0,y:0};if(a){let{transformX:e,transformY:t}=S(a),r=a.getBBox();l={x:Number(a.getAttribute("x"))||e+r.x||0,y:Number(a.getAttribute("y"))||t+r.y||0}}let{transformX:s,transformY:i}=S(e),o={x:s+l.x,y:i+l.y};for(;r&&r.id!==t.id;){if("root"===r.classList.value&&r.hasAttribute("transform")){let{transformX:e,transformY:t}=S(r);o.x+=e,o.y+=t}r=r.parentElement}return o},L=(e,t,r,a,l)=>{let s={};return s.type="arrow",s.startX=e,s.startY=t,s.endX=r,s.endY=a,Object.assign(s,{...l}),s},C=(e,t,r,a)=>({type:"text",x:e,y:t,text:r,width:a?.width||20,height:a?.height||20,fontSize:a?.fontSize||20,id:a?.id,groupId:a?.groupId,metadata:a?.metadata}),I=(e,t,r)=>{let a={},l=Number(e.getAttribute("x")),s=Number(e.getAttribute("y"));a.type="text",a.text=E(t),r?.id&&(a.id=r.id),r?.groupId&&(a.groupId=r.groupId);let i=e.getBBox();return a.width=i.width,a.height=i.height,a.x=l-i.width/2,a.y=s,a.fontSize=parseInt(getComputedStyle(e).fontSize),a},$=(e,t,r={})=>{let a={};a.type=t;let{label:l,subtype:s,id:i,groupId:o}=r;a.id=i,o&&(a.groupId=o),l&&(a.label={text:E(l.text),fontSize:16,verticalAlign:l?.verticalAlign});let n=e.getBBox();switch(a.x=n.x,a.y=n.y,a.width=n.width,a.height=n.height,a.subtype=s,s){case"highlight":let d=e.getAttribute("fill");d&&(a.bgColor=d);break;case"note":a.strokeStyle="dashed"}return a},T=(e,t,r,a,l,s)=>{let i={};return i.startX=t,i.startY=r,i.endX=a,s?.groupId&&(i.groupId=s.groupId),s?.id&&(i.id=s.id),i.endY=l,i.strokeColor=e.getAttribute("stroke"),i.strokeWidth=Number(e.getAttribute("stroke-width")),i.type="line",i},Y={0:"SOLID",1:"DOTTED",3:"SOLID_CROSS",4:"DOTTED_CROSS",5:"SOLID_OPEN",6:"DOTTED_OPEN",24:"SOLID_POINT",25:"DOTTED_POINT"},X=(e,r,a)=>{if(!e)throw"root node not found";let l=g(),s=Array.from(e.children),i=[];return s.forEach((e,s)=>{let o,n=`${a?.id}-${s}`;switch(e.tagName){case"line":let d=Number(e.getAttribute("x1")),u=Number(e.getAttribute("y1")),h=Number(e.getAttribute("x2")),c=Number(e.getAttribute("y2"));o=T(e,d,u,h,c,{groupId:l,id:n});break;case"text":o=I(e,r,{groupId:l,id:n});break;case"circle":o=$(e,"ellipse",{label:e.textContent?{text:e.textContent}:void 0,groupId:l,id:n});default:o=$(e,t[e.tagName],{label:e.textContent?{text:e.textContent}:void 0,groupId:l,id:n})}i.push(o)}),i},R=e=>{let t;switch(e){case 0:t="diamond_outline";break;case 2:t="diamond";break;case 1:t="triangle_outline";break;case"none":t=null;break;default:t="arrow"}return t},_=async(e,t=r)=>{let a,l,s,i,o;k.N.initialize({...r,...t});let n=await k.N.mermaidAPI.getDiagramFromText(e.replace(/style.*:\S*#.*;/g,e=>e.substring(0,e.length-1)).replace(/classDef.*:\S*#.*;/g,e=>e.substring(0,e.length-1)).replace(/#\w+;/g,e=>{let t=e.substring(1,e.length-1);return/^\+?\d+$/.test(t)?`ﬂ\xb0\xb0${t}\xb6\xdf`:`ﬂ\xb0${t}\xb6\xdf`})),{svg:d}=await k.N.render("mermaid-to-excalidraw",e),u=document.createElement("div");switch(u.setAttribute("style","opacity: 0; position: relative; z-index: -1;"),u.innerHTML=d,u.id="mermaid-diagram",document.body.appendChild(u),n.type){case"flowchart-v2":n.parse(),Object.keys(s=(l=n.parser.yy).getVertices()).forEach(e=>{s[e]=((e,t)=>{let r,a=t.querySelector(`[id*="flowchart-${e.id}-"]`);if(!a)return;a.parentElement?.tagName.toLowerCase()==="a"&&(r=a.parentElement.getAttribute("xlink:href"));let l=N(r?a.parentElement:a,t),s=a.getBBox(),i={width:s.width,height:s.height},o=a.querySelector(".label-container")?.getAttribute("style"),n=a.querySelector(".label")?.getAttribute("style"),d={};o?.split(";").forEach(e=>{if(!e)return;let t=e.split(":")[0].trim(),r=e.split(":")[1].trim();d[t]=r});let u={};return n?.split(";").forEach(e=>{if(!e)return;let t=e.split(":")[0].trim(),r=e.split(":")[1].trim();u[t]=r}),{id:e.id,labelType:e.labelType,text:E(e.text),type:e.type,link:r||void 0,...l,...i,containerStyle:d,labelStyle:u}})(s[e],u)}),i=new Map,o=l.getEdges().filter(e=>u.querySelector(`[id*="L-${e.start}-${e.end}"]`)).map(e=>{let t=`${e.start}-${e.end}`,r=i.get(t)||0;i.set(t,r+1);let a=u.querySelector(`[id*="L-${e.start}-${e.end}-${r}"]`);if(!a)throw Error("Edge element not found");let l=N(a,u),s=O(a,l);return e.length=void 0,{...e,...s,text:E(e.text)}}),a={type:"flowchart",subGraphs:l.getSubGraphs().map(e=>((e,t)=>{let r=e.nodes.map(e=>e.startsWith("flowchart-")?e.split("-")[1]:e),a=t.querySelector(`[id='${e.id}']`);if(!a)throw Error("SubGraph element not found");let l=N(a,t),s=a.getBBox(),i={width:s.width,height:s.height};return e.classes=void 0,e.dir=void 0,{...e,nodeIds:r,...l,...i,text:E(e.title)}})(e,u)),vertices:s,edges:o};break;case"sequence":a=((e,t)=>{var r;let a,l,s,i,o,n,d,u,h,c,p,g,b,y,f,m,x,w,A,k,S,v,O;e.parse();let N=e.parser.yy,L=[],C=N.getBoxes(),R=(a=Array.from(t.querySelectorAll(".rect")).filter(e=>e.parentElement?.tagName!=="g"),l=[],a.forEach(e=>{let t=$(e,"rectangle",{label:{text:""},subtype:"highlight"});l.push(t)}),l),{nodes:_,lines:D}=(r=N.getActors(),s=Array.from(t.querySelectorAll(".actor-top")),i=Array.from(t.querySelectorAll(".actor-bottom")),o=[],n=[],Object.values(r).forEach((e,t)=>{let r=s.find(t=>t.getAttribute("name")===e.name),a=i.find(t=>t.getAttribute("name")===e.name);if(!r||!a)throw"root not found";let l=e.description;if("participant"===e.type){let t=$(r,"rectangle",{id:`${e.name}-top`,label:{text:l},subtype:"actor"});if(!t)throw"Top Node element not found!";o.push([t]);let s=$(a,"rectangle",{id:`${e.name}-bottom`,label:{text:l},subtype:"actor"});o.push([s]);let i=r?.parentElement?.previousElementSibling;if(i?.tagName!=="line")throw"Line not found";let d=Number(i.getAttribute("x1"));if(!t.height)throw"Top node element height is null";let u=t.y+t.height,h=s.y,c=Number(i.getAttribute("x2")),p=T(i,d,u,c,h);n.push(p)}else if("actor"===e.type){let t=X(r,l,{id:`${e.name}-top`});o.push(t);let s=X(a,l,{id:`${e.name}-bottom`});o.push(s);let i=r.previousElementSibling;if(i?.tagName!=="line")throw"Line not found";let d=Number(i.getAttribute("x1")),u=Number(i.getAttribute("y1")),h=Number(i.getAttribute("x2")),c=s.find(e=>"ellipse"===e.type);if(c){let e=T(i,d,u,h,c.y);n.push(e)}}}),{nodes:o,lines:n}),j=N.getMessages(),q=(d=[],u=Array.from(t.querySelectorAll('[class*="messageLine"]')),h=Object.keys(Y),c=j.filter(e=>h.includes(e.type.toString())),u.forEach((e,t)=>{let r=c[t],a=Y[r.type],l=((e,t)=>{let r={};t?.label&&(r.label={text:E(t.label),fontSize:16});let a=e.tagName;if("line"===a)r.startX=Number(e.getAttribute("x1")),r.startY=Number(e.getAttribute("y1")),r.endX=Number(e.getAttribute("x2")),r.endY=Number(e.getAttribute("y2"));else if("path"===a){let t=e.getAttribute("d");if(!t)throw Error('Path element does not contain a "d" attribute');let a=t.split(/(?=[LC])/),l=a[0].substring(1).split(",").map(e=>parseFloat(e)),s=[];a.forEach(e=>{let t=e.substring(1).trim().split(" ").map(e=>{let[t,r]=e.split(",");return[parseFloat(t)-l[0],parseFloat(r)-l[1]]});s.push(...t)});let i=s[s.length-1];r.startX=l[0],r.startY=l[1],r.endX=i[0],r.endY=i[1],r.points=s}return t?.label&&(r.startY=r.startY-10,r.endY=r.endY-10),r.strokeColor=e.getAttribute("stroke"),r.strokeWidth=Number(e.getAttribute("stroke-width")),r.type="arrow",r.strokeStyle=t?.strokeStyle||"solid",r.startArrowhead=t?.startArrowhead||null,r.endArrowhead=t?.endArrowhead||null,r})(e,{label:r?.message,strokeStyle:(e=>{let t;switch(e){case 0:case 3:case 5:case 24:default:t="solid";break;case 1:case 4:case 6:case 25:t="dotted"}return t})(r.type),endArrowhead:"SOLID_OPEN"===a||"DOTTED_OPEN"===a?null:"arrow"});if(e.nextElementSibling?.classList.contains("sequenceNumber")){let t=e.nextElementSibling?.textContent;if(!t)throw Error("sequence number not present");let r={type:"rectangle",x:l.startX-10,y:l.startY-15,label:{text:t,fontSize:14},bgColor:"#e9ecef",height:30,subtype:"sequence"};Object.assign(l,{sequenceNumber:r})}d.push(l)}),d),B=(p=Array.from(t.querySelectorAll(".note")).map(e=>e.parentElement),g=j.filter(e=>2===e.type),b=[],p.forEach((e,t)=>{if(!e)return;let r=$(e.firstChild,"rectangle",{label:{text:g[t].message},subtype:"note"});b.push(r)}),b),z=(y=Array.from(t.querySelectorAll("[class*=activation]")),f=[],y.forEach(e=>{let t=$(e,"rectangle",{label:{text:""},subtype:"activation"});f.push(t)}),f),M=(m=Array.from(t.querySelectorAll(".loopLine")),x=[],w=[],A=[],m.forEach(e=>{let t=Number(e.getAttribute("x1")),r=Number(e.getAttribute("y1")),a=Number(e.getAttribute("x2")),l=Number(e.getAttribute("y2")),s=T(e,t,r,a,l);s.strokeStyle="dotted",s.strokeColor="#adb5bd",s.strokeWidth=2,x.push(s)}),k=Array.from(t.querySelectorAll(".loopText")),S=j.filter(e=>27===e.type).map(e=>e.message),k.forEach(e=>{let t=e.textContent||"",r=I(e,t),a=t.match(/\[(.*?)\]/)?.[1]||"";S.includes(a)&&(r.x+=16),w.push(r)}),v=Array.from(t?.querySelectorAll(".labelBox")),O=Array.from(t?.querySelectorAll(".labelText")),v.forEach((e,t)=>{let r=$(e,"rectangle",{label:{text:O[t]?.textContent||""}});r.strokeColor="#adb5bd",r.bgColor="#e9ecef",r.width=void 0,A.push(r)}),{lines:x,texts:w,nodes:A});return L.push(R),L.push(..._),L.push(B),L.push(z),{type:"sequence",lines:D,arrows:q,nodes:L,loops:M,groups:C}})(n,u);break;case"classDiagram":a=((e,t)=>{var r;let a,l;e.parse();let s=e.parser.yy,i=s.getDirection(),o=[],n=[],d=[],u=[],h=s.getNamespaces(),c=s.getClasses();if(Object.keys(c).length){let e,r,a,l=(e=[],r=[],a=[],Object.values(c).forEach(l=>{let{domId:s,id:i}=l,o=g(),n=t.querySelector(`[data-id=${i}]`);if(!n)throw Error(`DOM Node with id ${s} not found`);let{transformX:d,transformY:u}=S(n),h=$(n.firstChild,"rectangle",{id:i,groupId:o});h.x+=d,h.y+=u,h.metadata={classId:i},e.push(h),Array.from(n.querySelectorAll(".divider")).forEach(e=>{let t=Number(e.getAttribute("x1")),a=Number(e.getAttribute("y1")),l=Number(e.getAttribute("x2")),s=Number(e.getAttribute("y2")),n=T(e,t,a,l,s,{groupId:o,id:g()});n.startX+=d,n.startY+=u,n.endX+=d,n.endY+=u,n.metadata={classId:i},r.push(n)});let c=n.querySelector(".label")?.children;if(!c)throw"label nodes not found";Array.from(c).forEach(e=>{let t=e.textContent;if(!t)return;let r=g(),{transformX:l,transformY:s}=S(e),n=e.getBBox(),h=C(d+l,u+s+10,t,{width:n.width,height:n.height,id:r,groupId:o,metadata:{classId:i}});a.push(h)})}),{nodes:e,lines:r,text:a});o.push(l.nodes),n.push(...l.lines),d.push(...l.text),u.push(...l.nodes)}let{arrows:p,text:b}=((e,t,r,a)=>{let l=r.querySelector(".edgePaths")?.children;if(!l)throw Error("No Edges found!");let s=[],i=[];return e.forEach((e,r)=>{let o,n,d,u,h,{id1:c,id2:p,relation:g}=e,b=t.find(e=>e.id===c),y=t.find(e=>e.id===p),f=(e=>{let t;switch(e){case 0:default:t="solid";break;case 1:t="dotted"}return t})(g.lineType),m=R(g.type1),x=R(g.type2),w=O(l[r]),A=L(w.startX,w.startY,w.endX,w.endY,{strokeStyle:f,startArrowhead:m,endArrowhead:x,label:e.title?{text:e.title}:void 0,start:{type:"rectangle",id:b.id},end:{type:"rectangle",id:y.id}}),k=(d=["triangle_outline","diamond","diamond_outline"],u=A.startArrowhead&&d.includes(A.startArrowhead),((h=A.endArrowhead&&d.includes(A.endArrowhead))||u)&&(u&&("LR"===a?A.startX-=16:"RL"===a?A.startX+=16:"TB"===a?A.startY-=16:"BT"===a&&(A.startY+=16)),h&&("LR"===a?A.endX+=16:"RL"===a?A.endX-=16:"TB"===a?A.endY+=16:"BT"===a&&(A.endY-=16))),A);s.push(k);let{relationTitle1:E,relationTitle2:S}=e;if(E&&"none"!==E){switch(a){case"TB":o=k.startX-20,k.endX<k.startX&&(o-=15),n=k.startY+15;break;case"BT":o=k.startX+20,k.endX>k.startX&&(o+=15),n=k.startY-15;break;case"LR":o=k.startX+20,n=k.startY+15,k.endY>k.startY&&(n+=15);break;case"RL":o=k.startX-20,n=k.startY-15,k.startY>k.endY&&(n-=15);break;default:o=k.startX-20,n=k.startY+15}let e=C(o,n,E,{fontSize:16});i.push(e)}if(S&&"none"!==S){switch(a){case"TB":o=k.endX+20,k.endX<k.startX&&(o+=15),n=k.endY-15;break;case"BT":o=k.endX-20,k.endX>k.startX&&(o-=15),n=k.endY+15;break;case"LR":o=k.endX-20,n=k.endY-15,k.endY>k.startY&&(n-=15);break;case"RL":o=k.endX+20,n=k.endY+15,k.startY>k.endY&&(n+=15);break;default:o=k.endX+20,n=k.endY-15}let e=C(o,n,S,{fontSize:16});i.push(e)}}),{arrows:s,text:i}})(s.getRelations(),u,t,i),{notes:y,connectors:f}=(r=s.getNotes(),a=[],l=[],r.forEach(e=>{let{id:r,text:s,class:i}=e,o=t.querySelector(`#${r}`);if(!o)throw Error(`Node with id ${r} not found!`);let{transformX:n,transformY:d}=S(o),h=$(o.firstChild,"rectangle",{id:r,subtype:"note",label:{text:s}});if(Object.assign(h,{x:h.x+n,y:h.y+d}),a.push(h),i){let e=u.find(e=>e.id===i);if(!e)throw Error(`class node with id ${i} not found!`);let t=h.x+(h.width||0)/2,r=L(t,h.y+(h.height||0),t,e.y,{strokeStyle:"dotted",startArrowhead:null,endArrowhead:null,start:{id:h.id,type:"rectangle"},end:{id:e.id,type:"rectangle"}});l.push(r)}}),{notes:a,connectors:l});return o.push(y),p.push(...f),d.push(...b),{type:"class",nodes:o,lines:n,arrows:p,text:d,namespaces:h}})(n,u);break;default:a=(e=>{let t=e.querySelector("svg");if(!t)throw Error("SVG element not found");let r=t.getBoundingClientRect(),a=r.width,l=r.height;t.setAttribute("width",`${a}`),t.setAttribute("height",`${l}`);let s=btoa(unescape(encodeURIComponent(t.outerHTML)));return{type:"graphImage",mimeType:"image/svg+xml",dataURL:`data:image/svg+xml;base64,${s}`,width:a,height:l}})(u)}return u.remove(),a},D=async(e,t)=>{let r=t||{},a=parseInt(r.themeVariables?.fontSize??"")||20;return((e,t={})=>{switch(e.type){case"graphImage":return b.convert(e,t);case"flowchart":return p.convert(e,t);case"sequence":return w.convert(e,t);case"class":return A.convert(e,t);default:throw Error(`graphToExcalidraw: unknown graph type "${e.type}, only flowcharts are supported!"`)}})(await _(e,{...r,themeVariables:{...r.themeVariables,fontSize:`${1.25*a}px`}}),{fontSize:a})};e.s(["parseMermaidToExcalidraw",()=>D],91936)}]);