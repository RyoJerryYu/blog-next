(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4428,e=>{"use strict";var t=e.i(7827),d=e.i(6405),i=e.i(43374);e.i(31345);var a=e.i(12638);function r(e,t){e.forEach(e=>{let d={id:e.id,labelText:e.label,height:e.height,width:e.width,padding:e.padding??0};Object.keys(e).forEach(t=>{["id","label","height","width","padding","x","y"].includes(t)||(d[t]=e[t])}),t.add({group:"nodes",data:d,position:{x:e.x??0,y:e.y??0}})})}function o(e,t){e.forEach(e=>{let d={id:e.id,source:e.start,target:e.end};Object.keys(e).forEach(t=>{["id","start","end"].includes(t)||(d[t]=e[t])}),t.add({group:"edges",data:d})})}function n(e){return new Promise(i=>{let n=(0,a.select)("body").append("div").attr("id","cy").attr("style","display:none"),s=(0,d.default)({container:document.getElementById("cy"),style:[{selector:"edge",style:{"curve-style":"bezier"}}]});n.remove(),r(e.nodes,s),o(e.edges,s),s.nodes().forEach(function(e){e.layoutDimensions=()=>{let t=e.data();return{w:t.width,h:t.height}}}),s.layout({name:"cose-bilkent",quality:"proof",styleEnabled:!1,animate:!1}).run(),s.ready(e=>{t.log.info("Cytoscape ready",e),i(s)})})}function s(e){return e.nodes().map(e=>{let t=e.data(),d=e.position(),i={id:t.id,x:d.x,y:d.y};return Object.keys(t).forEach(e=>{"id"!==e&&(i[e]=t[e])}),i})}function l(e){return e.edges().map(e=>{let t=e.data(),d=e._private.rscratch,i={id:t.id,source:t.source,target:t.target,startX:d.startX,startY:d.startY,midX:d.midX,midY:d.midY,endX:d.endX,endY:d.endY};return Object.keys(t).forEach(e=>{["id","source","target"].includes(e)||(i[e]=t[e])}),i})}async function g(e,d){t.log.debug("Starting cose-bilkent layout algorithm");try{c(e);let d=await n(e),i=s(d),a=l(d);return t.log.debug(`Layout completed: ${i.length} nodes, ${a.length} edges`),{nodes:i,edges:a}}catch(e){throw t.log.error("Error in cose-bilkent layout algorithm:",e),e}}function c(e){if(!e)throw Error("Layout data is required");if(!e.config)throw Error("Configuration is required in layout data");if(!e.rootNode)throw Error("Root node is required");if(!e.nodes||!Array.isArray(e.nodes))throw Error("No nodes found in layout data");if(!Array.isArray(e.edges))throw Error("Edges array is required in layout data");return!0}d.default.use(i.default),(0,t.__name)(r,"addNodes"),(0,t.__name)(o,"addEdges"),(0,t.__name)(n,"createCytoscapeInstance"),(0,t.__name)(s,"extractPositionedNodes"),(0,t.__name)(l,"extractPositionedEdges"),(0,t.__name)(g,"executeCoseBilkentLayout"),(0,t.__name)(c,"validateLayoutData");var u=(0,t.__name)(async(e,t,{insertCluster:d,insertEdge:i,insertEdgeLabel:a,insertMarkers:r,insertNode:o,log:n,positionEdgeLabel:s},{algorithm:l})=>{let c={},u={},y=t.select("g");r(y,e.markers,e.type,e.diagramId);let h=y.insert("g").attr("class","subgraphs"),m=y.insert("g").attr("class","edgePaths"),f=y.insert("g").attr("class","edgeLabels"),p=y.insert("g").attr("class","nodes");n.debug("Inserting nodes into DOM for dimension calculation"),await Promise.all(e.nodes.map(async t=>{if(t.isGroup){let e={...t};u[t.id]=e,c[t.id]=e,await d(h,t)}else{let d={...t};c[t.id]=d;let i=await o(p,t,{config:e.config,dir:e.direction||"TB"}),a=i.node().getBBox();d.width=a.width,d.height=a.height,d.domId=i,n.debug(`Node ${t.id} dimensions: ${a.width}x${a.height}`)}})),n.debug("Running cose-bilkent layout algorithm");let b={...e,nodes:e.nodes.map(e=>{let t=c[e.id];return{...e,width:t.width,height:t.height}})},w=await g(b,e.config);n.debug("Positioning nodes based on layout results"),w.nodes.forEach(e=>{let t=c[e.id];t?.domId&&(t.domId.attr("transform",`translate(${e.x}, ${e.y})`),t.x=e.x,t.y=e.y,n.debug(`Positioned node ${t.id} at center (${e.x}, ${e.y})`))}),w.edges.forEach(t=>{let d=e.edges.find(e=>e.id===t.id);d&&(d.points=[{x:t.startX,y:t.startY},{x:t.midX,y:t.midY},{x:t.endX,y:t.endY}])}),n.debug("Inserting and positioning edges"),await Promise.all(e.edges.map(async t=>{await a(f,t);let d=c[t.start??""],r=c[t.end??""];if(d&&r){let a=w.edges.find(e=>e.id===t.id);if(a){n.debug("APA01 positionedEdge",a);let o={...t},l=i(m,o,u,e.type,d,r,e.diagramId);s(o,l)}else{let a={...t,points:[{x:d.x||0,y:d.y||0},{x:r.x||0,y:r.y||0}]},o=i(m,a,u,e.type,d,r,e.diagramId);s(a,o)}}})),n.debug("Cose-bilkent rendering completed")},"render");e.s(["render",()=>u])}]);